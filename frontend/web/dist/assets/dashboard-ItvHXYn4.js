import{u as g,a as y,l as U,j as t,H as v,b as f,t as m,d as c,e as T,f as x}from"./main-BydiQyaM.js";import{A as w}from"./app-layout-DHhKzHad.js";import S from"./api-test-layout-DgIlV58W.js";import E from"./test-case-sidebar-B8oThQQg.js";import F from"./test-case-form-CsTZ4AP0.js";import O from"./test-case-output-NWiuGFSq.js";import{u as N}from"./useQuery-jnUJC7NV.js";import{u as k}from"./useApiTestService-CQSQgjb_.js";import{F as I}from"./index.esm-CJK8tDOI.js";import{u as C}from"./documentation-tab-Bubs3QEq.js";import{u as D}from"./useAppSelector-CzTnmvtc.js";import{s as q}from"./apiTestSelectors-BJyltacD.js";import{F as H}from"./form-DX3O4RJO.js";import{s as L}from"./tree-view-BYVb02mF.js";import{u as P}from"./use-show-toast-BcQ3dlxi.js";import"./button-C-rnLBLf.js";import"./index-DPZ8b9Kb.js";import"./index-BnvXX4n8.js";import"./x-DSje4WbB.js";import"./createLucideIcon-CRm3YF41.js";import"./chevron-right-B9pARGey.js";import"./dropdown-menu-WyBFoyA9.js";import"./index-DVlhDiqO.js";import"./index-DXJwAmiN.js";import"./index-PgTk4yhK.js";import"./check-DJufTw_9.js";import"./useAuthState-DHSGp_mj.js";import"./index-DTbhIXR6.js";import"./ApiTestViewModel-CRkjMY33.js";import"./skeleton-B62LBl9Y.js";import"./input-Dgs5CwRh.js";import"./tabs-Dc4-qSik.js";import"./ApiTestFormField-C1Cx3RcS.js";import"./data-tab-CkdSIdxk.js";import"./select-DyZqTRV0.js";import"./api-test-data-table-B-dunO-z.js";import"./index-Dm0iVrRJ.js";import"./table-CeDo63FL.js";import"./ColumnConfig-C2HDgQGv.js";import"./ApiTestDataFormField-pZdwtfdR.js";import"./popover-CCLIJllB.js";import"./scenario-tab-DqsVBRJX.js";import"./useRequest-DG7KNB73.js";import"./BaseEntity-DGhPHkWu.js";import"./serviceHandler-BlQljMi1.js";import"./ClientDatabaseViewModel-CZz8IN5P.js";import"./zod-DZSQZtHs.js";import"./schemas-D95ZC4Tg.js";import"./textarea-DG7A0biE.js";function Ce(){const r=g(),{indexApiTest:b,createApiTest:h,updateApiTest:j}=k(),s=D(q),o=D(L),{form:a}=C({apiTestDTO:s}),l=P(),{data:n}=N({queryKey:["/backend/api_test/index"],queryFn:async()=>await b(),enabled:!0});y.useEffect(()=>{n&&r(U(n))},[r,n]);const A=async()=>{try{if(s&&o&&o.password){const d=a.getValues("apiTestData").map(e=>({apiTest:s.UUID,enabled:e.enabled??0,key:e.key??"",value:e.value??"",description:e.description??"",fieldType:e.fieldType??""})),u={...a.getValues(),UUID:s.UUID,project:o.project,clientDatabase:o.UUID,apiTestData:d??[]},p=[s?.UUID].filter(e=>e!==void 0);s.isNew?await h({apiTestDTO:u,clientDatabaseToken:o.password},{onSuccess:e=>{r(c(p)),r(T(e)),r(m({action:null})),r(x(e.apiTestDTO))},onError:e=>{console.error(e),l("Error","Failed to create test case","error"),r(f()),r(m({action:null})),r(c(p))}}):await j({apiTestDTO:u,clientDatabaseToken:o.password},{onSuccess:e=>{r(c(p)),r(T(e)),r(m({action:null})),r(x(e.apiTestDTO))},onError:e=>{console.error(e),l("Error","Failed to create test case","error"),r(f()),r(m({action:null})),r(c(p))}})}else throw new Error("Missing Client Database Token")}catch(i){console.error(i);const d=i instanceof Error?i.message:typeof i=="string"?i:"Unexpected error occurred";l("Error",d,"error")}};return t.jsxs(w,{children:[t.jsx(v,{title:"API Test"}),t.jsx(S,{children:t.jsxs(I,{...a,children:[t.jsx("div",{className:"w-60 border-none flex-shrink-0 mx-2",children:t.jsx(E,{})}),t.jsx("div",{className:"flex-1 flex flex-coloverflow-auto w-full",children:t.jsx("div",{className:"flex flex-1 space-x-2",children:t.jsx(H,{...a,children:t.jsxs("form",{onSubmit:a.handleSubmit(A),className:"grid grid-cols-1 md:grid-cols-5 gap-2 w-full",children:[t.jsx("div",{className:"border rounded-lg p-4 md:col-span-3",children:t.jsx(F,{})}),t.jsx("div",{className:"border rounded-lg p-4 md:col-span-2",children:t.jsx(O,{})})]})})})})]})})]})}export{Ce as default};
