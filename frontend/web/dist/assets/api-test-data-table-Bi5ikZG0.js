import{a as m,j as e,E as Q,P as W,N as _,Z as Y,L as B,M as O,ae as ee,x as te,h as ae}from"./main-wTblVsq0.js";import{u as re,f as se,b as ne}from"./index-C_TaKwYQ.js";import{T as oe,a as le,b as y,c as ce,d as ie,e as I}from"./table-A-yJ4UV_.js";import{c as T}from"./ColumnConfig-BsQ6chWg.js";import{A as k}from"./ApiTestDataFormField-DE3smGIc.js";import{u as de,S as ue,a as pe,c as me,d as P}from"./select-BUeZboHz.js";import{C as be}from"./check-CTufcYB2.js";import{S as he}from"./skeleton-DSleaXBS.js";import{u as fe}from"./useAppSelector-BW6dmEz4.js";import{I as $}from"./input-B7ehP6LW.js";import{a as S,b as N,d as F}from"./form-CEUoIQsp.js";import{d as xe}from"./index.esm-CZz6cprQ.js";import{D as w,T as ge}from"./table-selection-popover-B30BGSba.js";import"./button-BKtYD9UH.js";import"./createLucideIcon-C5-kp_dk.js";import"./index-BB0IBzWE.js";import"./index-B8kHX97E.js";import"./label-CAlckq6-.js";import"./popover-BDwlhlqd.js";import"./index-L13OofM9.js";import"./ClientDatabaseTableViewModel-CWID7VbN.js";import"./clientDatabaseSelectors-BCEKIPh0.js";import"./loader-circle-BpAhSxMv.js";var R="Checkbox",[ke,Ze]=Q(R),[Ce,A]=ke(R);function ve(a){const{__scopeCheckbox:o,checked:i,children:l,defaultChecked:c,disabled:s,form:x,name:b,onCheckedChange:d,required:C,value:v="on",internal_do_not_use_render:r}=a,[t,h]=Y({prop:i,defaultProp:c??!1,onChange:d,caller:R}),[n,f]=m.useState(null),[p,u]=m.useState(null),g=m.useRef(!1),D=n?!!x||!!n.closest("form"):!0,E={checked:t,disabled:s,setChecked:h,control:n,setControl:f,name:b,form:x,value:v,hasConsumerStoppedPropagationRef:g,required:C,defaultChecked:j(c)?!1:c,isFormControl:D,bubbleInput:p,setBubbleInput:u};return e.jsx(Ce,{scope:o,...E,children:je(r)?r(E):l})}var L="CheckboxTrigger",M=m.forwardRef(({__scopeCheckbox:a,onKeyDown:o,onClick:i,...l},c)=>{const{control:s,value:x,disabled:b,checked:d,required:C,setControl:v,setChecked:r,hasConsumerStoppedPropagationRef:t,isFormControl:h,bubbleInput:n}=A(L,a),f=B(c,v),p=m.useRef(d);return m.useEffect(()=>{const u=s?.form;if(u){const g=()=>r(p.current);return u.addEventListener("reset",g),()=>u.removeEventListener("reset",g)}},[s,r]),e.jsx(_.button,{type:"button",role:"checkbox","aria-checked":j(d)?"mixed":d,"aria-required":C,"data-state":V(d),"data-disabled":b?"":void 0,disabled:b,value:x,...l,ref:f,onKeyDown:O(o,u=>{u.key==="Enter"&&u.preventDefault()}),onClick:O(i,u=>{r(g=>j(g)?!0:!g),n&&h&&(t.current=u.isPropagationStopped(),t.current||u.stopPropagation())})})});M.displayName=L;var H=m.forwardRef((a,o)=>{const{__scopeCheckbox:i,name:l,checked:c,defaultChecked:s,required:x,disabled:b,value:d,onCheckedChange:C,form:v,...r}=a;return e.jsx(ve,{__scopeCheckbox:i,checked:c,defaultChecked:s,disabled:b,required:x,onCheckedChange:C,name:l,form:v,value:d,internal_do_not_use_render:({isFormControl:t})=>e.jsxs(e.Fragment,{children:[e.jsx(M,{...r,ref:o,__scopeCheckbox:i}),t&&e.jsx(J,{__scopeCheckbox:i})]})})});H.displayName=R;var K="CheckboxIndicator",U=m.forwardRef((a,o)=>{const{__scopeCheckbox:i,forceMount:l,...c}=a,s=A(K,i);return e.jsx(W,{present:l||j(s.checked)||s.checked===!0,children:e.jsx(_.span,{"data-state":V(s.checked),"data-disabled":s.disabled?"":void 0,...c,ref:o,style:{pointerEvents:"none",...a.style}})})});U.displayName=K;var q="CheckboxBubbleInput",J=m.forwardRef(({__scopeCheckbox:a,...o},i)=>{const{control:l,hasConsumerStoppedPropagationRef:c,checked:s,defaultChecked:x,required:b,disabled:d,name:C,value:v,form:r,bubbleInput:t,setBubbleInput:h}=A(q,a),n=B(i,h),f=de(s),p=ee(l);m.useEffect(()=>{const g=t;if(!g)return;const D=window.HTMLInputElement.prototype,z=Object.getOwnPropertyDescriptor(D,"checked").set,X=!c.current;if(f!==s&&z){const Z=new Event("click",{bubbles:X});g.indeterminate=j(s),z.call(g,j(s)?!1:s),g.dispatchEvent(Z)}},[t,f,s,c]);const u=m.useRef(j(s)?!1:s);return e.jsx(_.input,{type:"checkbox","aria-hidden":!0,defaultChecked:x??u.current,required:b,disabled:d,name:C,value:v,form:r,...o,tabIndex:-1,ref:n,style:{...o.style,...p,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});J.displayName=q;function je(a){return typeof a=="function"}function j(a){return a==="indeterminate"}function V(a){return j(a)?"indeterminate":a?"checked":"unchecked"}function G({className:a,...o}){return e.jsx(H,{"data-slot":"checkbox",className:te("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",a),...o,children:e.jsx(U,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(be,{className:"size-3.5"})})})}function ye(a,o){return({getValue:i,row:l})=>{const c=!!i(),s=l.original,x=o?.disabled?.(s)??!1,b=o?.ariaLabel?.(s)??"Toggle";return e.jsx("div",{className:"flex items-center",onClick:d=>d.stopPropagation(),children:e.jsx(G,{checked:c,disabled:x,"aria-label":b,onCheckedChange:d=>a({row:s,next:!!d}),className:"translate-y-[1px]"})})}}const Te=[T({accessorKey:k.enabled.name,header:null,size:44,minSize:36,maxSize:64,enableSorting:!1,cell:ye(({row:a,next:o})=>{console.log(a),console.log(o)},{})}),T({accessorKey:k.key.name,header:k.key.label,enableSorting:!1}),T({accessorKey:k.value.name,header:k.value.label,enableSorting:!1}),T({accessorKey:k.description.name,header:k.description.label,enableSorting:!1})],Se=["UUID","key","value","description"],Ne=a=>Se.includes(a);function Qe({form:a}){const[o,i]=m.useState(null),{fields:l,append:c}=xe({control:a.control,name:"apiTestData"}),s=re({data:structuredClone(l),columns:Te,enableRowSelection:!0,enableSorting:!1,enableFilters:!1,enableSortingRemoval:!1,getCoreRowModel:ne()}),x=fe(ae),b=m.useRef(null),d=r=>{if(typeof r=="number"){if(b.current===r)return;b.current=r}const t=new w;t.setField("text"),console.log("Text: ",t.asJSONString()),c({isNew:"1",enabled:"0",key:"",value:"",description:"",fieldType:t.asJSONString()},{shouldFocus:!1})},C=(r,t)=>{a.setValue(`apiTestData.${r}.enabled`,t),r===l.length-1&&t==="1"&&d(r)},v=r=>{a.getValues(`apiTestData.${r}.enabled`)!=="1"&&a.setValue(`apiTestData.${r}.enabled`,"1"),r===l.length-1&&d(r)};return m.useEffect(()=>{if(l.length===0){const r=new w;r.setField("text"),c({isNew:"1",enabled:"0",key:"",value:"",description:"",fieldType:r.asJSONString()},{shouldFocus:!1}),b.current=null}},[l.length,c]),e.jsxs(oe,{className:"card",children:[e.jsx(le,{children:s.getHeaderGroups().map(r=>e.jsx(y,{className:"border-b border-accent dark:border-accent",children:r.headers.map(t=>e.jsxs(ce,{className:"m-0 p-0 border-r border-accent dark:border-accent last:border-r-0",style:{width:t.getSize()},children:[t.isPlaceholder?null:se(t.column.columnDef.header,t.getContext()),t.column.getCanResize()&&e.jsx("div",{onMouseDown:t.getResizeHandler(),onTouchStart:t.getResizeHandler(),className:`absolute right-0 top-0 h-full w-1 cursor-col-resize select-none
                                            ${t.column.getIsResizing()?"bg-blue-500":"bg-transparent hover:bg-gray-400"}`})]},t.id))},r.id))}),e.jsx(ie,{children:x?Array.from({length:5}).map((r,t)=>e.jsx(y,{children:s.getAllLeafColumns().map(h=>e.jsx("td",{className:"px-2 py-2",children:e.jsx(he,{className:"h-4 w-full rounded-2xl p-4 m-1 gap-2"})},h.id))},`skeleton-${t}`)):l.length>0?l.map((r,t)=>e.jsx(y,{className:"cursor-pointer p-2 border border-accent dark:border-accent text-foreground dark:text-foreground",children:s.getAllLeafColumns().map(h=>e.jsxs(I,{className:"p-2",children:[h.id==="UUID"&&e.jsx(S,{control:a.control,name:`apiTestData.${t}.UUID`,render:({field:n})=>e.jsx(N,{children:e.jsx($,{...n,className:"hidden"})})}),h.id===k.enabled.name?e.jsx(S,{control:a.control,name:`apiTestData.${t}.enabled`,render:({field:n})=>e.jsx(N,{children:e.jsx(F,{children:e.jsx("div",{onClick:f=>f.stopPropagation(),className:"flex items-center",children:e.jsx(G,{checked:n.value==="1",onCheckedChange:f=>{const p=f?"1":"0";n.onChange(p),C(t,p)},"aria-label":"Toggle",className:"cursor-pointer h-6 w-6 shrink-0 translate-y-[1px]"})})})})}):Ne(h.id)&&e.jsxs("div",{className:"flex flex-row gap-1",children:[e.jsx(S,{control:a.control,name:`apiTestData.${t}.${h.id}`,render:({field:n})=>e.jsx(N,{children:e.jsx(F,{children:e.jsx($,{...n,value:n.value??"",onChange:f=>n.onChange(f.target.value),onFocus:()=>v(t),className:"w-full h-8"})})})}),e.jsx(S,{name:`apiTestData.${t}.${k.fieldType.name}`,control:a.control,render:({field:n})=>{const f=(()=>{try{if(!n.value)return"text";const p=typeof n.value=="string"?JSON.parse(n.value):n.value;return(p?Object.keys(p)[0]:"text")||"text"}catch{return"text"}})();return e.jsx(N,{children:e.jsx(F,{children:h.id===k.value.name&&e.jsxs(m.Fragment,{children:[e.jsxs(ue,{value:f,onValueChange:p=>{const u=new w;u.setField(p),n.onChange(u.asJSONString()),setTimeout(p==="dropdown"?()=>i(t):()=>i(null),300)},children:[e.jsx(pe,{className:"h-6 w-6 flex items-center justify-center rounded-md border text-xs p-1"}),e.jsxs(me,{children:[e.jsx(P,{value:"text",children:"Text"}),e.jsx(P,{value:"dropdown",children:"Dropdown"}),e.jsx(P,{value:"file",children:"File"})]})]}),e.jsx(ge,{rowIndex:t,isOpen:o===t,setIsOpen:p=>i(p?t:null)})]})})})}})]})]},h.id))},r.id)):e.jsx(y,{children:e.jsx(I,{colSpan:s.getAllLeafColumns().length,className:"h-24 text-center text-muted-foreground",children:"No test data rows found."})})})]})}export{Qe as default};
