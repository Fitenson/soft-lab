import{c as l,a as F,j as a}from"./main-CqIcQYOd.js";import{C as y,u as C,D as v,b as V,c as U,g as I}from"./useClientDatabaseService-BXxEukRm.js";import{F as M,a as n,b as c,c as i,d,e as x}from"./form-CHixXC_4.js";import{I as b}from"./input-BSO-yrmm.js";import{u as T,a as B}from"./zod-BQE-bimL.js";import{o as k,s as h}from"./schemas-6m5s2bNq.js";import{B as H}from"./button-Dh_-atTS.js";import{S as P}from"./save-button-CXxU2tDy.js";import{u as z}from"./use-show-toast-B2EACa4R.js";import{X as L}from"./index-DHfvGk8y.js";import"./index-DAKXpYdn.js";import"./serviceHandler-BlQljMi1.js";import"./useRequest-D0DmBEsy.js";import"./useAppSelector-Bsu3Ww41.js";import"./BaseEntity-DGhPHkWu.js";import"./index-DWfPzURy.js";import"./createLucideIcon-CCSn1C7t.js";const e={databaseName:l({name:"databaseName",label:"Database Name",max:50}),databaseSchema:l({name:"databaseSchema",label:"Database Schema",max:50}),host:l({name:"host",label:"Host",max:50}),port:l({name:"port",label:"Port",max:50}),username:l({name:"username",label:"Username",max:50}),password:l({name:"password",label:"Password",max:50})},R=k({databaseName:h().max(e.databaseName.max,{error:e.databaseName.maxError}),databaseSchema:h().max(e.databaseSchema.max,{error:e.databaseSchema.maxError}),host:h().max(e.host.max,{error:e.host.maxError}),port:h().max(e.port.max,{error:e.port.maxError}),username:h().max(e.username.max,{error:e.username.maxError}),password:h().max(e.password.max,{error:e.password.maxError})}),X=({clientDatabaseDTO:p})=>{const[o,j]=F.useState(()=>p?new y(p):void 0),r=T({resolver:B(R),defaultValues:{databaseName:o?.databaseName??"",databaseSchema:o?.databaseSchema??"",host:o?.host??"",port:o?.port??"",username:o?.username??"",password:o?.password??""}});return{form:r,setFormError:(u,f)=>{const{setToastError:w}=f||{},D=u,t=D?.response?.data?.errors??{};typeof t=="string"?w?.(t):t&&Object.keys(t).length>0?Object.keys(t).forEach(N=>{const s=N.replace(/^clientDatabase\./,"");s in r.getValues()&&r.setError(s,{type:"server",message:t[N][0]??"Invalid value"})}):w?.(D?.response?.data?.message??"Server error")},clientDatabaseViewModel:o,setClientDatabaseViewModel:j}};function ta({clientDatabaseDTO:p,open:o,onOpenChange:j}){const{form:r,setFormError:E,clientDatabaseViewModel:u,setClientDatabaseViewModel:f}=X({clientDatabaseDTO:p}),{createClientDatabase:w,updateClientDatabase:D}=C(),t=z(),N=async()=>{const S={...r.getValues(),...u?.UUID?{UUID:u.UUID}:{}};S?.UUID?await D(S,{onSuccess:m=>{f(m),j(!1)},onError:m=>{E(m,{setToastError(g){t("Error",g,"error")}})}}):await w(S,{onSuccess:m=>{f(m),j(!1)},onError:m=>{E(m,{setToastError(g){t("Error",g,"error")}})}})};return a.jsx(v,{open:o,onOpenChange:j,children:a.jsx(V,{className:"sm:max-w-[520px]",showCloseButton:!1,children:a.jsx("div",{className:"w-full",children:a.jsx(M,{...r,children:a.jsxs("form",{className:"grid grid-cols-2 gap-4",onSubmit:r.handleSubmit(N),children:[a.jsxs(U,{className:"mb-4 col-span-2 flex flex-row items-center justify-start",children:[a.jsx(P,{}),a.jsx(I,{asChild:!0,children:a.jsx(H,{variant:"ghost",type:"button",className:"cursor-pointer rounded-full",children:a.jsx(L,{className:"h-5 w-5 text-accent-foreground dark:text-accent-foreground"})})})]}),a.jsx(n,{control:r.control,name:e.databaseName.name,render:({field:s})=>a.jsxs(c,{className:"my-1 ml-1 mb-1",children:[a.jsx(i,{children:e.databaseName.label}),a.jsx(d,{children:a.jsx(b,{...s})}),a.jsx(x,{})]})}),a.jsx(n,{control:r.control,name:e.databaseSchema.name,render:({field:s})=>a.jsxs(c,{className:"my-1 ml-1 mb-1",children:[a.jsx(i,{children:e.databaseSchema.label}),a.jsx(d,{children:a.jsx(b,{...s})}),a.jsx(x,{})]})}),a.jsx(n,{control:r.control,name:e.host.name,render:({field:s})=>a.jsxs(c,{className:"my-1 ml-1 mb-1",children:[a.jsx(i,{children:e.host.label}),a.jsx(d,{children:a.jsx(b,{...s})}),a.jsx(x,{})]})}),a.jsx(n,{control:r.control,name:e.port.name,render:({field:s})=>a.jsxs(c,{className:"my-1 ml-1 mb-1",children:[a.jsx(i,{children:e.port.label}),a.jsx(d,{children:a.jsx(b,{...s})}),a.jsx(x,{})]})}),a.jsx(n,{control:r.control,name:e.username.name,render:({field:s})=>a.jsxs(c,{className:"my-1 ml-1 mb-1",children:[a.jsx(i,{children:e.username.label}),a.jsx(d,{children:a.jsx(b,{...s})}),a.jsx(x,{})]})}),a.jsx(n,{control:r.control,name:e.password.name,render:({field:s})=>a.jsxs(c,{className:"my-1 ml-1 mb-1",children:[a.jsx(i,{children:e.password.label}),a.jsx(d,{children:a.jsx(b,{...s})}),a.jsx(x,{})]})})]})})})})})}export{ta as default};
