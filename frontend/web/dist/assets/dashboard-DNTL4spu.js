import{u as g,a as v,l as w,j as t,H as y,b as f,t as m,d as c,e as T,f as x}from"./main-izxaliaV.js";import{A as S}from"./app-layout-D0hmBzhk.js";import U from"./api-test-layout-DiGi4zPO.js";import E from"./test-case-sidebar-DLKdF7xk.js";import F from"./test-case-form-q9l0MOXz.js";import O from"./test-case-output-MBQqwY2b.js";import{u as N}from"./useQuery-D3NVkEwX.js";import{u as k}from"./useApiTestService-BlnbbkuJ.js";import{F as I}from"./index.esm-CIjoDSgn.js";import{u as C}from"./documentation-tab-BtwGFPAZ.js";import{u as D}from"./useAppSelector-WPIkilGz.js";import{s as q}from"./apiTestSelectors-BJyltacD.js";import{F as H}from"./form-Dg9MJd5e.js";import{s as L}from"./tree-view-D9lH_Sny.js";import{u as P}from"./use-show-toast-B4EujUtd.js";import"./button-DY5-B3Bs.js";import"./index-BDedzrUx.js";import"./index-DJIJZoV6.js";import"./x-DpYprPGR.js";import"./createLucideIcon-Ckg_wYdv.js";import"./chevron-right-C-CiZvSw.js";import"./dropdown-menu-1bVn6xLC.js";import"./index-hLWYLNZ2.js";import"./index-CzL2Ojfc.js";import"./index-2l8oERdT.js";import"./check-BVUkRrmU.js";import"./useAuthState-BxdGeJKM.js";import"./index-CDQ83-G9.js";import"./ApiTestViewModel-CRkjMY33.js";import"./skeleton-6JwENJXZ.js";import"./input-Bsf0DwKO.js";import"./tabs-DPeCf8SN.js";import"./ApiTestFormField-DEHodoRJ.js";import"./data-tab-x1Gy_2XU.js";import"./select-BsIQayk5.js";import"./api-test-data-table-DGo2N7un.js";import"./index-DDOOTtlr.js";import"./table-BGqCVyu6.js";import"./ColumnConfig-6tbpjRFT.js";import"./ApiTestDataFormField-DPE5FzC8.js";import"./scenario-tab-Dqh_N-gx.js";import"./useRequest-0qId6Cgh.js";import"./BaseEntity-DGhPHkWu.js";import"./serviceHandler-BlQljMi1.js";import"./ClientDatabaseViewModel-CZz8IN5P.js";import"./zod-DbgYTeD5.js";import"./schemas-D95ZC4Tg.js";import"./textarea-DqoFCLfX.js";function Ie(){const e=g(),{indexApiTest:b,createApiTest:h,updateApiTest:j}=k(),i=D(q),s=D(L),{form:a}=C({apiTestDTO:i}),n=P(),{data:l}=N({queryKey:["/backend/api_test/index"],queryFn:async()=>await b(),enabled:!0});v.useEffect(()=>{l&&e(w(l))},[e,l]);const A=async()=>{try{if(i&&s&&s.password){const d=a.getValues("apiTestData").map(r=>({enabled:r.enabled??0,key:r.key??"",value:r.value??"",description:r.description??""})),u={...a.getValues(),UUID:i.UUID,project:s.project,clientDatabase:s.UUID,apiTestData:d??[]},p=[i?.UUID].filter(r=>r!==void 0);i.isNew?await h({apiTestDTO:u,clientDatabaseToken:s.password},{onSuccess:r=>{e(c(p)),e(T(r)),e(m({action:null})),e(x(r.apiTestDTO))},onError:r=>{console.error(r),n("Error","Failed to create test case","error"),e(f()),e(m({action:null})),e(c(p))}}):await j({apiTestDTO:u,clientDatabaseToken:s.password},{onSuccess:r=>{e(c(p)),e(T(r)),e(m({action:null})),e(x(r.apiTestDTO))},onError:r=>{console.error(r),n("Error","Failed to create test case","error"),e(f()),e(m({action:null})),e(c(p))}})}else throw new Error("Missing Client Database Token")}catch(o){console.error(o);const d=o instanceof Error?o.message:typeof o=="string"?o:"Unexpected error occurred";n("Error",d,"error")}};return t.jsxs(S,{children:[t.jsx(y,{title:"API Test"}),t.jsx(U,{children:t.jsxs(I,{...a,children:[t.jsx("div",{className:"w-60 border-none flex-shrink-0 mx-2",children:t.jsx(E,{})}),t.jsx("div",{className:"flex-1 flex flex-coloverflow-auto w-full",children:t.jsx("div",{className:"flex flex-1 space-x-2",children:t.jsx(H,{...a,children:t.jsxs("form",{onSubmit:a.handleSubmit(A),className:"grid grid-cols-1 md:grid-cols-5 gap-2 w-full",children:[t.jsx("div",{className:"border rounded-lg p-4 md:col-span-3",children:t.jsx(F,{})}),t.jsx("div",{className:"border rounded-lg p-4 md:col-span-2",children:t.jsx(O,{})})]})})})})]})})]})}export{Ie as default};
