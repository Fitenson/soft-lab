import{a as i,C as W,j as n,A as Z,J,I as g,p as y,i as Y,u as Q,t as ee,ae as te,af as I,h as _,ag as w,ah as ne,g as oe}from"./main-D4bI6BKa.js";import{B as T}from"./button-BKnOxFCw.js";import{u as N}from"./useAppSelector-DxgkrSSa.js";import{c as D,R as re,A as ae,P as se,C as ie,I as ce,G as ue,L as de,a as le,d as pe,e as me,b as xe,S as fe,f as ve,g as he,h as Ce}from"./index-X2ld5qWc.js";import{s as ge,b as Me,c as _e}from"./apiTestSelectors-BJyltacD.js";import{I as Ne}from"./input-DEjThRMb.js";import{u as be}from"./useApiTestService-Df37-M3p.js";import{u as we}from"./use-show-toast-CjZCszxr.js";import{a as Re,b as Ae,d as je}from"./form-DAij8tw6.js";import{A as Ie}from"./ApiTestFormField-BBPIK-oS.js";import{a as Te}from"./index.esm-BxVilJKE.js";import{C as Se}from"./chevron-right-CfNQHnE2.js";import{c as U}from"./createLucideIcon-C98CFg3S.js";import"./index-EDnzw9Sw.js";import"./index-6_HBpJ78.js";import"./index-j-GxORq2.js";import"./useRequest-CO_Ng5p6.js";import"./useAuthState-DfK9lhK3.js";import"./BaseEntity-DGhPHkWu.js";import"./ApiTestViewModel-BZncyWgE.js";import"./serviceHandler-BlQljMi1.js";import"./ClientDatabaseViewModel-CZz8IN5P.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Pe=U("file-text",Ee);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],De=U("folder",ye);var R="ContextMenu",[Ue,Dt]=Z(R,[D]),d=D(),[Oe,O]=Ue(R),k=e=>{const{__scopeContextMenu:o,children:r,onOpenChange:t,dir:a,modal:c=!0}=e,[m,l]=i.useState(!1),f=d(o),v=W(t),u=i.useCallback(h=>{l(h),v(h)},[v]);return n.jsx(Oe,{scope:o,open:m,onOpenChange:u,modal:c,children:n.jsx(re,{...f,dir:a,open:m,onOpenChange:u,modal:c,children:r})})};k.displayName=R;var F="ContextMenuTrigger",G=i.forwardRef((e,o)=>{const{__scopeContextMenu:r,disabled:t=!1,...a}=e,c=O(F,r),m=d(r),l=i.useRef({x:0,y:0}),f=i.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...l.current})}),v=i.useRef(0),u=i.useCallback(()=>window.clearTimeout(v.current),[]),h=x=>{l.current={x:x.clientX,y:x.clientY},c.onOpenChange(!0)};return i.useEffect(()=>u,[u]),i.useEffect(()=>void(t&&u()),[t,u]),n.jsxs(n.Fragment,{children:[n.jsx(ae,{...m,virtualRef:f}),n.jsx(J.span,{"data-state":c.open?"open":"closed","data-disabled":t?"":void 0,...a,ref:o,style:{WebkitTouchCallout:"none",...e.style},onContextMenu:t?e.onContextMenu:g(e.onContextMenu,x=>{u(),h(x),x.preventDefault()}),onPointerDown:t?e.onPointerDown:g(e.onPointerDown,b(x=>{u(),v.current=window.setTimeout(()=>h(x),700)})),onPointerMove:t?e.onPointerMove:g(e.onPointerMove,b(u)),onPointerCancel:t?e.onPointerCancel:g(e.onPointerCancel,b(u)),onPointerUp:t?e.onPointerUp:g(e.onPointerUp,b(u))})]})});G.displayName=F;var ke="ContextMenuPortal",L=e=>{const{__scopeContextMenu:o,...r}=e,t=d(o);return n.jsx(se,{...t,...r})};L.displayName=ke;var $="ContextMenuContent",z=i.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=O($,r),c=d(r),m=i.useRef(!1);return n.jsx(ie,{...c,...t,ref:o,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:l=>{e.onCloseAutoFocus?.(l),!l.defaultPrevented&&m.current&&l.preventDefault(),m.current=!1},onInteractOutside:l=>{e.onInteractOutside?.(l),!l.defaultPrevented&&!a.modal&&(m.current=!0)},style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});z.displayName=$;var Fe="ContextMenuGroup",Ge=i.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=d(r);return n.jsx(ue,{...a,...t,ref:o})});Ge.displayName=Fe;var Le="ContextMenuLabel",$e=i.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=d(r);return n.jsx(de,{...a,...t,ref:o})});$e.displayName=Le;var ze="ContextMenuItem",B=i.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=d(r);return n.jsx(ce,{...a,...t,ref:o})});B.displayName=ze;var Be="ContextMenuCheckboxItem",He=i.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=d(r);return n.jsx(le,{...a,...t,ref:o})});He.displayName=Be;var qe="ContextMenuRadioGroup",Ve=i.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=d(r);return n.jsx(pe,{...a,...t,ref:o})});Ve.displayName=qe;var Xe="ContextMenuRadioItem",Ke=i.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=d(r);return n.jsx(me,{...a,...t,ref:o})});Ke.displayName=Xe;var We="ContextMenuItemIndicator",Ze=i.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=d(r);return n.jsx(xe,{...a,...t,ref:o})});Ze.displayName=We;var Je="ContextMenuSeparator",Ye=i.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=d(r);return n.jsx(fe,{...a,...t,ref:o})});Ye.displayName=Je;var Qe="ContextMenuArrow",et=i.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=d(r);return n.jsx(ve,{...a,...t,ref:o})});et.displayName=Qe;var tt="ContextMenuSubTrigger",nt=i.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=d(r);return n.jsx(he,{...a,...t,ref:o})});nt.displayName=tt;var ot="ContextMenuSubContent",rt=i.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=d(r);return n.jsx(Ce,{...a,...t,ref:o,style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});rt.displayName=ot;function b(e){return o=>o.pointerType!=="mouse"?e(o):void 0}var at=k,st=G,it=L,ct=z,ut=B;function S({...e}){return n.jsx(at,{"data-slot":"context-menu",...e})}function E({...e}){return n.jsx(st,{"data-slot":"context-menu-trigger",...e})}function P({className:e,...o}){return n.jsx(it,{children:n.jsx(ct,{"data-slot":"context-menu-content",className:y("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...o})})}function M({className:e,inset:o,variant:r="default",...t}){return n.jsx(ut,{"data-slot":"context-menu-item","data-inset":o,"data-variant":r,className:y("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}const dt=e=>e.clientDatabase.clientDatabase;function lt({node:e,level:o=0}){const{id:r}=Y().props,t=Q(),a=o*8,c=N(ge),m=N(Me),l=N(_e),f=N(dt),v=we(),u=Te(),h=m.includes(e.UUID),x=c?.UUID===e.UUID,{createApiTest:H,removeApiTest:q}=be(),A=s=>{t(ee(s.apiDTO))},V=s=>{t(te(s))},X=async()=>{console.log("Client Database: ",f),console.log("Selected Api: ",c);try{if(c&&f&&f.password){const s={...c,project:r,transmission:"formData",clientDatabase:f.UUID,seq:1},p=[c?.UUID].filter(C=>C!==void 0);await H(s,f.password,{onSuccess:C=>{t(w(p)),t(ne(C)),t(_({action:null})),t(oe(C))},onError:C=>{console.error(C),v("Error","Failed to create test case","error"),t(I()),t(_({action:null})),t(w(p))}})}else throw new Error("Missing Client Database Token")}catch(s){console.error(s);const p=s instanceof Error?s.message:typeof s=="string"?s:"Unexpected error occurred";v("Error",p,"error")}},K=async()=>{const s=[c?.UUID].filter(p=>p!==void 0);await q(s,{onSuccess:p=>{p.success.length>0&&(t(I()),t(w(s)))},onError:()=>{v("Error","Server error","error")}})},j=s=>{switch(s){case"rename":t(_({action:"rename",dto:{...c}}));break;case"cancel":u.reset({...u.getValues(),testName:c?.testName??""}),t(_({action:"cancel",dto:{...c}}));break;default:throw new Error("No such action.")}};return e.isFolder?n.jsxs("div",{children:[n.jsxs(S,{children:[n.jsx(E,{children:n.jsxs(T,{variant:"ghost",onClick:()=>{V(e.UUID),A(e)},className:`w-full flex items-center justify-start gap-1 ${x?"bg-accent":""}`,style:{paddingLeft:`${a}px`},children:[n.jsx(Se,{className:`h-4 w-4 transform transition-transform duration-300 ${h?"rotate-90":""}`}),n.jsx(De,{size:16}),n.jsx("span",{className:"text-sm",children:e.testName})]})}),n.jsxs(P,{children:[n.jsx(M,{children:"Rename"}),n.jsx(M,{children:"Remove"})]})]}),h&&e.apiTests?.map(s=>n.jsx(lt,{node:s,level:o+1},s.UUID))]}):n.jsx("div",{className:"flex items-center gap-1 w-full",style:{paddingLeft:`${a+8}px`},children:n.jsxs(S,{children:[n.jsx(E,{className:"w-full",children:l==="rename"&&c?.UUID===e.UUID?n.jsx(Re,{name:Ie.testName.name,control:u.control,render:({field:s})=>n.jsx(Ae,{children:n.jsx(je,{children:n.jsx(Ne,{...s,value:s.value??"",autoFocus:!0,onKeyDown:p=>{p.key==="Enter"&&e?.UUID&&(p.preventDefault(),X())}})})})}):n.jsxs(T,{variant:"ghost",onClick:()=>A(e),className:`w-full flex items-center justify-start gap-1 ${x?"bg-accent":""}`,children:[n.jsx(Pe,{size:16}),e.testName]})}),n.jsxs(P,{children:[n.jsx(M,{className:"cursor-pointer",onClick:()=>j("rename"),children:"Rename"}),n.jsx(M,{className:"cursor-pointer",onClick:K,children:"Remove"}),n.jsx(M,{className:"cursor-pointer accent-destructive dark:accent-destructive",onClick:()=>j("cancel"),children:"Cancel"})]})]})})}export{lt as default};
