import{b as s,A as V,j as n,y as W,I as Z,G as C,n as S,a as Y,u as J,f as T,a9 as Q,aa as ee,t as te,ab as ne,ac as A,ad as oe,ae,af as re}from"./main-BAb7QXQE.js";import{B as I}from"./button-CVrR4gg3.js";import{u as g}from"./useAppSelector-C-go3q4k.js";import{c as P,R as se,A as ie,P as ce,C as ue,I as de,G as le,L as pe,a as xe,d as me,e as fe,b as ve,S as he,f as Ce,g as ge,h as Me}from"./index-Bc78yxGa.js";import{s as _e,a as Te,c as Re,d as Ne}from"./apiTestSelectors-BI3myQ76.js";import{I as Ae}from"./input-vOxvQ0Ja.js";import{u as Ie}from"./useApiTestService-CRXnmq2m.js";import{u as be}from"./use-show-toast-DeVaKh1z.js";import{C as we}from"./chevron-right-CgADg4su.js";import{c as y}from"./createLucideIcon-DKzkg-a2.js";import"./index-D1pcqLmi.js";import"./index-CGwI0QP_.js";import"./index-Cjgd1STi.js";import"./useRequest-CGIdPq6b.js";import"./useAuthState-CP1IFf-j.js";import"./BaseEntity-DGhPHkWu.js";import"./serviceHandler-BlQljMi1.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Se=y("file-text",je);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],ye=y("folder",Pe);var R="ContextMenu",[Ee,bt]=W(R,[P]),u=P(),[Ue,E]=Ee(R),U=e=>{const{__scopeContextMenu:o,children:a,onOpenChange:t,dir:r,modal:p=!0}=e,[d,l]=s.useState(!1),h=u(o),m=V(t),c=s.useCallback(f=>{l(f),m(f)},[m]);return n.jsx(Ue,{scope:o,open:d,onOpenChange:c,modal:p,children:n.jsx(se,{...h,dir:r,open:d,onOpenChange:c,modal:p,children:a})})};U.displayName=R;var D="ContextMenuTrigger",O=s.forwardRef((e,o)=>{const{__scopeContextMenu:a,disabled:t=!1,...r}=e,p=E(D,a),d=u(a),l=s.useRef({x:0,y:0}),h=s.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...l.current})}),m=s.useRef(0),c=s.useCallback(()=>window.clearTimeout(m.current),[]),f=x=>{l.current={x:x.clientX,y:x.clientY},p.onOpenChange(!0)};return s.useEffect(()=>c,[c]),s.useEffect(()=>void(t&&c()),[t,c]),n.jsxs(n.Fragment,{children:[n.jsx(ie,{...d,virtualRef:h}),n.jsx(Z.span,{"data-state":p.open?"open":"closed","data-disabled":t?"":void 0,...r,ref:o,style:{WebkitTouchCallout:"none",...e.style},onContextMenu:t?e.onContextMenu:C(e.onContextMenu,x=>{c(),f(x),x.preventDefault()}),onPointerDown:t?e.onPointerDown:C(e.onPointerDown,M(x=>{c(),m.current=window.setTimeout(()=>f(x),700)})),onPointerMove:t?e.onPointerMove:C(e.onPointerMove,M(c)),onPointerCancel:t?e.onPointerCancel:C(e.onPointerCancel,M(c)),onPointerUp:t?e.onPointerUp:C(e.onPointerUp,M(c))})]})});O.displayName=D;var De="ContextMenuPortal",k=e=>{const{__scopeContextMenu:o,...a}=e,t=u(o);return n.jsx(ce,{...t,...a})};k.displayName=De;var G="ContextMenuContent",L=s.forwardRef((e,o)=>{const{__scopeContextMenu:a,...t}=e,r=E(G,a),p=u(a),d=s.useRef(!1);return n.jsx(ue,{...p,...t,ref:o,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:l=>{e.onCloseAutoFocus?.(l),!l.defaultPrevented&&d.current&&l.preventDefault(),d.current=!1},onInteractOutside:l=>{e.onInteractOutside?.(l),!l.defaultPrevented&&!r.modal&&(d.current=!0)},style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});L.displayName=G;var Oe="ContextMenuGroup",ke=s.forwardRef((e,o)=>{const{__scopeContextMenu:a,...t}=e,r=u(a);return n.jsx(le,{...r,...t,ref:o})});ke.displayName=Oe;var Ge="ContextMenuLabel",Le=s.forwardRef((e,o)=>{const{__scopeContextMenu:a,...t}=e,r=u(a);return n.jsx(pe,{...r,...t,ref:o})});Le.displayName=Ge;var $e="ContextMenuItem",$=s.forwardRef((e,o)=>{const{__scopeContextMenu:a,...t}=e,r=u(a);return n.jsx(de,{...r,...t,ref:o})});$.displayName=$e;var ze="ContextMenuCheckboxItem",Be=s.forwardRef((e,o)=>{const{__scopeContextMenu:a,...t}=e,r=u(a);return n.jsx(xe,{...r,...t,ref:o})});Be.displayName=ze;var Fe="ContextMenuRadioGroup",He=s.forwardRef((e,o)=>{const{__scopeContextMenu:a,...t}=e,r=u(a);return n.jsx(me,{...r,...t,ref:o})});He.displayName=Fe;var qe="ContextMenuRadioItem",Xe=s.forwardRef((e,o)=>{const{__scopeContextMenu:a,...t}=e,r=u(a);return n.jsx(fe,{...r,...t,ref:o})});Xe.displayName=qe;var Ke="ContextMenuItemIndicator",Ve=s.forwardRef((e,o)=>{const{__scopeContextMenu:a,...t}=e,r=u(a);return n.jsx(ve,{...r,...t,ref:o})});Ve.displayName=Ke;var We="ContextMenuSeparator",Ze=s.forwardRef((e,o)=>{const{__scopeContextMenu:a,...t}=e,r=u(a);return n.jsx(he,{...r,...t,ref:o})});Ze.displayName=We;var Ye="ContextMenuArrow",Je=s.forwardRef((e,o)=>{const{__scopeContextMenu:a,...t}=e,r=u(a);return n.jsx(Ce,{...r,...t,ref:o})});Je.displayName=Ye;var Qe="ContextMenuSubTrigger",et=s.forwardRef((e,o)=>{const{__scopeContextMenu:a,...t}=e,r=u(a);return n.jsx(ge,{...r,...t,ref:o})});et.displayName=Qe;var tt="ContextMenuSubContent",nt=s.forwardRef((e,o)=>{const{__scopeContextMenu:a,...t}=e,r=u(a);return n.jsx(Me,{...r,...t,ref:o,style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});nt.displayName=tt;function M(e){return o=>o.pointerType!=="mouse"?e(o):void 0}var ot=U,at=O,rt=k,st=L,it=$;function b({...e}){return n.jsx(ot,{"data-slot":"context-menu",...e})}function w({...e}){return n.jsx(at,{"data-slot":"context-menu-trigger",...e})}function j({className:e,...o}){return n.jsx(rt,{children:n.jsx(st,{"data-slot":"context-menu-content",className:S("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...o})})}function _({className:e,inset:o,variant:a="default",...t}){return n.jsx(it,{"data-slot":"context-menu-item","data-inset":o,"data-variant":a,className:S("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}const ct=e=>e.clientDatabase.clientDatabase;function ut({node:e,level:o=0}){const{id:a}=Y().props,t=J(),r=o*8,p=g(_e),d=g(Te),l=g(Re),h=g(Ne),m=g(ct),c=be(),f=l.includes(e.UUID),x=p?.UUID===e.UUID,{createApiTest:z,removeApiTest:B}=Ie(),N=i=>{t(te(i))},F=i=>{t(ne(i))},H=async()=>{try{if(d&&m){const i={...d,project:a,transmission:"formData",clientDatabase:m.UUID,seq:1};await z(i,m.refreshToken,{onSuccess:v=>{const X=[d?.UUID].filter(K=>K!==void 0);t(A(X)),t(oe(v)),t(T(null)),t(ae(v))}})}}catch(i){console.error(i),c("Error","Unexpected error","error")}},q=async()=>{const i=[p?.UUID].filter(v=>v!==void 0);await B(i,{onSuccess:v=>{v.success.length>0&&(t(re()),t(A(i)))},onError:()=>{c("Error","Server error","error")}})};return e.isFolder?n.jsxs("div",{children:[n.jsxs(b,{children:[n.jsx(w,{children:n.jsxs(I,{variant:"ghost",onClick:()=>{F(e.UUID),N(e)},className:`w-full flex items-center justify-start gap-1 ${x?"bg-accent":""}`,style:{paddingLeft:`${r}px`},children:[n.jsx(we,{className:`h-4 w-4 transform transition-transform duration-300 ${f?"rotate-90":""}`}),n.jsx(ye,{size:16}),n.jsx("span",{className:"text-sm",children:e.testName})]})}),n.jsxs(j,{children:[n.jsx(_,{children:"Rename"}),n.jsx(_,{children:"Remove"})]})]}),f&&e.apiTests?.map(i=>n.jsx(ut,{node:i,level:o+1},i.UUID))]}):n.jsx("div",{className:"flex items-center gap-1 w-full",style:{paddingLeft:`${r+8}px`},children:n.jsxs(b,{children:[n.jsx(w,{className:"w-full",children:h==="rename"&&p?.UUID===e.UUID?n.jsx(Ae,{value:d?.testName,autoFocus:!0,onChange:i=>{t(T(i.target.value)),t(Q({UUID:e.UUID,newName:i.target.value}))},onBlur:()=>t(T(null)),onKeyDown:i=>{i.key==="Enter"&&H()}}):n.jsxs(I,{variant:"ghost",onClick:()=>N(e),className:`w-full flex items-center justify-start gap-1 ${x?"bg-accent":""}`,children:[n.jsx(Se,{size:16}),e.testName]})}),n.jsxs(j,{children:[n.jsx(_,{className:"cursor-pointer",onClick:()=>t(ee({action:"rename",viewModel:e,dto:e.apiDTO})),children:"Rename"}),n.jsx(_,{className:"cursor-pointer",onClick:q,children:"Remove"})]})]})})}export{ut as default};
