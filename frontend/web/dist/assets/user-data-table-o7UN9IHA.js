import{a as t,u as I,l as P,m as y,j as i,b as A,c as N,d as O,r as q}from"./main-pQhv4PK_.js";import{u as J,T as Q,g as B,a as K,b as L}from"./top-action-bar-C2cEVkAl.js";import{u as g}from"./useAppSelector-CaMT8LJQ.js";import{U as z}from"./UserViewModel-BWSeG2eZ.js";import{u as $}from"./use-show-toast-B6G1GJ0-.js";import{D as k}from"./data-table-C8520PGI.js";import{u as G}from"./useMutation-DzfY5YKk.js";import H from"./useUserService-CApml47g.js";import"./index-jnAiejeT.js";import"./button-C87aQd7d.js";import"./utils-BLojDQQ3.js";import"./index-B_v5TFg0.js";import"./createLucideIcon-D6OuqKMZ.js";import"./input-BkImJKNM.js";import"./serviceHandler-BlQljMi1.js";import"./useUserRepository-BURh2yoK.js";import"./useRequest-Mn9d9NpM.js";import"./BaseEntity-DGhPHkWu.js";function W(s,r){const[l,c]=t.useState(s);return t.useEffect(()=>{const u=setTimeout(()=>c(s),r);return()=>clearTimeout(u)},[s,r]),l}function ge({columns:s,data:r,onRefresh:l}){const[c,u]=t.useState({}),S=W(c,1e3),[U,v]=t.useState({}),[w,D]=t.useState([]),[F,M]=t.useState({startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}),n=I(),p=g(e=>e.loading.global),{rowSelection:b,sorting:C,columnVisibility:h}=g(e=>e.userDataTable),R=$(),T=P(),{params:m}=g(e=>e.userDataTable),{removeUser:x}=H(),V=G({mutationFn:e=>{const o=e.map(f=>f.UUID);return x(o)},onSuccess:()=>{R("Success","Successfully remove the user","success"),T.invalidateQueries({queryKey:["/organization/user/index",m]})},onError:()=>{R("Error","Failed to delete user","error")}}),d=J({data:r,columns:s,columnResizeMode:"onChange",enableRowSelection:!0,enableMultiRowSelection:!0,enableColumnFilters:!0,onColumnSizingChange:v,onColumnSizingInfoChange:M,onRowSelectionChange:e=>{const o=typeof e=="function"?e(b):e;n(O(o))},onSortingChange:e=>{const o=typeof e=="function"?e(C):e;n(N(o)),o.length>0&&n(y({...m,sort:o[0].id,order:o[0].desc?"desc":"asc"}))},onColumnVisibilityChange:e=>{const o=typeof e=="function"?e(h):e;n(A(o))},onColumnFiltersChange:e=>{const o=typeof e=="function"?e(w):e;D(o);const f=Object.fromEntries(o.map(a=>[a.id,typeof a.value=="object"?JSON.stringify(a.value):String(a.value??"")]));u(f)},getCoreRowModel:L(),getFilteredRowModel:K(),getSortedRowModel:B(),state:{rowSelection:b,sorting:C,columnVisibility:h,columnSizing:U,columnSizingInfo:F,columnFilters:w}});t.useEffect(()=>{n(y({...m,filter:JSON.stringify(S)}))},[S,n]);const j=e=>{const o=new z(e.original);q.visit(`/organization/user/view?id=${o.UUID}`)},E=()=>{const e=d.getSelectedRowModel().rows.map(o=>new z(o.original));V.mutate(e)};return i.jsx("main",{className:"w-full",children:i.jsxs("div",{className:"overflow-hidden rounded-md border",children:[i.jsx("div",{className:"w-full",children:i.jsx(Q,{isLoading:p,createAction:{to:"/organization/user/create"},deleteAction:{action:E},refreshAction:{action:l},table:d})}),i.jsx(k,{table:d,isLoading:p,onSelectRow:j})]})})}export{ge as default};
