import{a as p,j as e,E as Z,P as Q,N as _,Z as W,L,M as z,ae as Y,x as ee,h as te}from"./main-CTqjNw_1.js";import{u as ae,f as re,b as se}from"./index-CnNRcPLH.js";import{T as ne,a as oe,b as j,c as le,d as ce,e as B}from"./table-BewgXXBq.js";import{c as S}from"./ColumnConfig-YjGSvveN.js";import{A as k}from"./ApiTestDataFormField-ByY0ei_5.js";import{u as ie,S as de,a as ue,c as pe,d as E}from"./select-_dgOU_uZ.js";import{C as me}from"./check-Bg_uiSoa.js";import{S as be}from"./skeleton-DxtYuBVh.js";import{u as he}from"./useAppSelector-CajmzB0M.js";import{I as fe}from"./input-DHBdGodr.js";import{a as P,b as w,d as F}from"./form-DKo2ZhVV.js";import{d as xe}from"./index.esm-yWvBp1Bw.js";import{D,T as ge}from"./table-selection-popover-BZpy3OWt.js";import"./button-D7O1ICWX.js";import"./createLucideIcon-2IL8zAdl.js";import"./index-8dUMp5rv.js";import"./index-C7ol3PDU.js";import"./label-CPEOG6gq.js";import"./popover-Cupe1OSJ.js";import"./index-Dunr3axe.js";import"./ClientDatabaseTableViewModel-CWID7VbN.js";import"./clientDatabaseSelectors-BCEKIPh0.js";import"./loader-circle-Bwy7VCbj.js";var T="Checkbox",[ke,Ze]=Z(T),[Ce,A]=ke(T);function ve(a){const{__scopeCheckbox:n,checked:i,children:o,defaultChecked:c,disabled:s,form:x,name:m,onCheckedChange:d,required:C,value:v="on",internal_do_not_use_render:r}=a,[t,f]=W({prop:i,defaultProp:c??!1,onChange:d,caller:T}),[l,b]=p.useState(null),[h,u]=p.useState(null),g=p.useRef(!1),N=l?!!x||!!l.closest("form"):!0,R={checked:t,disabled:s,setChecked:f,control:l,setControl:b,name:m,form:x,value:v,hasConsumerStoppedPropagationRef:g,required:C,defaultChecked:y(c)?!1:c,isFormControl:N,bubbleInput:h,setBubbleInput:u};return e.jsx(Ce,{scope:n,...R,children:ye(r)?r(R):o})}var $="CheckboxTrigger",I=p.forwardRef(({__scopeCheckbox:a,onKeyDown:n,onClick:i,...o},c)=>{const{control:s,value:x,disabled:m,checked:d,required:C,setControl:v,setChecked:r,hasConsumerStoppedPropagationRef:t,isFormControl:f,bubbleInput:l}=A($,a),b=L(c,v),h=p.useRef(d);return p.useEffect(()=>{const u=s?.form;if(u){const g=()=>r(h.current);return u.addEventListener("reset",g),()=>u.removeEventListener("reset",g)}},[s,r]),e.jsx(_.button,{type:"button",role:"checkbox","aria-checked":y(d)?"mixed":d,"aria-required":C,"data-state":V(d),"data-disabled":m?"":void 0,disabled:m,value:x,...o,ref:b,onKeyDown:z(n,u=>{u.key==="Enter"&&u.preventDefault()}),onClick:z(i,u=>{r(g=>y(g)?!0:!g),l&&f&&(t.current=u.isPropagationStopped(),t.current||u.stopPropagation())})})});I.displayName=$;var M=p.forwardRef((a,n)=>{const{__scopeCheckbox:i,name:o,checked:c,defaultChecked:s,required:x,disabled:m,value:d,onCheckedChange:C,form:v,...r}=a;return e.jsx(ve,{__scopeCheckbox:i,checked:c,defaultChecked:s,disabled:m,required:x,onCheckedChange:C,name:o,form:v,value:d,internal_do_not_use_render:({isFormControl:t})=>e.jsxs(e.Fragment,{children:[e.jsx(I,{...r,ref:n,__scopeCheckbox:i}),t&&e.jsx(q,{__scopeCheckbox:i})]})})});M.displayName=T;var H="CheckboxIndicator",K=p.forwardRef((a,n)=>{const{__scopeCheckbox:i,forceMount:o,...c}=a,s=A(H,i);return e.jsx(Q,{present:o||y(s.checked)||s.checked===!0,children:e.jsx(_.span,{"data-state":V(s.checked),"data-disabled":s.disabled?"":void 0,...c,ref:n,style:{pointerEvents:"none",...a.style}})})});K.displayName=H;var J="CheckboxBubbleInput",q=p.forwardRef(({__scopeCheckbox:a,...n},i)=>{const{control:o,hasConsumerStoppedPropagationRef:c,checked:s,defaultChecked:x,required:m,disabled:d,name:C,value:v,form:r,bubbleInput:t,setBubbleInput:f}=A(J,a),l=L(i,f),b=ie(s),h=Y(o);p.useEffect(()=>{const g=t;if(!g)return;const N=window.HTMLInputElement.prototype,O=Object.getOwnPropertyDescriptor(N,"checked").set,U=!c.current;if(b!==s&&O){const X=new Event("click",{bubbles:U});g.indeterminate=y(s),O.call(g,y(s)?!1:s),g.dispatchEvent(X)}},[t,b,s,c]);const u=p.useRef(y(s)?!1:s);return e.jsx(_.input,{type:"checkbox","aria-hidden":!0,defaultChecked:x??u.current,required:m,disabled:d,name:C,value:v,form:r,...n,tabIndex:-1,ref:l,style:{...n.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});q.displayName=J;function ye(a){return typeof a=="function"}function y(a){return a==="indeterminate"}function V(a){return y(a)?"indeterminate":a?"checked":"unchecked"}function G({className:a,...n}){return e.jsx(M,{"data-slot":"checkbox",className:ee("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",a),...n,children:e.jsx(K,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(me,{className:"size-3.5"})})})}function je(a,n){return({getValue:i,row:o})=>{const c=!!i(),s=o.original,x=n?.disabled?.(s)??!1,m=n?.ariaLabel?.(s)??"Toggle";return e.jsx("div",{className:"flex items-center",onClick:d=>d.stopPropagation(),children:e.jsx(G,{checked:c,disabled:x,"aria-label":m,onCheckedChange:d=>a({row:s,next:!!d}),className:"translate-y-[1px]"})})}}const Se=[S({accessorKey:k.enabled.name,header:null,size:44,minSize:36,maxSize:64,enableSorting:!1,cell:je(({row:a,next:n})=>{console.log(a),console.log(n)},{})}),S({accessorKey:k.key.name,header:k.key.label,enableSorting:!1}),S({accessorKey:k.value.name,header:k.value.label,enableSorting:!1}),S({accessorKey:k.description.name,header:k.description.label,enableSorting:!1})],Te=["key","value","description"],Ne=a=>Te.includes(a);function Qe({form:a}){const[n,i]=p.useState(null),{fields:o,append:c}=xe({control:a.control,name:"apiTestData"}),s=ae({data:structuredClone(o),columns:Se,enableRowSelection:!0,enableSorting:!1,enableFilters:!1,enableSortingRemoval:!1,getCoreRowModel:se()}),x=he(te),m=p.useRef(null),d=r=>{if(typeof r=="number"){if(m.current===r)return;m.current=r}const t=new D;t.setField("text"),console.log("Text: ",t.asJSONString()),c({isNew:"1",enabled:"0",key:"",value:"",description:"",fieldType:t.asJSONString()},{shouldFocus:!1})},C=(r,t)=>{a.setValue(`apiTestData.${r}.enabled`,t),r===o.length-1&&t==="1"&&d(r)},v=r=>{a.getValues(`apiTestData.${r}.enabled`)!=="1"&&a.setValue(`apiTestData.${r}.enabled`,"1"),r===o.length-1&&d(r)};return p.useEffect(()=>{if(o.length===0){const r=new D;r.setField("text"),console.log("JSON: ",r.asJSONString()),c({isNew:"1",enabled:"0",key:"",value:"",description:"",fieldType:r.asJSONString()},{shouldFocus:!1}),m.current=null}},[o.length,c]),e.jsxs(ne,{className:"card",children:[e.jsx(oe,{children:s.getHeaderGroups().map(r=>e.jsx(j,{className:"border-b border-accent dark:border-accent",children:r.headers.map(t=>e.jsxs(le,{className:"m-0 p-0 border-r border-accent dark:border-accent last:border-r-0",style:{width:t.getSize()},children:[t.isPlaceholder?null:re(t.column.columnDef.header,t.getContext()),t.column.getCanResize()&&e.jsx("div",{onMouseDown:t.getResizeHandler(),onTouchStart:t.getResizeHandler(),className:`absolute right-0 top-0 h-full w-1 cursor-col-resize select-none
                                            ${t.column.getIsResizing()?"bg-blue-500":"bg-transparent hover:bg-gray-400"}`})]},t.id))},r.id))}),e.jsx(ce,{children:x?Array.from({length:5}).map((r,t)=>e.jsx(j,{children:s.getAllLeafColumns().map(f=>e.jsx("td",{className:"px-2 py-2",children:e.jsx(be,{className:"h-4 w-full rounded-2xl p-4 m-1 gap-2"})},f.id))},`skeleton-${t}`)):o.length>0?o.map((r,t)=>e.jsx(j,{className:"cursor-pointer p-2 border border-accent dark:border-accent text-foreground dark:text-foreground",children:s.getAllLeafColumns().map(f=>e.jsx(B,{className:"p-2",children:f.id===k.enabled.name?e.jsx(P,{control:a.control,name:`apiTestData.${t}.enabled`,render:({field:l})=>e.jsx(w,{children:e.jsx(F,{children:e.jsx("div",{onClick:b=>b.stopPropagation(),className:"flex items-center",children:e.jsx(G,{checked:l.value==="1",onCheckedChange:b=>{const h=b?"1":"0";l.onChange(h),C(t,h)},"aria-label":"Toggle",className:"cursor-pointer h-6 w-6 shrink-0 translate-y-[1px]"})})})})}):Ne(f.id)&&e.jsxs("div",{className:"flex flex-row gap-1",children:[e.jsx(P,{control:a.control,name:`apiTestData.${t}.${f.id}`,render:({field:l})=>e.jsx(w,{children:e.jsx(F,{children:e.jsx(fe,{...l,value:l.value??"",onChange:b=>l.onChange(b.target.value),onFocus:()=>v(t),className:"w-full h-8"})})})}),e.jsx(P,{name:`apiTestData.${t}.${k.fieldType.name}`,control:a.control,render:({field:l})=>{const b=(()=>{try{return(typeof l.value=="string"?JSON.parse(l.value):l.value)?.field??"text"}catch{return"text"}})();return e.jsx(w,{children:e.jsx(F,{children:f.id===k.value.name&&e.jsxs(p.Fragment,{children:[e.jsxs(de,{value:b,onValueChange:h=>{const u=new D;u.setField(h),l.onChange(u.asJSONString()),setTimeout(h==="dropdown"?()=>i(t):()=>i(null),500)},children:[e.jsx(ue,{className:"h-6 w-6 flex items-center justify-center rounded-md border text-xs p-1"}),e.jsxs(pe,{children:[e.jsx(E,{value:"text",children:"Text"}),e.jsx(E,{value:"dropdown",children:"Dropdown"}),e.jsx(E,{value:"file",children:"File"})]})]}),e.jsx(ge,{rowIndex:t,isOpen:n===t,setIsOpen:h=>i(h?t:null)})]})})})}})]})},f.id))},r.id)):e.jsx(j,{children:e.jsx(B,{colSpan:s.getAllLeafColumns().length,className:"h-24 text-center text-muted-foreground",children:"No test data rows found."})})})]})}export{Qe as default};
