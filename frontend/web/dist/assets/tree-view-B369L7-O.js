import{a as i,B as W,j as n,z as Z,J,I as C,o as S,h as Y,u as Q,aa as T,e as g,t as ee,ab as te,ac as A,ad as ne,ae as oe,af as ae,g as re}from"./main-jHgsLNnl.js";import{B as b}from"./button-DjTqcUE2.js";import{u as M}from"./useAppSelector-ChTCo2r2.js";import{c as P,R as se,A as ie,P as ce,C as ue,I as de,G as le,L as pe,a as xe,d as me,e as fe,b as ve,S as he,f as Ce,g as ge,h as Me}from"./index-Cfla-H_q.js";import{s as _e,b as Ne,c as Ie}from"./apiTestSelectors-BJyltacD.js";import{I as Re}from"./input-BhG5BCxA.js";import{u as Te}from"./useApiTestService-BrA_eCDL.js";import{u as Ae}from"./use-show-toast-BVIQ8Yfq.js";import{C as be}from"./chevron-right-CiG5yxZh.js";import{c as y}from"./createLucideIcon-CefoJE8A.js";import"./index-Cl0nCJPG.js";import"./index-D0Cy897d.js";import"./index-Bd7qMxyT.js";import"./useRequest-BH6Abvdf.js";import"./useAuthState-es3h8Dr5.js";import"./BaseEntity-DGhPHkWu.js";import"./ApiTestViewModel-DgxPnehm.js";import"./serviceHandler-BlQljMi1.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],je=y("file-text",we);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Se=y("folder",Ue);var I="ContextMenu",[Pe,bt]=Z(I,[P]),d=P(),[ye,E]=Pe(I),D=e=>{const{__scopeContextMenu:o,children:a,onOpenChange:t,dir:r,modal:s=!0}=e,[p,l]=i.useState(!1),v=d(o),m=W(t),u=i.useCallback(f=>{l(f),m(f)},[m]);return n.jsx(ye,{scope:o,open:p,onOpenChange:u,modal:s,children:n.jsx(se,{...v,dir:r,open:p,onOpenChange:u,modal:s,children:a})})};D.displayName=I;var O="ContextMenuTrigger",k=i.forwardRef((e,o)=>{const{__scopeContextMenu:a,disabled:t=!1,...r}=e,s=E(O,a),p=d(a),l=i.useRef({x:0,y:0}),v=i.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...l.current})}),m=i.useRef(0),u=i.useCallback(()=>window.clearTimeout(m.current),[]),f=x=>{l.current={x:x.clientX,y:x.clientY},s.onOpenChange(!0)};return i.useEffect(()=>u,[u]),i.useEffect(()=>void(t&&u()),[t,u]),n.jsxs(n.Fragment,{children:[n.jsx(ie,{...p,virtualRef:v}),n.jsx(J.span,{"data-state":s.open?"open":"closed","data-disabled":t?"":void 0,...r,ref:o,style:{WebkitTouchCallout:"none",...e.style},onContextMenu:t?e.onContextMenu:C(e.onContextMenu,x=>{u(),f(x),x.preventDefault()}),onPointerDown:t?e.onPointerDown:C(e.onPointerDown,_(x=>{u(),m.current=window.setTimeout(()=>f(x),700)})),onPointerMove:t?e.onPointerMove:C(e.onPointerMove,_(u)),onPointerCancel:t?e.onPointerCancel:C(e.onPointerCancel,_(u)),onPointerUp:t?e.onPointerUp:C(e.onPointerUp,_(u))})]})});k.displayName=O;var Ee="ContextMenuPortal",G=e=>{const{__scopeContextMenu:o,...a}=e,t=d(o);return n.jsx(ce,{...t,...a})};G.displayName=Ee;var L="ContextMenuContent",$=i.forwardRef((e,o)=>{const{__scopeContextMenu:a,...t}=e,r=E(L,a),s=d(a),p=i.useRef(!1);return n.jsx(ue,{...s,...t,ref:o,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:l=>{e.onCloseAutoFocus?.(l),!l.defaultPrevented&&p.current&&l.preventDefault(),p.current=!1},onInteractOutside:l=>{e.onInteractOutside?.(l),!l.defaultPrevented&&!r.modal&&(p.current=!0)},style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});$.displayName=L;var De="ContextMenuGroup",Oe=i.forwardRef((e,o)=>{const{__scopeContextMenu:a,...t}=e,r=d(a);return n.jsx(le,{...r,...t,ref:o})});Oe.displayName=De;var ke="ContextMenuLabel",Ge=i.forwardRef((e,o)=>{const{__scopeContextMenu:a,...t}=e,r=d(a);return n.jsx(pe,{...r,...t,ref:o})});Ge.displayName=ke;var Le="ContextMenuItem",z=i.forwardRef((e,o)=>{const{__scopeContextMenu:a,...t}=e,r=d(a);return n.jsx(de,{...r,...t,ref:o})});z.displayName=Le;var $e="ContextMenuCheckboxItem",ze=i.forwardRef((e,o)=>{const{__scopeContextMenu:a,...t}=e,r=d(a);return n.jsx(xe,{...r,...t,ref:o})});ze.displayName=$e;var Be="ContextMenuRadioGroup",Fe=i.forwardRef((e,o)=>{const{__scopeContextMenu:a,...t}=e,r=d(a);return n.jsx(me,{...r,...t,ref:o})});Fe.displayName=Be;var He="ContextMenuRadioItem",qe=i.forwardRef((e,o)=>{const{__scopeContextMenu:a,...t}=e,r=d(a);return n.jsx(fe,{...r,...t,ref:o})});qe.displayName=He;var Xe="ContextMenuItemIndicator",Ke=i.forwardRef((e,o)=>{const{__scopeContextMenu:a,...t}=e,r=d(a);return n.jsx(ve,{...r,...t,ref:o})});Ke.displayName=Xe;var Ve="ContextMenuSeparator",We=i.forwardRef((e,o)=>{const{__scopeContextMenu:a,...t}=e,r=d(a);return n.jsx(he,{...r,...t,ref:o})});We.displayName=Ve;var Ze="ContextMenuArrow",Je=i.forwardRef((e,o)=>{const{__scopeContextMenu:a,...t}=e,r=d(a);return n.jsx(Ce,{...r,...t,ref:o})});Je.displayName=Ze;var Ye="ContextMenuSubTrigger",Qe=i.forwardRef((e,o)=>{const{__scopeContextMenu:a,...t}=e,r=d(a);return n.jsx(ge,{...r,...t,ref:o})});Qe.displayName=Ye;var et="ContextMenuSubContent",tt=i.forwardRef((e,o)=>{const{__scopeContextMenu:a,...t}=e,r=d(a);return n.jsx(Me,{...r,...t,ref:o,style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});tt.displayName=et;function _(e){return o=>o.pointerType!=="mouse"?e(o):void 0}var nt=D,ot=k,at=G,rt=$,st=z;function w({...e}){return n.jsx(nt,{"data-slot":"context-menu",...e})}function j({...e}){return n.jsx(ot,{"data-slot":"context-menu-trigger",...e})}function U({className:e,...o}){return n.jsx(at,{children:n.jsx(rt,{"data-slot":"context-menu-content",className:S("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...o})})}function N({className:e,inset:o,variant:a="default",...t}){return n.jsx(st,{"data-slot":"context-menu-item","data-inset":o,"data-variant":a,className:S("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}const it=e=>e.clientDatabase.clientDatabase;function ct({node:e,level:o=0}){const{id:a}=Y().props,t=Q(),r=o*8,s=M(_e),p=M(Ne),l=M(Ie),v=M(it),m=Ae(),u=p.includes(e.UUID),f=s?.UUID===e.UUID,{createApiTest:x,removeApiTest:B}=Te(),R=c=>{t(ee(c))},F=c=>{t(te(c))},H=async()=>{try{if(s&&v){const c={...s,project:a,transmission:"formData",clientDatabase:v.UUID,seq:1};await x(c,v.refreshToken,{onSuccess:h=>{const K=[s?.UUID].filter(V=>V!==void 0);t(A(K)),t(ne(h)),t(g(null)),t(oe(h))}})}}catch(c){console.error(c),m("Error","Unexpected error","error")}},q=async()=>{const c=[s?.UUID].filter(h=>h!==void 0);await B(c,{onSuccess:h=>{h.success.length>0&&(t(ae()),t(A(c)))},onError:()=>{m("Error","Server error","error")}})},X=c=>{t(re({action:"rename",dto:c.apiDTO}))};return e.isFolder?n.jsxs("div",{children:[n.jsxs(w,{children:[n.jsx(j,{children:n.jsxs(b,{variant:"ghost",onClick:()=>{F(e.UUID),R(e)},className:`w-full flex items-center justify-start gap-1 ${f?"bg-accent":""}`,style:{paddingLeft:`${r}px`},children:[n.jsx(be,{className:`h-4 w-4 transform transition-transform duration-300 ${u?"rotate-90":""}`}),n.jsx(Se,{size:16}),n.jsx("span",{className:"text-sm",children:e.testName})]})}),n.jsxs(U,{children:[n.jsx(N,{children:"Rename"}),n.jsx(N,{children:"Remove"})]})]}),u&&e.apiTests?.map(c=>n.jsx(ct,{node:c,level:o+1},c.UUID))]}):n.jsx("div",{className:"flex items-center gap-1 w-full",style:{paddingLeft:`${r+8}px`},children:n.jsxs(w,{children:[n.jsx(j,{className:"w-full",children:l==="rename"&&s?.UUID===e.UUID?n.jsx(Re,{value:s?.testName??s?.testName,autoFocus:!0,onChange:c=>{t(g(c.target.value))},onBlur:()=>{s?.UUID&&t(T({UUID:s.UUID,newName:s.testName??""})),t(g(null))},onKeyDown:c=>{c.key==="Enter"&&s?.UUID&&(t(T({UUID:s.UUID,newName:s.testName??""})),H(),t(g(null)))}}):n.jsxs(b,{variant:"ghost",onClick:()=>R(e),className:`w-full flex items-center justify-start gap-1 ${f?"bg-accent":""}`,children:[n.jsx(je,{size:16}),e.testName]})}),n.jsxs(U,{children:[n.jsx(N,{className:"cursor-pointer",onClick:()=>X(e),children:"Rename"}),n.jsx(N,{className:"cursor-pointer",onClick:q,children:"Remove"})]})]})})}export{ct as default};
