import{a as h,j as e,E as Z,P as Q,N as A,Z as W,L as $,M as O,af as Y,x as ee,h as te}from"./main-TA8bC7Bt.js";import{u as ae,f as se,b as re}from"./index-CtVAL_3k.js";import{T as ne,a as oe,b as T,c as le,d as ce,e as w}from"./table-XDPYTTe_.js";import{c as S}from"./ColumnConfig-DosrtjSH.js";import{A as C}from"./ApiTestDataFormField-B5ImqALB.js";import{u as ie,S as de,a as ue,c as pe,d as E}from"./select-D5VTl43s.js";import{C as me}from"./check-DxqNlIfg.js";import{S as he}from"./skeleton-Bs0S7sAS.js";import{u as be}from"./useAppSelector-B1phOAD2.js";import{I as fe}from"./input-dLup5WN3.js";import{a as P,b as F,d as D}from"./form-ozKIHDmp.js";import{d as xe}from"./index.esm-D8l67r9b.js";import{D as _,T as ge}from"./table-selection-popover-Dny9kYnd.js";import{B as ke}from"./button-Cbt3Ix14.js";import"./createLucideIcon-zbHoiiAn.js";import"./index-BBcvBNZT.js";import"./index-Du_cN1mI.js";import"./label-BvyJtc9X.js";import"./popover-SzdN6lWv.js";import"./index-B4-W0Byi.js";import"./ClientDatabaseTableViewModel-CWID7VbN.js";import"./clientDatabaseSelectors-BCEKIPh0.js";import"./loader-circle-KgTJtckO.js";var N="Checkbox",[Ce,Qe]=Z(N),[ve,z]=Ce(N);function ye(a){const{__scopeCheckbox:l,checked:p,children:c,defaultChecked:i,disabled:r,form:m,name:f,onCheckedChange:d,required:k,value:v="on",internal_do_not_use_render:x}=a,[g,s]=W({prop:p,defaultProp:i??!1,onChange:d,caller:N}),[t,b]=h.useState(null),[u,o]=h.useState(null),n=h.useRef(!1),j=t?!!m||!!t.closest("form"):!0,R={checked:g,disabled:r,setChecked:s,control:t,setControl:b,name:f,form:m,value:v,hasConsumerStoppedPropagationRef:n,required:k,defaultChecked:y(i)?!1:i,isFormControl:j,bubbleInput:u,setBubbleInput:o};return e.jsx(ve,{scope:l,...R,children:je(x)?x(R):c})}var L="CheckboxTrigger",M=h.forwardRef(({__scopeCheckbox:a,onKeyDown:l,onClick:p,...c},i)=>{const{control:r,value:m,disabled:f,checked:d,required:k,setControl:v,setChecked:x,hasConsumerStoppedPropagationRef:g,isFormControl:s,bubbleInput:t}=z(L,a),b=$(i,v),u=h.useRef(d);return h.useEffect(()=>{const o=r?.form;if(o){const n=()=>x(u.current);return o.addEventListener("reset",n),()=>o.removeEventListener("reset",n)}},[r,x]),e.jsx(A.button,{type:"button",role:"checkbox","aria-checked":y(d)?"mixed":d,"aria-required":k,"data-state":J(d),"data-disabled":f?"":void 0,disabled:f,value:m,...c,ref:b,onKeyDown:O(l,o=>{o.key==="Enter"&&o.preventDefault()}),onClick:O(p,o=>{x(n=>y(n)?!0:!n),t&&s&&(g.current=o.isPropagationStopped(),g.current||o.stopPropagation())})})});M.displayName=L;var H=h.forwardRef((a,l)=>{const{__scopeCheckbox:p,name:c,checked:i,defaultChecked:r,required:m,disabled:f,value:d,onCheckedChange:k,form:v,...x}=a;return e.jsx(ye,{__scopeCheckbox:p,checked:i,defaultChecked:r,disabled:f,required:m,onCheckedChange:k,name:c,form:v,value:d,internal_do_not_use_render:({isFormControl:g})=>e.jsxs(e.Fragment,{children:[e.jsx(M,{...x,ref:l,__scopeCheckbox:p}),g&&e.jsx(V,{__scopeCheckbox:p})]})})});H.displayName=N;var I="CheckboxIndicator",K=h.forwardRef((a,l)=>{const{__scopeCheckbox:p,forceMount:c,...i}=a,r=z(I,p);return e.jsx(Q,{present:c||y(r.checked)||r.checked===!0,children:e.jsx(A.span,{"data-state":J(r.checked),"data-disabled":r.disabled?"":void 0,...i,ref:l,style:{pointerEvents:"none",...a.style}})})});K.displayName=I;var q="CheckboxBubbleInput",V=h.forwardRef(({__scopeCheckbox:a,...l},p)=>{const{control:c,hasConsumerStoppedPropagationRef:i,checked:r,defaultChecked:m,required:f,disabled:d,name:k,value:v,form:x,bubbleInput:g,setBubbleInput:s}=z(q,a),t=$(p,s),b=ie(r),u=Y(c);h.useEffect(()=>{const n=g;if(!n)return;const j=window.HTMLInputElement.prototype,B=Object.getOwnPropertyDescriptor(j,"checked").set,U=!i.current;if(b!==r&&B){const X=new Event("click",{bubbles:U});n.indeterminate=y(r),B.call(n,y(r)?!1:r),n.dispatchEvent(X)}},[g,b,r,i]);const o=h.useRef(y(r)?!1:r);return e.jsx(A.input,{type:"checkbox","aria-hidden":!0,defaultChecked:m??o.current,required:f,disabled:d,name:k,value:v,form:x,...l,tabIndex:-1,ref:t,style:{...l.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});V.displayName=q;function je(a){return typeof a=="function"}function y(a){return a==="indeterminate"}function J(a){return y(a)?"indeterminate":a?"checked":"unchecked"}function G({className:a,...l}){return e.jsx(H,{"data-slot":"checkbox",className:ee("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",a),...l,children:e.jsx(K,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(me,{className:"size-3.5"})})})}function Te(a,l){return({getValue:p,row:c})=>{const i=!!p(),r=c.original,m=l?.disabled?.(r)??!1,f=l?.ariaLabel?.(r)??"Toggle";return e.jsx("div",{className:"flex items-center",onClick:d=>d.stopPropagation(),children:e.jsx(G,{checked:i,disabled:m,"aria-label":f,onCheckedChange:d=>a({row:r,next:!!d}),className:"translate-y-[1px]"})})}}const Se=[S({accessorKey:C.enabled.name,header:null,size:44,minSize:36,maxSize:64,enableSorting:!1,cell:Te(({row:a,next:l})=>{console.log(a),console.log(l)},{})}),S({accessorKey:C.key.name,header:C.key.label,enableSorting:!1}),S({accessorKey:C.value.name,header:C.value.label,enableSorting:!1}),S({accessorKey:C.description.name,header:C.description.label,enableSorting:!1})],Ne=["key","value","description"],Re=a=>Ne.includes(a);function We({form:a}){const[l,p]=h.useState(null),{fields:c,append:i,remove:r}=xe({control:a.control,name:"apiTestData"}),m=ae({data:structuredClone(c),columns:Se,enableRowSelection:!0,enableSorting:!1,enableFilters:!1,enableSortingRemoval:!1,getCoreRowModel:re()}),f=be(te),d=h.useRef(null),k=s=>{if(typeof s=="number"){if(d.current===s)return;d.current=s}const t=new _;t.setField("text"),i({isNew:1,enabled:0,key:"",value:"",description:"",fieldType:t.asJSONString()},{shouldFocus:!1})},v=(s,t)=>{a.setValue(`apiTestData.${s}.enabled`,t),s===c.length-1&&t===1&&k(s)},x=s=>{a.getValues(`apiTestData.${s}.enabled`)!==1&&a.setValue(`apiTestData.${s}.enabled`,1),s===c.length-1&&k(s)},g=s=>{a.setValue(`apiTestData.${s}.isDelete`,1),r(s)};return h.useEffect(()=>{if(c.length===0){const s=new _;s.setField("text"),i({isNew:1,enabled:0,key:"",value:"",description:"",fieldType:s.asJSONString()},{shouldFocus:!1}),d.current=null}},[c.length,i]),e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsxs(ne,{className:"card",children:[e.jsx(oe,{children:m.getHeaderGroups().map(s=>e.jsx(T,{className:"border-b border-accent dark:border-accent",children:s.headers.map(t=>e.jsxs(le,{className:"m-0 p-0 border-r border-accent dark:border-accent last:border-r-0",style:{width:t.getSize()},children:[t.isPlaceholder?null:se(t.column.columnDef.header,t.getContext()),t.column.getCanResize()&&e.jsx("div",{onMouseDown:t.getResizeHandler(),onTouchStart:t.getResizeHandler(),className:`absolute right-0 top-0 h-full w-1 cursor-col-resize select-none
                                            ${t.column.getIsResizing()?"bg-blue-500":"bg-transparent hover:bg-gray-400"}`})]},t.id))},s.id))}),e.jsx(ce,{children:f?Array.from({length:5}).map((s,t)=>e.jsx(T,{children:m.getAllLeafColumns().map(b=>e.jsx("td",{className:"px-2 py-2",children:e.jsx(he,{className:"h-4 w-full rounded-2xl p-4 m-1 gap-2"})},b.id))},`skeleton-${t}`)):c.length>0?c.map((s,t)=>e.jsxs(T,{className:"cursor-pointer p-2 border border-accent dark:border-accent text-foreground dark:text-foreground",children:[m.getAllLeafColumns().map(b=>e.jsx(w,{className:"p-2",children:b.id===C.enabled.name?e.jsx(P,{control:a.control,name:`apiTestData.${t}.enabled`,render:({field:u})=>e.jsx(F,{children:e.jsx(D,{children:e.jsx("div",{onClick:o=>o.stopPropagation(),className:"flex items-center",children:e.jsx(G,{checked:u.value===1,onCheckedChange:o=>{const n=o?1:0;u.onChange(n),v(t,n)},"aria-label":"Toggle",className:"cursor-pointer h-6 w-6 shrink-0 translate-y-[1px]"})})})})}):Re(b.id)&&e.jsxs("div",{className:"flex flex-row gap-1",children:[e.jsx(P,{control:a.control,name:`apiTestData.${t}.${b.id}`,render:({field:u})=>e.jsx(F,{children:e.jsx(D,{children:e.jsx(fe,{...u,value:u.value??"",onChange:o=>u.onChange(o.target.value),onFocus:()=>x(t),className:"w-full h-8"})})})}),e.jsx(P,{name:`apiTestData.${t}.${C.fieldType.name}`,control:a.control,render:({field:u})=>{const o=(()=>{try{if(!u.value)return"text";const n=typeof u.value=="string"?JSON.parse(u.value):u.value;return(n?Object.keys(n)[0]:"text")||"text"}catch{return"text"}})();return e.jsx(F,{children:e.jsx(D,{children:b.id===C.value.name&&e.jsxs(h.Fragment,{children:[e.jsxs(de,{value:o,onValueChange:n=>{const j=new _;j.setField(n),u.onChange(j.asJSONString()),setTimeout(n==="dropdown"?()=>p(t):()=>p(null),300)},children:[e.jsx(ue,{className:"h-6 w-6 flex items-center justify-center rounded-md border text-xs p-1"}),e.jsxs(pe,{children:[e.jsx(E,{value:"text",children:"Text"}),e.jsx(E,{value:"dropdown",children:"Dropdown"}),e.jsx(E,{value:"file",children:"File"})]})]}),e.jsx(ge,{rowIndex:t,isOpen:l===t,setIsOpen:n=>p(n?t:null)})]})})})}})]})},b.id)),e.jsx(w,{className:"text-center w-4",children:e.jsx(ke,{type:"button",variant:"destructive",size:"sm",onClick:()=>g(t),className:"h-8 w-8 p-2 rounded-full",children:"âœ•"})})]},s.id)):e.jsx(T,{children:e.jsx(w,{colSpan:m.getAllLeafColumns().length,className:"h-24 text-center text-muted-foreground",children:"No test data rows found."})})})]})})}export{We as default};
