import{c as n,a as y,j as e}from"./main-MEdhB5dg.js";import{C,u as v,D as V,b as U,c as I,g as q}from"./useClientDatabaseService-kDyGIFq-.js";import{F as M,a as i,b as c,c as d,d as x,e as b}from"./form-CXciyeEn.js";import{I as u}from"./input-Cysv_Y7h.js";import{u as T,a as B}from"./zod-DNRiK3QT.js";import{o as k,s as h}from"./schemas-6m5s2bNq.js";import{B as H}from"./button-B3fiDnxR.js";import{S as L}from"./save-button-Dod_KY6I.js";import{u as P}from"./use-show-toast-C-iW8Qdm.js";import{u as z}from"./useAppSelector-B1wUI6oO.js";import{X as A}from"./index-ITQwHDNF.js";import"./index-CZZ-zNjt.js";import"./serviceHandler-BlQljMi1.js";import"./useRequest-D_nlpoxs.js";import"./BaseEntity-DGhPHkWu.js";import"./index-MGWubpvo.js";import"./createLucideIcon-mq840p9J.js";const a={databaseName:n({name:"databaseName",label:"Database Name",max:50}),databaseSchema:n({name:"databaseSchema",label:"Database Schema",max:50}),host:n({name:"host",label:"Host",max:50}),port:n({name:"port",label:"Port",max:50}),username:n({name:"username",label:"Username",max:50}),password:n({name:"password",label:"Password",max:50})},R=k({databaseName:h().max(a.databaseName.max,{error:a.databaseName.maxError}),databaseSchema:h().max(a.databaseSchema.max,{error:a.databaseSchema.maxError}),host:h().max(a.host.max,{error:a.host.maxError}),port:h().max(a.port.max,{error:a.port.maxError}),username:h().max(a.username.max,{error:a.username.maxError}),password:h().max(a.password.max,{error:a.password.maxError})}),X=({clientDatabaseDTO:p})=>{const[o,j]=y.useState(()=>p?new C(p):void 0),s=T({resolver:B(R),defaultValues:{databaseName:o?.databaseName??"",databaseSchema:o?.databaseSchema??"",host:o?.host??"",port:o?.port??"",username:o?.username??"",password:o?.password??""}});return{form:s,setFormError:(f,w)=>{const{setToastError:D}=w||{},N=f,t=N?.response?.data?.errors??{};typeof t=="string"?D?.(t):t&&Object.keys(t).length>0?Object.keys(t).forEach(m=>{const S=m.replace(/^clientDatabase\./,"");S in s.getValues()&&s.setError(S,{type:"server",message:t[m][0]??"Invalid value"})}):D?.(N?.response?.data?.message??"Server error")},clientDatabaseViewModel:o,setClientDatabaseViewModel:j}};function le({clientDatabaseDTO:p,open:o,onOpenChange:j}){const{form:s,setFormError:g,clientDatabaseViewModel:f,setClientDatabaseViewModel:w}=X({clientDatabaseDTO:p}),{createClientDatabase:D,updateClientDatabase:N}=v(),t=P(),m=z(r=>r.loading.global),S=async()=>{const E={...s.getValues(),...f?.UUID?{UUID:f.UUID}:{}};E?.UUID?await N(E,{onSuccess:l=>{w(l),j(!1)},onError:l=>{g(l,{setToastError(F){t("Error",F,"error")}})}}):await D(E,{onSuccess:l=>{w(l),j(!1)},onError:l=>{g(l,{setToastError(F){t("Error",F,"error")}})}})};return e.jsx(V,{open:o,onOpenChange:j,children:e.jsx(U,{className:"sm:max-w-[520px]",showCloseButton:!1,children:e.jsx("div",{className:"w-full",children:e.jsx(M,{...s,children:e.jsxs("form",{className:"grid grid-cols-2 gap-4",onSubmit:s.handleSubmit(S),children:[e.jsxs(I,{className:"mb-4 col-span-2 flex flex-row items-center justify-start",children:[e.jsx(L,{}),e.jsx(q,{asChild:!0,children:e.jsx(H,{variant:"ghost",type:"button",className:"cursor-pointer rounded-full",children:e.jsx(A,{className:"h-5 w-5 text-accent-foreground dark:text-accent-foreground"})})})]}),e.jsx(i,{control:s.control,name:a.databaseName.name,render:({field:r})=>e.jsxs(c,{className:"my-1 ml-1 mb-1",children:[e.jsx(d,{children:a.databaseName.label}),e.jsx(x,{children:e.jsx(u,{...r,disabled:m,required:!0})}),e.jsx(b,{})]})}),e.jsx(i,{control:s.control,name:a.databaseSchema.name,render:({field:r})=>e.jsxs(c,{className:"my-1 ml-1 mb-1",children:[e.jsx(d,{children:a.databaseSchema.label}),e.jsx(x,{children:e.jsx(u,{...r,disabled:m,required:!0})}),e.jsx(b,{})]})}),e.jsx(i,{control:s.control,name:a.host.name,render:({field:r})=>e.jsxs(c,{className:"my-1 ml-1 mb-1",children:[e.jsx(d,{children:a.host.label}),e.jsx(x,{children:e.jsx(u,{...r,disabled:m,required:!0})}),e.jsx(b,{})]})}),e.jsx(i,{control:s.control,name:a.port.name,render:({field:r})=>e.jsxs(c,{className:"my-1 ml-1 mb-1",children:[e.jsx(d,{children:a.port.label}),e.jsx(x,{children:e.jsx(u,{...r,disabled:m,required:!0})}),e.jsx(b,{})]})}),e.jsx(i,{control:s.control,name:a.username.name,render:({field:r})=>e.jsxs(c,{className:"my-1 ml-1 mb-1",children:[e.jsx(d,{children:a.username.label}),e.jsx(x,{children:e.jsx(u,{...r,disabled:m,required:!0})}),e.jsx(b,{})]})}),e.jsx(i,{control:s.control,name:a.password.name,render:({field:r})=>e.jsxs(c,{className:"my-1 ml-1 mb-1",children:[e.jsx(d,{children:a.password.label}),e.jsx(x,{children:e.jsx(u,{...r,disabled:m,required:!0})}),e.jsx(b,{})]})})]})})})})})}export{le as default};
