import{a as p,j as e,E as Z,P as Q,N as D,Z as W,L as $,M as z,ae as Y,x as ee,h as te}from"./main-DY2sbF6P.js";import{u as ae,f as re,b as se}from"./index-Dk5hdd9A.js";import{T as ne,a as oe,b as y,c as le,d as ce,e as B}from"./table-DffdKZVv.js";import{c as T}from"./ColumnConfig-BzAXo2IC.js";import{A as k}from"./ApiTestDataFormField-B4kiEgJZ.js";import{u as ie,S as de,a as ue,c as pe,d as E}from"./select-CkajZc4m.js";import{C as me}from"./check-MP7LZKO0.js";import{S as be}from"./skeleton-KmmC_05L.js";import{u as he}from"./useAppSelector-BiPAHM_x.js";import{I as fe}from"./input-DxMNrH09.js";import{F as xe,a as F,b as P,d as w}from"./form-sOEOGGHr.js";import{d as ge}from"./index.esm-D7VeYQlz.js";import{D as L,T as ke}from"./table-selection-popover-C9u0aWxZ.js";import"./button-O2UeMCYz.js";import"./createLucideIcon-CNr2s4p7.js";import"./index-BkYD1EKP.js";import"./index-B14W8M9P.js";import"./label-aBIViTaz.js";import"./popover-azegvj7E.js";import"./index-COGUnvNa.js";import"./ClientDatabaseTableViewModel-CWID7VbN.js";import"./clientDatabaseSelectors-BCEKIPh0.js";import"./loader-circle-D1iJtV4J.js";var S="Checkbox",[Ce,Qe]=Z(S),[ve,_]=Ce(S);function je(a){const{__scopeCheckbox:n,checked:i,children:o,defaultChecked:c,disabled:r,form:x,name:m,onCheckedChange:d,required:C,value:v="on",internal_do_not_use_render:s}=a,[t,f]=W({prop:i,defaultProp:c??!1,onChange:d,caller:S}),[l,b]=p.useState(null),[h,u]=p.useState(null),g=p.useRef(!1),N=l?!!x||!!l.closest("form"):!0,R={checked:t,disabled:r,setChecked:f,control:l,setControl:b,name:m,form:x,value:v,hasConsumerStoppedPropagationRef:g,required:C,defaultChecked:j(c)?!1:c,isFormControl:N,bubbleInput:h,setBubbleInput:u};return e.jsx(ve,{scope:n,...R,children:ye(s)?s(R):o})}var I="CheckboxTrigger",M=p.forwardRef(({__scopeCheckbox:a,onKeyDown:n,onClick:i,...o},c)=>{const{control:r,value:x,disabled:m,checked:d,required:C,setControl:v,setChecked:s,hasConsumerStoppedPropagationRef:t,isFormControl:f,bubbleInput:l}=_(I,a),b=$(c,v),h=p.useRef(d);return p.useEffect(()=>{const u=r?.form;if(u){const g=()=>s(h.current);return u.addEventListener("reset",g),()=>u.removeEventListener("reset",g)}},[r,s]),e.jsx(D.button,{type:"button",role:"checkbox","aria-checked":j(d)?"mixed":d,"aria-required":C,"data-state":J(d),"data-disabled":m?"":void 0,disabled:m,value:x,...o,ref:b,onKeyDown:z(n,u=>{u.key==="Enter"&&u.preventDefault()}),onClick:z(i,u=>{s(g=>j(g)?!0:!g),l&&f&&(t.current=u.isPropagationStopped(),t.current||u.stopPropagation())})})});M.displayName=I;var O=p.forwardRef((a,n)=>{const{__scopeCheckbox:i,name:o,checked:c,defaultChecked:r,required:x,disabled:m,value:d,onCheckedChange:C,form:v,...s}=a;return e.jsx(je,{__scopeCheckbox:i,checked:c,defaultChecked:r,disabled:m,required:x,onCheckedChange:C,name:o,form:v,value:d,internal_do_not_use_render:({isFormControl:t})=>e.jsxs(e.Fragment,{children:[e.jsx(M,{...s,ref:n,__scopeCheckbox:i}),t&&e.jsx(V,{__scopeCheckbox:i})]})})});O.displayName=S;var H="CheckboxIndicator",K=p.forwardRef((a,n)=>{const{__scopeCheckbox:i,forceMount:o,...c}=a,r=_(H,i);return e.jsx(Q,{present:o||j(r.checked)||r.checked===!0,children:e.jsx(D.span,{"data-state":J(r.checked),"data-disabled":r.disabled?"":void 0,...c,ref:n,style:{pointerEvents:"none",...a.style}})})});K.displayName=H;var q="CheckboxBubbleInput",V=p.forwardRef(({__scopeCheckbox:a,...n},i)=>{const{control:o,hasConsumerStoppedPropagationRef:c,checked:r,defaultChecked:x,required:m,disabled:d,name:C,value:v,form:s,bubbleInput:t,setBubbleInput:f}=_(q,a),l=$(i,f),b=ie(r),h=Y(o);p.useEffect(()=>{const g=t;if(!g)return;const N=window.HTMLInputElement.prototype,A=Object.getOwnPropertyDescriptor(N,"checked").set,U=!c.current;if(b!==r&&A){const X=new Event("click",{bubbles:U});g.indeterminate=j(r),A.call(g,j(r)?!1:r),g.dispatchEvent(X)}},[t,b,r,c]);const u=p.useRef(j(r)?!1:r);return e.jsx(D.input,{type:"checkbox","aria-hidden":!0,defaultChecked:x??u.current,required:m,disabled:d,name:C,value:v,form:s,...n,tabIndex:-1,ref:l,style:{...n.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});V.displayName=q;function ye(a){return typeof a=="function"}function j(a){return a==="indeterminate"}function J(a){return j(a)?"indeterminate":a?"checked":"unchecked"}function G({className:a,...n}){return e.jsx(O,{"data-slot":"checkbox",className:ee("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",a),...n,children:e.jsx(K,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(me,{className:"size-3.5"})})})}function Te(a,n){return({getValue:i,row:o})=>{const c=!!i(),r=o.original,x=n?.disabled?.(r)??!1,m=n?.ariaLabel?.(r)??"Toggle";return e.jsx("div",{className:"flex items-center",onClick:d=>d.stopPropagation(),children:e.jsx(G,{checked:c,disabled:x,"aria-label":m,onCheckedChange:d=>a({row:r,next:!!d}),className:"translate-y-[1px]"})})}}const Se=[T({accessorKey:k.enabled.name,header:null,size:44,minSize:36,maxSize:64,enableSorting:!1,cell:Te(({row:a,next:n})=>{console.log(a),console.log(n)},{})}),T({accessorKey:k.key.name,header:k.key.label,enableSorting:!1}),T({accessorKey:k.value.name,header:k.value.label,enableSorting:!1}),T({accessorKey:k.description.name,header:k.description.label,enableSorting:!1})],Ne=["key","value","description"],Re=a=>Ne.includes(a);function We({form:a}){const[n,i]=p.useState(null),{fields:o,append:c}=ge({control:a.control,name:"apiTestData"}),r=ae({data:structuredClone(o),columns:Se,enableRowSelection:!0,enableSorting:!1,enableFilters:!1,enableSortingRemoval:!1,getCoreRowModel:se()}),x=he(te),m=p.useRef(null),d=s=>{if(typeof s=="number"){if(m.current===s)return;m.current=s}const t=new L;t.setField("text"),c({isNew:!0,enabled:0,key:"",value:"",description:"",fieldType:t.asJSONString()},{shouldFocus:!1})},C=(s,t)=>{a.setValue(`apiTestData.${s}.enabled`,t),s===o.length-1&&t===1&&d(s)},v=s=>{a.getValues(`apiTestData.${s}.enabled`)!==1&&a.setValue(`apiTestData.${s}.enabled`,1),s===o.length-1&&d(s)};return p.useEffect(()=>{o.length===0&&(c({isNew:!0,enabled:0,key:"",value:"",description:""},{shouldFocus:!1}),m.current=null)},[o.length,c]),e.jsx(xe,{...a,children:e.jsxs(ne,{className:"card",children:[e.jsx(oe,{children:r.getHeaderGroups().map(s=>e.jsx(y,{className:"border-b border-accent dark:border-accent",children:s.headers.map(t=>e.jsxs(le,{className:"m-0 p-0 border-r border-accent dark:border-accent last:border-r-0",style:{width:t.getSize()},children:[t.isPlaceholder?null:re(t.column.columnDef.header,t.getContext()),t.column.getCanResize()&&e.jsx("div",{onMouseDown:t.getResizeHandler(),onTouchStart:t.getResizeHandler(),className:`absolute right-0 top-0 h-full w-1 cursor-col-resize select-none
                                            ${t.column.getIsResizing()?"bg-blue-500":"bg-transparent hover:bg-gray-400"}`})]},t.id))},s.id))}),e.jsx(ce,{children:x?Array.from({length:5}).map((s,t)=>e.jsx(y,{children:r.getAllLeafColumns().map(f=>e.jsx("td",{className:"px-2 py-2",children:e.jsx(be,{className:"h-4 w-full rounded-2xl p-4 m-1 gap-2"})},f.id))},`skeleton-${t}`)):o.length>0?o.map((s,t)=>e.jsx(y,{className:"cursor-pointer p-2 border border-accent dark:border-accent text-foreground dark:text-foreground",children:r.getAllLeafColumns().map(f=>e.jsx(B,{className:"p-2",children:f.id===k.enabled.name?e.jsx(F,{control:a.control,name:`apiTestData.${t}.enabled`,render:({field:l})=>e.jsx(P,{children:e.jsx(w,{children:e.jsx("div",{onClick:b=>b.stopPropagation(),className:"flex items-center",children:e.jsx(G,{checked:l.value===1,onCheckedChange:b=>{const h=b?1:0;l.onChange(h),C(t,h)},"aria-label":"Toggle",className:"cursor-pointer h-6 w-6 shrink-0 translate-y-[1px]"})})})})}):Re(f.id)&&e.jsxs("div",{className:"flex flex-row gap-1",children:[e.jsx(F,{control:a.control,name:`apiTestData.${t}.${f.id}`,render:({field:l})=>e.jsx(P,{children:e.jsx(w,{children:e.jsx(fe,{...l,value:l.value??"",onChange:b=>l.onChange(b.target.value),onFocus:()=>v(t),className:"w-full h-8"})})})}),e.jsx(F,{name:`apiTestData.${t}.${k.fieldType.name}`,control:a.control,render:({field:l})=>{const b=(()=>{try{return(typeof l.value=="string"?JSON.parse(l.value):l.value)?.field??"text"}catch{return"text"}})();return e.jsx(P,{children:e.jsx(w,{children:f.id===k.value.name&&e.jsxs(p.Fragment,{children:[e.jsxs(de,{value:b,onValueChange:h=>{const u=new L;u.setField(h),l.onChange(u.asJSONString()),setTimeout(h==="dropdown"?()=>i(t):()=>i(null),500)},children:[e.jsx(ue,{className:"h-6 w-6 flex items-center justify-center rounded-md border text-xs p-1"}),e.jsxs(pe,{children:[e.jsx(E,{value:"text",children:"Text"}),e.jsx(E,{value:"dropdown",children:"Dropdown"}),e.jsx(E,{value:"file",children:"File"})]})]}),e.jsx(ke,{rowIndex:t,isOpen:n===t,setIsOpen:h=>i(h?t:null)})]})})})}})]})},f.id))},s.id)):e.jsx(y,{children:e.jsx(B,{colSpan:r.getAllLeafColumns().length,className:"h-24 text-center text-muted-foreground",children:"No test data rows found."})})})]})})}export{We as default};
