import{a as p,j as e,E as Z,P as Q,N as D,Z as W,L,M as z,ae as Y,x as ee,h as te}from"./main-CCsm7npd.js";import{u as ae,f as re,b as se}from"./index-BXgblPEN.js";import{T as ne,a as oe,b as y,c as le,d as ce,e as I}from"./table-CWp7DyFA.js";import{c as T}from"./ColumnConfig-CqB8Vezx.js";import{A as k}from"./ApiTestDataFormField-BAXKWOTx.js";import{u as ie,S as de,a as ue,c as pe,d as E}from"./select-DoMwqpvf.js";import{C as me}from"./check-Dfjodz5r.js";import{S as be}from"./skeleton-B7i49Y4b.js";import{u as he}from"./useAppSelector-Ce2_yq9e.js";import{I as fe}from"./input-DuJlDC-O.js";import{F as xe,a as F,b as P,d as w}from"./form-Dc9MwM7R.js";import{d as ge}from"./index.esm-Diu_iA5A.js";import{D as B,T as ke}from"./table-selection-popover-BzrwibZz.js";import"./button-CUgnRfPS.js";import"./createLucideIcon-CJh113ez.js";import"./index-CTl7kwxK.js";import"./index-BlgXRo-Z.js";import"./label-Dq9AYxZG.js";import"./popover-5RnXq6XN.js";import"./index-8n8AKqGF.js";import"./ClientDatabaseTableViewModel-CWID7VbN.js";import"./clientDatabaseSelectors-BCEKIPh0.js";import"./loader-circle-Bd2zK--c.js";var S="Checkbox",[Ce,Qe]=Z(S),[ve,_]=Ce(S);function je(t){const{__scopeCheckbox:n,checked:i,children:o,defaultChecked:l,disabled:r,form:f,name:m,onCheckedChange:c,required:C,value:v="on",internal_do_not_use_render:s}=t,[a,b]=W({prop:i,defaultProp:l??!1,onChange:c,caller:S}),[d,u]=p.useState(null),[g,h]=p.useState(null),x=p.useRef(!1),R=d?!!f||!!d.closest("form"):!0,N={checked:a,disabled:r,setChecked:b,control:d,setControl:u,name:m,form:f,value:v,hasConsumerStoppedPropagationRef:x,required:C,defaultChecked:j(l)?!1:l,isFormControl:R,bubbleInput:g,setBubbleInput:h};return e.jsx(ve,{scope:n,...N,children:ye(s)?s(N):o})}var $="CheckboxTrigger",M=p.forwardRef(({__scopeCheckbox:t,onKeyDown:n,onClick:i,...o},l)=>{const{control:r,value:f,disabled:m,checked:c,required:C,setControl:v,setChecked:s,hasConsumerStoppedPropagationRef:a,isFormControl:b,bubbleInput:d}=_($,t),u=L(l,v),g=p.useRef(c);return p.useEffect(()=>{const h=r?.form;if(h){const x=()=>s(g.current);return h.addEventListener("reset",x),()=>h.removeEventListener("reset",x)}},[r,s]),e.jsx(D.button,{type:"button",role:"checkbox","aria-checked":j(c)?"mixed":c,"aria-required":C,"data-state":G(c),"data-disabled":m?"":void 0,disabled:m,value:f,...o,ref:u,onKeyDown:z(n,h=>{h.key==="Enter"&&h.preventDefault()}),onClick:z(i,h=>{s(x=>j(x)?!0:!x),d&&b&&(a.current=h.isPropagationStopped(),a.current||h.stopPropagation())})})});M.displayName=$;var O=p.forwardRef((t,n)=>{const{__scopeCheckbox:i,name:o,checked:l,defaultChecked:r,required:f,disabled:m,value:c,onCheckedChange:C,form:v,...s}=t;return e.jsx(je,{__scopeCheckbox:i,checked:l,defaultChecked:r,disabled:m,required:f,onCheckedChange:C,name:o,form:v,value:c,internal_do_not_use_render:({isFormControl:a})=>e.jsxs(e.Fragment,{children:[e.jsx(M,{...s,ref:n,__scopeCheckbox:i}),a&&e.jsx(V,{__scopeCheckbox:i})]})})});O.displayName=S;var H="CheckboxIndicator",K=p.forwardRef((t,n)=>{const{__scopeCheckbox:i,forceMount:o,...l}=t,r=_(H,i);return e.jsx(Q,{present:o||j(r.checked)||r.checked===!0,children:e.jsx(D.span,{"data-state":G(r.checked),"data-disabled":r.disabled?"":void 0,...l,ref:n,style:{pointerEvents:"none",...t.style}})})});K.displayName=H;var q="CheckboxBubbleInput",V=p.forwardRef(({__scopeCheckbox:t,...n},i)=>{const{control:o,hasConsumerStoppedPropagationRef:l,checked:r,defaultChecked:f,required:m,disabled:c,name:C,value:v,form:s,bubbleInput:a,setBubbleInput:b}=_(q,t),d=L(i,b),u=ie(r),g=Y(o);p.useEffect(()=>{const x=a;if(!x)return;const R=window.HTMLInputElement.prototype,A=Object.getOwnPropertyDescriptor(R,"checked").set,U=!l.current;if(u!==r&&A){const X=new Event("click",{bubbles:U});x.indeterminate=j(r),A.call(x,j(r)?!1:r),x.dispatchEvent(X)}},[a,u,r,l]);const h=p.useRef(j(r)?!1:r);return e.jsx(D.input,{type:"checkbox","aria-hidden":!0,defaultChecked:f??h.current,required:m,disabled:c,name:C,value:v,form:s,...n,tabIndex:-1,ref:d,style:{...n.style,...g,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});V.displayName=q;function ye(t){return typeof t=="function"}function j(t){return t==="indeterminate"}function G(t){return j(t)?"indeterminate":t?"checked":"unchecked"}function J({className:t,...n}){return e.jsx(O,{"data-slot":"checkbox",className:ee("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...n,children:e.jsx(K,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(me,{className:"size-3.5"})})})}function Te(t,n){return({getValue:i,row:o})=>{const l=!!i(),r=o.original,f=n?.disabled?.(r)??!1,m=n?.ariaLabel?.(r)??"Toggle";return e.jsx("div",{className:"flex items-center",onClick:c=>c.stopPropagation(),children:e.jsx(J,{checked:l,disabled:f,"aria-label":m,onCheckedChange:c=>t({row:r,next:!!c}),className:"translate-y-[1px]"})})}}const Se=[T({accessorKey:k.enabled.name,header:null,size:44,minSize:36,maxSize:64,enableSorting:!1,cell:Te(({row:t,next:n})=>{console.log(t),console.log(n)},{})}),T({accessorKey:k.key.name,header:k.key.label,enableSorting:!1}),T({accessorKey:k.value.name,header:k.value.label,enableSorting:!1}),T({accessorKey:k.description.name,header:k.description.label,enableSorting:!1})],Re=["key","value","description"],Ne=t=>Re.includes(t);function We({form:t}){const[n,i]=p.useState(!1),{fields:o,append:l}=ge({control:t.control,name:"apiTestData"}),r=ae({data:t.getValues("apiTestData")??[],columns:Se,enableRowSelection:!0,enableSorting:!1,enableFilters:!1,enableSortingRemoval:!1,getCoreRowModel:se()}),f=he(te),m=p.useRef(null),c=s=>{if(typeof s=="number"){if(m.current===s)return;m.current=s}const a=new B;a.setField("text"),l({enabled:0,key:"",value:"",description:"",fieldType:a.asJSONString()},{shouldFocus:!1})},C=(s,a)=>{t.setValue(`apiTestData.${s}.enabled`,a),s===o.length-1&&a===1&&c(s)},v=s=>{t.getValues(`apiTestData.${s}.enabled`)!==1&&t.setValue(`apiTestData.${s}.enabled`,1),s===o.length-1&&c(s)};return p.useEffect(()=>{o.length===0&&(l({enabled:0,key:"",value:"",description:""},{shouldFocus:!1}),m.current=null)},[o.length,l]),e.jsx(xe,{...t,children:e.jsxs(ne,{className:"card",children:[e.jsx(oe,{children:r.getHeaderGroups().map(s=>e.jsx(y,{className:"border-b border-accent dark:border-accent",children:s.headers.map(a=>e.jsxs(le,{className:"m-0 p-0 border-r border-accent dark:border-accent last:border-r-0",style:{width:a.getSize()},children:[a.isPlaceholder?null:re(a.column.columnDef.header,a.getContext()),a.column.getCanResize()&&e.jsx("div",{onMouseDown:a.getResizeHandler(),onTouchStart:a.getResizeHandler(),className:`absolute right-0 top-0 h-full w-1 cursor-col-resize select-none
                                            ${a.column.getIsResizing()?"bg-blue-500":"bg-transparent hover:bg-gray-400"}`})]},a.id))},s.id))}),e.jsx(ce,{children:f?Array.from({length:5}).map((s,a)=>e.jsx(y,{children:r.getAllLeafColumns().map(b=>e.jsx("td",{className:"px-2 py-2",children:e.jsx(be,{className:"h-4 w-full rounded-2xl p-4 m-1 gap-2"})},b.id))},`skeleton-${a}`)):o.length>0?o.map((s,a)=>e.jsx(y,{className:"cursor-pointer p-2 border border-accent dark:border-accent text-foreground dark:text-foreground",children:r.getAllLeafColumns().map(b=>e.jsx(I,{className:"p-2",children:b.id===k.enabled.name?e.jsx(F,{control:t.control,name:`apiTestData.${a}.enabled`,render:({field:d})=>e.jsx(P,{children:e.jsx(w,{children:e.jsx("div",{onClick:u=>u.stopPropagation(),className:"flex items-center",children:e.jsx(J,{checked:d.value===1,onCheckedChange:u=>{const g=u?1:0;d.onChange(g),C(a,g)},"aria-label":"Toggle",className:"cursor-pointer h-6 w-6 shrink-0 translate-y-[1px]"})})})})}):Ne(b.id)&&e.jsxs("div",{className:"flex flex-row gap-1",children:[e.jsx(F,{control:t.control,name:`apiTestData.${a}.${b.id}`,render:({field:d})=>e.jsx(P,{children:e.jsx(w,{children:e.jsx(fe,{...d,value:d.value??"",onChange:u=>d.onChange(u.target.value),onFocus:()=>v(a),className:"w-full h-8"})})})}),e.jsx(F,{name:`apiTestData.${a}.${k.fieldType.name}`,control:t.control,render:({field:d})=>e.jsx(P,{children:e.jsx(w,{children:b.id===k.value.name&&e.jsxs(p.Fragment,{children:[e.jsxs(de,{onValueChange:u=>{const g=new B;g.setField(u),d.onChange(g.asJSONString()),u==="dropdown"&&setTimeout(()=>i(!0),500)},children:[e.jsx(ue,{className:"h-6 w-6 flex items-center justify-center rounded-md border text-xs p-1"}),e.jsxs(pe,{children:[e.jsx(E,{value:"text",children:"Text"}),e.jsx(E,{value:"dropdown",children:"Dropdown"}),e.jsx(E,{value:"file",children:"File"})]})]}),e.jsx(ke,{rowIndex:a,isOpen:n,setIsOpen:i})]})})})})]})},b.id))},s.id)):e.jsx(y,{children:e.jsx(I,{colSpan:r.getAllLeafColumns().length,className:"h-24 text-center text-muted-foreground",children:"No test data rows found."})})})]})})}export{We as default};
