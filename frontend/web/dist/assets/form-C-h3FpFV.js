import{a as P,o as U,j as e,H as E,r as y}from"./main-wTblVsq0.js";import{u as S}from"./useAppSelector-BW6dmEz4.js";import{u as I}from"./use-show-toast-BSGP1Bhq.js";import{u as V}from"./index.esm-CZz6cprQ.js";import{P as C}from"./ProjectViewModel-CzJ36bb_.js";import{a as N}from"./zod-UmGTRyvS.js";import{projectSchema as H}from"./projectSchema-tSfr6JAW.js";import{u as T}from"./useProjectService-CwZThxgn.js";import{b as A}from"./breadcrumb-items-By_1laP3.js";import{A as M}from"./app-layout-D0uPDn8S.js";import z from"./project-layout-Bkk6Kbfb.js";import{F as L,a as l,b as p,c as d,d as j}from"./form-CEUoIQsp.js";import{T as _}from"./top-action-bar-dgneaNae.js";import{P as t}from"./ProjectFormField-BJ1w6HMZ.js";import{I as D}from"./input-B7ehP6LW.js";import{T as w}from"./textarea-DccAv0VT.js";import"./schemas-D95ZC4Tg.js";import"./useRequest-BCnKN7Wn.js";import"./useAuthState-BElMWhPe.js";import"./BaseEntity-DGhPHkWu.js";import"./serviceHandler-BlQljMi1.js";import"./button-BKtYD9UH.js";import"./index-L13OofM9.js";import"./index-B8kHX97E.js";import"./x-CiPR1T7H.js";import"./createLucideIcon-C5-kp_dk.js";import"./chevron-right-Cz1vY7eM.js";import"./dropdown-menu-DZ6sB29m.js";import"./index-DM4NgvGr.js";import"./index-BB0IBzWE.js";import"./index-5KueQA_e.js";import"./check-CTufcYB2.js";import"./index-Dm0UqNOR.js";import"./label-CAlckq6-.js";import"./save-button-BVOif3vb.js";import"./index-C_TaKwYQ.js";const O=({projectDTO:u})=>{const[o,i]=P.useState(()=>u?new C(u):void 0),s=V({resolver:N(H),defaultValues:{projectCode:o?.projectCode??"",projectName:o?.projectName??"",description:o?.description??"",secondDescription:o?.secondDescription??"",moreDescription:o?.moreDescription??""}});return{form:s,setFormError:(c,f)=>{const{setToastError:v}=f||{},a=c?.response?.data?.errors??{};typeof a=="string"?v?.(a):a&&Object.keys(a).length>0&&Object.keys(a).forEach(x=>{const h=x.replace(/^project\./,"");h in s.getValues()&&s.setError(h,{type:"server",message:a[x][0]??"Invalid value"})})},projectViewModel:o,setProjectViewModel:i}};function De(){const{project:u}=U().props,o=S(r=>r.loading.global),i=I(),{form:s,setFormError:g,projectViewModel:c,setProjectViewModel:f}=O({projectDTO:u}),{createProject:v,updateProject:b,removeProject:a}=T(),x=[...A??[],{title:c?.projectCode??"Create",href:"/"}],h=async()=>{const n={...s.getValues(),...c?.UUID?{UUID:c?.UUID}:{}};try{if(c?.UUID){const m=await b(n);f(m),i("Success","Update project successfully","success")}else{const m=await v(n);i("Success","Create project successfully","success"),y.visit(`/project_management/project/view?id=${m.UUID}`)}}catch(m){g(m),i("Error","Server error","error")}},F=async()=>{if(c?.UUID){const r=[c.UUID];await a(r,{onSuccess:n=>{n?.success&&n?.success.length>0?(i("Success","Successfully remove the project. Redirecting to main page","success"),y.visit("/project_management/project/index")):i("Error","Failed to remove the user","error")},onError:async()=>{i("Error","Something wrong with the server","error")}})}};return e.jsxs(M,{breadcrumbs:x,children:[e.jsx(E,{title:c?.projectCode??"Create"}),e.jsx(z,{children:e.jsx(L,{...s,children:e.jsxs("form",{className:"grid grid-cols-4 gap-6 space-y-2 w-full items-start",onSubmit:s.handleSubmit(h),children:[e.jsx("div",{className:"col-span-4",children:e.jsx(_,{isLoading:o,saveAction:!0,browseAction:{to:"/project_management/project/index"},deleteAction:{action:F}})}),e.jsx(l,{control:s.control,name:t.projectCode.name,render:({field:r})=>e.jsxs(p,{children:[e.jsx(d,{children:t.projectCode.label}),e.jsx(j,{children:e.jsx(D,{...r,disabled:o})})]})}),e.jsx(l,{control:s.control,name:t.projectName.name,render:({field:r})=>e.jsxs(p,{children:[e.jsx(d,{children:t.projectName.label}),e.jsx(j,{children:e.jsx(D,{...r,required:!0,disabled:o})})]})}),e.jsx("div",{className:"col-span-2"}),e.jsx(l,{control:s.control,name:t.description.name,render:({field:r})=>e.jsxs(p,{className:"col-span-2",children:[e.jsx(d,{children:t.description.label}),e.jsx(j,{children:e.jsx(w,{...r,value:r.value??"",disabled:o,rows:4,style:{resize:"vertical",overflowY:"auto",maxHeight:"8rem",minHeight:"8rem"}})})]})}),e.jsx(l,{control:s.control,name:t.secondDescription.name,render:({field:r})=>e.jsxs(p,{className:"col-span-2",children:[e.jsx(d,{children:t.secondDescription.label}),e.jsx(j,{children:e.jsx(w,{...r,value:r.value??"",disabled:o,rows:4,style:{resize:"vertical",overflowY:"auto",maxHeight:"8rem",minHeight:"8rem"}})})]})}),e.jsx(l,{control:s.control,name:t.moreDescription.name,render:({field:r})=>e.jsxs(p,{className:"col-span-4",children:[e.jsx(d,{children:t.moreDescription.label}),e.jsx(j,{children:e.jsx(w,{...r,value:r.value??"",disabled:o,rows:4,style:{resize:"vertical",overflowY:"auto",maxHeight:"8rem",minHeight:"8rem"}})})]})})]})})})]})}export{De as default};
