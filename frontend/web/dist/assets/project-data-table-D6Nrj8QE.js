import{a as P,u as T,l as x,j as p,r as M,m as C,b as O,c as z,d as V}from"./main-pQhv4PK_.js";import{u as E,T as q,g as K,a as Q,b as $}from"./top-action-bar-C2cEVkAl.js";import{u as N}from"./useAppSelector-CaMT8LJQ.js";import{u as J}from"./use-show-toast-B6G1GJ0-.js";import{D as L}from"./data-table-C8520PGI.js";import{u as k}from"./useMutation-DzfY5YKk.js";import{u as G}from"./useRequest-Mn9d9NpM.js";import{b as H}from"./utils-BLojDQQ3.js";import{B as W}from"./BaseEntity-DGhPHkWu.js";import{h as _}from"./serviceHandler-BlQljMi1.js";const X=["UUID","projectName","projectCode","description","secondDescription","moreDescription","valid"];function v(c,e){return H(c,X,e,"project")}class h{_UUID;_projectName;_projectCode;_description;_secondDescription;_moreDescription;_valid;_createdAtFormat;_createdByName;_updatedAtFormat;_updatedByName;constructor(e){this._UUID=e.UUID??"",this._projectName=e.projectName??"",this._projectCode=e.projectCode??"",this._description=e.description??"",this._secondDescription=e.secondDescription??"",this._moreDescription=e.moreDescription??"",this._valid=e.valid??!0,this._createdAtFormat=e.createdAtFormat??"",this._createdByName=e.createdByName??"",this._updatedAtFormat=e.updatedAtFormat??"",this._updatedByName=e.updatedByName??""}get UUID(){return this._UUID}get projectName(){return this._projectName}get projectCode(){return this._projectCode}get description(){return this._description}get secondDescription(){return this._secondDescription}get moreDescription(){return this._moreDescription}get valid(){return this._valid}get createdAtFormat(){return this._createdAtFormat}get createdByName(){return this._createdByName}get updatedAtFormat(){return this._updatedAtFormat}get updatedByName(){return this._updatedByName}}class D extends W{_UUID;_projectName;_projectCode;_description;_secondDescription;_moreDescription;_valid;_createdAtFormat;_createdByName;_updatedAtFormat;_updatedByName;constructor(e){super(e),this._UUID=e.UUID??"",this._projectName=e.projectName??"",this._projectCode=e.projectCode??"",this._description=e.description??"",this._secondDescription=e.secondDescription??"",this._moreDescription=e.moreDescription??"",this._valid=e.valid??!0,this._createdAtFormat=e.createdAtFormat??"",this._createdByName=e.createdByName??"",this._updatedAtFormat=e.updatedAtFormat??"",this._updatedByName=e.updatedByName??""}asViewModel(){return new h(this.asDto())}get UUID(){return this._UUID}set UUID(e){this._UUID=e}get projectName(){return this._projectName}set projectName(e){this._projectName=e}get projectCode(){return this._projectCode}set projectCode(e){this._projectCode=e}get description(){return this._description}set description(e){this._description=e}get secondDescription(){return this._secondDescription}set secondDescription(e){this._secondDescription=e}get moreDescription(){return this._moreDescription}set moreDescription(e){this._moreDescription=e}get valid(){return this._valid}set valid(e){this._valid=e}get createdAtFormat(){return this._createdAtFormat}set createdAtFormat(e){this._createdAtFormat=e}get createdByName(){return this._createdByName}set createdByName(e){this._createdByName=e}get updatedAtFormat(){return this._updatedAtFormat}set updatedAtFormat(e){this._updatedAtFormat=e}get updatedByName(){return this._updatedByName}set updatedByName(e){this._updatedByName=e}}const Y=()=>{const{request:c}=G();return{indexProject:async n=>{const o=new FormData;return o.append("param[offset]",n.offset),o.append("param[limit]",n.limit),o.append("param[sort]",n.sort),o.append("param[order]",n.order),n.filter!=="{}"&&o.append("param[filter] ",n.filter),await c({url:"/project/index",method:"POST",data:o})},createProject:async n=>{const o=n.asDto(),d=v(o,new FormData),r=(await c({url:"/project/create",method:"POST",data:d})).project;return new D(r)},updateProject:async n=>{const o=n.asDto(),d=v(o,new FormData),r=(await c({url:`/project/update?id=${o.UUID}`,method:"POST",data:d})).project;return new D(r)},removeProject:async n=>{const o=new FormData;return n.forEach(d=>{o.append("UUIDs[]",d)}),await c({url:"/user/remove",method:"POST",data:o})}}},Z=()=>{const{indexProject:c,createProject:e,updateProject:m,removeProject:u}=Y();return{indexProject:async(a,r)=>_(async()=>{const i=await c(a),l=i.rows.map(j=>new h(j));return{...i,rows:l}},r),createProject:async(a,r)=>{let i=new D(a);return i=await _(async()=>e(i),r),i.asViewModel()},updateProject:async(a,r)=>{let i=new D(a);return i=await _(async()=>m(i),r),i.asViewModel()},removeProject:async(a,r)=>await _(async()=>u(a),r)}};function ee({columns:c,data:e,onRefresh:m}){const[u,g]=P.useState({}),[n,o]=P.useState([]),[d,a]=P.useState({startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}),r=T(),i=N(t=>t.loading.global),{rowSelection:l,sorting:j,columnVisibility:F}=N(t=>t.userDataTable),S=J(),A=x(),{params:y}=N(t=>t.userDataTable),{removeProject:B}=Z(),R=k({mutationFn:t=>{const s=t.map(w=>w.UUID);return B(s)},onSuccess:()=>{S("Success","Successfully remove the project","success"),A.invalidateQueries({queryKey:["/organization/project/index",y]})},onError:()=>{S("Error","Failed to delete project","error")}}),f=E({data:e,columns:c,columnResizeMode:"onChange",enableRowSelection:!0,enableMultiRowSelection:!0,enableColumnFilters:!0,onColumnSizingChange:g,onColumnSizingInfoChange:a,onRowSelectionChange:t=>{const s=typeof t=="function"?t(l):t;r(V(s))},onSortingChange:t=>{const s=typeof t=="function"?t(j):t;r(z(s)),s.length>0&&r(C({...y,sort:s[0].id,order:s[0].desc?"desc":"asc"}))},onColumnVisibilityChange:t=>{const s=typeof t=="function"?t(F):t;r(O(s))},onColumnFiltersChange:t=>{const s=typeof t=="function"?t(n):t;o(s);const w=Object.fromEntries(s.map(U=>[U.id,U.value]));r(C({...y,filter:JSON.stringify(w)}))},getCoreRowModel:$(),getFilteredRowModel:Q(),getSortedRowModel:K(),state:{rowSelection:l,sorting:j,columnVisibility:F,columnSizing:u,columnSizingInfo:d,columnFilters:n}}),b=t=>{const s=new h(t.original);M.visit(`/project_management/project/view?id=${s.UUID}`)},I=()=>{const t=f.getSelectedRowModel().rows.map(s=>new h(s.original));R.mutate(t)};return p.jsx("main",{className:"w-full",children:p.jsxs("div",{className:"overflow-hidden rounded-md border",children:[p.jsx("div",{className:"w-full",children:p.jsx(q,{isLoading:i,createAction:{to:"/project_management/project/create"},deleteAction:{action:I},refreshAction:{action:m},table:f})}),p.jsx(L,{table:f,isLoading:i,onSelectRow:b})]})})}const me=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"}));export{ee as P,me as p,Z as u};
