import{a as s,C as Z,j as n,A as J,J as Y,I as g,p as y,i as Q,u as ee,ae as j,af as te,t as ne,ag as oe,ah as b,h as R,ai as T,aj as re,g as ae}from"./main-CRC8HOaX.js";import{B as w}from"./button-C9pwQ5oo.js";import{u as M}from"./useAppSelector-B-pSj3Rs.js";import{c as E,R as se,A as ie,P as ce,C as ue,I as de,G as le,L as pe,a as me,d as xe,e as fe,b as ve,S as he,f as Ce,g as ge,h as Me}from"./index-CGbTm9xW.js";import{s as _e,b as Ne,c as Re}from"./apiTestSelectors-BJyltacD.js";import{I as Te}from"./input-DXTFf1pc.js";import{u as Ie}from"./useApiTestService-O-Hq6Cv0.js";import{u as Ae}from"./use-show-toast-jAYKPPUv.js";import{a as je,b as be,d as we}from"./form-Lcs4l44x.js";import{A as Se}from"./ApiTestFormField-BnCEFvC1.js";import{a as Pe}from"./index.esm-CJA05T6O.js";import{C as Ue}from"./chevron-right-wB5Z_nTM.js";import{c as D}from"./createLucideIcon--gvSkVr1.js";import"./index-BgEqZj5F.js";import"./index-B0z4cAq8.js";import"./index-Bov17UEv.js";import"./useRequest-CZQ9oKgI.js";import"./useAuthState-B1pDtEYw.js";import"./BaseEntity-DGhPHkWu.js";import"./ApiTestViewModel-BZncyWgE.js";import"./serviceHandler-BlQljMi1.js";import"./ClientDatabaseViewModel-CZz8IN5P.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Ee=D("file-text",ye);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Oe=D("folder",De);var I="ContextMenu",[ke,Ot]=J(I,[E]),u=E(),[Fe,O]=ke(I),k=e=>{const{__scopeContextMenu:o,children:r,onOpenChange:t,dir:a,modal:i=!0}=e,[m,l]=s.useState(!1),v=u(o),f=Z(t),d=s.useCallback(h=>{l(h),f(h)},[f]);return n.jsx(Fe,{scope:o,open:m,onOpenChange:d,modal:i,children:n.jsx(se,{...v,dir:a,open:m,onOpenChange:d,modal:i,children:r})})};k.displayName=I;var F="ContextMenuTrigger",G=s.forwardRef((e,o)=>{const{__scopeContextMenu:r,disabled:t=!1,...a}=e,i=O(F,r),m=u(r),l=s.useRef({x:0,y:0}),v=s.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...l.current})}),f=s.useRef(0),d=s.useCallback(()=>window.clearTimeout(f.current),[]),h=x=>{l.current={x:x.clientX,y:x.clientY},i.onOpenChange(!0)};return s.useEffect(()=>d,[d]),s.useEffect(()=>void(t&&d()),[t,d]),n.jsxs(n.Fragment,{children:[n.jsx(ie,{...m,virtualRef:v}),n.jsx(Y.span,{"data-state":i.open?"open":"closed","data-disabled":t?"":void 0,...a,ref:o,style:{WebkitTouchCallout:"none",...e.style},onContextMenu:t?e.onContextMenu:g(e.onContextMenu,x=>{d(),h(x),x.preventDefault()}),onPointerDown:t?e.onPointerDown:g(e.onPointerDown,_(x=>{d(),f.current=window.setTimeout(()=>h(x),700)})),onPointerMove:t?e.onPointerMove:g(e.onPointerMove,_(d)),onPointerCancel:t?e.onPointerCancel:g(e.onPointerCancel,_(d)),onPointerUp:t?e.onPointerUp:g(e.onPointerUp,_(d))})]})});G.displayName=F;var Ge="ContextMenuPortal",L=e=>{const{__scopeContextMenu:o,...r}=e,t=u(o);return n.jsx(ce,{...t,...r})};L.displayName=Ge;var $="ContextMenuContent",z=s.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=O($,r),i=u(r),m=s.useRef(!1);return n.jsx(ue,{...i,...t,ref:o,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:l=>{e.onCloseAutoFocus?.(l),!l.defaultPrevented&&m.current&&l.preventDefault(),m.current=!1},onInteractOutside:l=>{e.onInteractOutside?.(l),!l.defaultPrevented&&!a.modal&&(m.current=!0)},style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});z.displayName=$;var Le="ContextMenuGroup",$e=s.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=u(r);return n.jsx(le,{...a,...t,ref:o})});$e.displayName=Le;var ze="ContextMenuLabel",Be=s.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=u(r);return n.jsx(pe,{...a,...t,ref:o})});Be.displayName=ze;var He="ContextMenuItem",B=s.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=u(r);return n.jsx(de,{...a,...t,ref:o})});B.displayName=He;var qe="ContextMenuCheckboxItem",Xe=s.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=u(r);return n.jsx(me,{...a,...t,ref:o})});Xe.displayName=qe;var Ke="ContextMenuRadioGroup",Ve=s.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=u(r);return n.jsx(xe,{...a,...t,ref:o})});Ve.displayName=Ke;var We="ContextMenuRadioItem",Ze=s.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=u(r);return n.jsx(fe,{...a,...t,ref:o})});Ze.displayName=We;var Je="ContextMenuItemIndicator",Ye=s.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=u(r);return n.jsx(ve,{...a,...t,ref:o})});Ye.displayName=Je;var Qe="ContextMenuSeparator",et=s.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=u(r);return n.jsx(he,{...a,...t,ref:o})});et.displayName=Qe;var tt="ContextMenuArrow",nt=s.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=u(r);return n.jsx(Ce,{...a,...t,ref:o})});nt.displayName=tt;var ot="ContextMenuSubTrigger",rt=s.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=u(r);return n.jsx(ge,{...a,...t,ref:o})});rt.displayName=ot;var at="ContextMenuSubContent",st=s.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=u(r);return n.jsx(Me,{...a,...t,ref:o,style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});st.displayName=at;function _(e){return o=>o.pointerType!=="mouse"?e(o):void 0}var it=k,ct=G,ut=L,dt=z,lt=B;function S({...e}){return n.jsx(it,{"data-slot":"context-menu",...e})}function P({...e}){return n.jsx(ct,{"data-slot":"context-menu-trigger",...e})}function U({className:e,...o}){return n.jsx(ut,{children:n.jsx(dt,{"data-slot":"context-menu-content",className:y("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...o})})}function N({className:e,inset:o,variant:r="default",...t}){return n.jsx(lt,{"data-slot":"context-menu-item","data-inset":o,"data-variant":r,className:y("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}const pt=e=>e.clientDatabase.clientDatabase;function mt({node:e,level:o=0}){const{id:r}=Q().props,t=ee(),a=o*8,i=M(_e),m=M(Ne),l=M(Re),v=M(pt),f=Ae(),d=Pe(),h=m.includes(e.UUID),x=i?.UUID===e.UUID,{createApiTest:H,removeApiTest:q}=Ie(),A=c=>{t(ne(c.apiDTO))},X=c=>{t(oe(c))},K=async()=>{try{if(i&&v&&v.refreshToken){const c={...i,project:r,transmission:"formData",clientDatabase:v.UUID,seq:1},p=[i?.UUID].filter(C=>C!==void 0);await H(c,v.refreshToken,{onSuccess:C=>{t(T(p)),t(re(C)),t(R({action:null})),t(j({UUID:"",newName:""})),t(ae(C))},onError:C=>{console.error(C),f("Error","Failed to create test case","error"),t(b()),t(R({action:null})),t(T(p))}})}}catch(c){console.error(c),f("Error","Unexpected error","error")}},V=async()=>{const c=[i?.UUID].filter(p=>p!==void 0);await q(c,{onSuccess:p=>{p.success.length>0&&(t(b()),t(T(c)))},onError:()=>{f("Error","Server error","error")}})},W=()=>{t(R({action:"rename",dto:{...i}}))};return e.isFolder?n.jsxs("div",{children:[n.jsxs(S,{children:[n.jsx(P,{children:n.jsxs(w,{variant:"ghost",onClick:()=>{X(e.UUID),A(e)},className:`w-full flex items-center justify-start gap-1 ${x?"bg-accent":""}`,style:{paddingLeft:`${a}px`},children:[n.jsx(Ue,{className:`h-4 w-4 transform transition-transform duration-300 ${h?"rotate-90":""}`}),n.jsx(Oe,{size:16}),n.jsx("span",{className:"text-sm",children:e.testName})]})}),n.jsxs(U,{children:[n.jsx(N,{children:"Rename"}),n.jsx(N,{children:"Remove"})]})]}),h&&e.apiTests?.map(c=>n.jsx(mt,{node:c,level:o+1},c.UUID))]}):n.jsx("div",{className:"flex items-center gap-1 w-full",style:{paddingLeft:`${a+8}px`},children:n.jsxs(S,{children:[n.jsx(P,{className:"w-full",children:l==="rename"&&i?.UUID===e.UUID?n.jsx(je,{name:Se.testName.name,control:d.control,render:({field:c})=>n.jsx(be,{children:n.jsx(we,{children:n.jsx(Te,{...c,value:i?.testName,autoFocus:!0,onChange:p=>{c.onChange(p.target.value),t(te(p.target.value))},onKeyDown:p=>{p.key==="Enter"&&e?.UUID&&(t(j({UUID:e.UUID,newName:i.testName??""})),K())}})})})}):n.jsxs(w,{variant:"ghost",onClick:()=>A(e),className:`w-full flex items-center justify-start gap-1 ${x?"bg-accent":""}`,children:[n.jsx(Ee,{size:16}),e.testName]})}),n.jsxs(U,{children:[n.jsx(N,{className:"cursor-pointer",onClick:W,children:"Rename"}),n.jsx(N,{className:"cursor-pointer",onClick:V,children:"Remove"})]})]})})}export{mt as default};
