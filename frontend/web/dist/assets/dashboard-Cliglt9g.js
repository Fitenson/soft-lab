import{u as g,a as y,l as U,j as t,H as v,b as f,t as m,d as c,e as T,f as x}from"./main-Bs3Kwuia.js";import{A as w}from"./app-layout-C1k5JGIp.js";import S from"./api-test-layout-DkepKbbD.js";import E from"./test-case-sidebar-Bj6T_OPt.js";import F from"./test-case-form-fJPpBPvq.js";import O from"./test-case-output-Cu8Gqhj4.js";import{u as N}from"./useQuery-10s0ikwC.js";import{u as k}from"./useApiTestService-D0kGpnRj.js";import{F as I}from"./index.esm-Dalp2djR.js";import{u as C}from"./documentation-tab-BykyVtLY.js";import{u as D}from"./useAppSelector-D7YagSo4.js";import{s as q}from"./apiTestSelectors-BJyltacD.js";import{F as H}from"./form-CCxmgHSL.js";import{s as L}from"./tree-view-CdcP5_H0.js";import{u as P}from"./use-show-toast-CpO-ylZ-.js";import"./button-D8qt724e.js";import"./index-BKTkZj8o.js";import"./index-DUsqWs4o.js";import"./x-XXLv6-kj.js";import"./createLucideIcon-Bq6apdP2.js";import"./chevron-right-BUFKLELU.js";import"./dropdown-menu-BkZZtctl.js";import"./index-CY4ZmfOl.js";import"./index-BdsHFWRE.js";import"./index-BvlhTmYh.js";import"./check-Xb86rI9x.js";import"./useAuthState-Btwrr8Uf.js";import"./index-CTzIS4E-.js";import"./ApiTestViewModel-CRkjMY33.js";import"./skeleton-C4V80aYP.js";import"./input-CHigoYIF.js";import"./tabs-D4g0X6Xp.js";import"./ApiTestFormField-5CuhAqB1.js";import"./data-tab-zCnZyXrw.js";import"./select-DIYUVi-2.js";import"./api-test-data-table-CMPbHTp3.js";import"./index-D0txFJA3.js";import"./table-aQkIK-Rz.js";import"./ColumnConfig-BcpwpaHs.js";import"./ApiTestDataFormField-E4p4MSZm.js";import"./popover-DYVXPwP1.js";import"./scenario-tab-hjC-bIdn.js";import"./useRequest-BmthMcGV.js";import"./BaseEntity-DGhPHkWu.js";import"./serviceHandler-BlQljMi1.js";import"./ClientDatabaseViewModel-CZz8IN5P.js";import"./zod-BrSEatqy.js";import"./schemas-D95ZC4Tg.js";import"./textarea-Bx5L9VqN.js";function Ce(){const r=g(),{indexApiTest:b,createApiTest:h,updateApiTest:j}=k(),s=D(q),o=D(L),{form:a}=C({apiTestDTO:s}),l=P(),{data:n}=N({queryKey:["/backend/api_test/index"],queryFn:async()=>await b(),enabled:!0});y.useEffect(()=>{n&&r(U(n))},[r,n]);const A=async()=>{try{if(s&&o&&o.password){const d=a.getValues("apiTestData").map(e=>({apiTest:s.UUID,enabled:e.enabled??0,key:e.key??"",value:e.value??"",description:e.description??"",fieldType:e.fieldType??""})),u={...a.getValues(),UUID:s.UUID,project:o.project,clientDatabase:o.UUID,apiTestData:d??[]},p=[s?.UUID].filter(e=>e!==void 0);s.isNew?await h({apiTestDTO:u,clientDatabaseToken:o.password},{onSuccess:e=>{r(c(p)),r(T(e)),r(m({action:null})),r(x(e.apiTestDTO))},onError:e=>{console.error(e),l("Error","Failed to create test case","error"),r(f()),r(m({action:null})),r(c(p))}}):await j({apiTestDTO:u,clientDatabaseToken:o.password},{onSuccess:e=>{r(c(p)),r(T(e)),r(m({action:null})),r(x(e.apiTestDTO))},onError:e=>{console.error(e),l("Error","Failed to create test case","error"),r(f()),r(m({action:null})),r(c(p))}})}else throw new Error("Missing Client Database Token")}catch(i){console.error(i);const d=i instanceof Error?i.message:typeof i=="string"?i:"Unexpected error occurred";l("Error",d,"error")}};return t.jsxs(w,{children:[t.jsx(v,{title:"API Test"}),t.jsx(S,{children:t.jsxs(I,{...a,children:[t.jsx("div",{className:"w-60 border-none flex-shrink-0 mx-2",children:t.jsx(E,{})}),t.jsx("div",{className:"flex-1 flex flex-coloverflow-auto w-full",children:t.jsx("div",{className:"flex flex-1 space-x-2",children:t.jsx(H,{...a,children:t.jsxs("form",{onSubmit:a.handleSubmit(A),className:"grid grid-cols-1 md:grid-cols-5 gap-2 w-full",children:[t.jsx("div",{className:"border rounded-lg p-4 md:col-span-3",children:t.jsx(F,{})}),t.jsx("div",{className:"border rounded-lg p-4 md:col-span-2",children:t.jsx(O,{})})]})})})})]})})]})}export{Ce as default};
