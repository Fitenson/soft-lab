import{a as s,G as Y,j as n,E as J,N as Q,M as g,x as D,o as ee,u as te,n as ne,af as oe,b as I,t as T,d as b,e as re,f as ae}from"./main-Cw-LF5Po.js";import{B as S}from"./button-BNQ0grnT.js";import{u as _}from"./useAppSelector-BnSkguJi.js";import{c as U,R as se,A as ie,P as ce,C as ue,I as de,G as le,L as pe,a as me,d as xe,e as fe,b as ve,S as he,f as Ce,g as ge,h as Me}from"./index-DhJZCeP9.js";import{s as Te,b as _e,c as Ne}from"./apiTestSelectors-BJyltacD.js";import{I as be}from"./input-Drdpzz7f.js";import{u as we}from"./useApiTestService-BhSJvpik.js";import{u as Re}from"./use-show-toast-vwMQS-j3.js";import{s as je}from"./clientDatabaseSelectors-BCEKIPh0.js";import{a as Ae,b as Ie,d as Se}from"./form-Ce1dZ6Kq.js";import{A as Ee}from"./ApiTestFormField-CTsPcNlS.js";import{a as ye}from"./index.esm-BYKQw42G.js";import{C as Pe}from"./chevron-right-CNZzCVuQ.js";import{c as O}from"./createLucideIcon-aoolMLwC.js";import"./index-DkHgwUuD.js";import"./index-CZY01lQM.js";import"./index-CJlVv5uj.js";import"./useRequest-BDW1RNlz.js";import"./useAuthState-B7H54Bvq.js";import"./BaseEntity-DGhPHkWu.js";import"./ApiTestViewModel-Co14dwD1.js";import"./serviceHandler-BlQljMi1.js";import"./ClientDatabaseViewModel-CZz8IN5P.js";import"./label-skWYfovv.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Ue=O("file-text",De);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],ke=O("folder",Oe);var w="ContextMenu",[Fe,Ft]=J(w,[U]),d=U(),[Ge,k]=Fe(w),F=e=>{const{__scopeContextMenu:o,children:r,onOpenChange:t,dir:a,modal:u=!0}=e,[m,l]=s.useState(!1),h=d(o),v=Y(t),c=s.useCallback(C=>{l(C),v(C)},[v]);return n.jsx(Ge,{scope:o,open:m,onOpenChange:c,modal:u,children:n.jsx(se,{...h,dir:a,open:m,onOpenChange:c,modal:u,children:r})})};F.displayName=w;var G="ContextMenuTrigger",L=s.forwardRef((e,o)=>{const{__scopeContextMenu:r,disabled:t=!1,...a}=e,u=k(G,r),m=d(r),l=s.useRef({x:0,y:0}),h=s.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...l.current})}),v=s.useRef(0),c=s.useCallback(()=>window.clearTimeout(v.current),[]),C=x=>{l.current={x:x.clientX,y:x.clientY},u.onOpenChange(!0)};return s.useEffect(()=>c,[c]),s.useEffect(()=>void(t&&c()),[t,c]),n.jsxs(n.Fragment,{children:[n.jsx(ie,{...m,virtualRef:h}),n.jsx(Q.span,{"data-state":u.open?"open":"closed","data-disabled":t?"":void 0,...a,ref:o,style:{WebkitTouchCallout:"none",...e.style},onContextMenu:t?e.onContextMenu:g(e.onContextMenu,x=>{c(),C(x),x.preventDefault()}),onPointerDown:t?e.onPointerDown:g(e.onPointerDown,N(x=>{c(),v.current=window.setTimeout(()=>C(x),700)})),onPointerMove:t?e.onPointerMove:g(e.onPointerMove,N(c)),onPointerCancel:t?e.onPointerCancel:g(e.onPointerCancel,N(c)),onPointerUp:t?e.onPointerUp:g(e.onPointerUp,N(c))})]})});L.displayName=G;var Le="ContextMenuPortal",$=e=>{const{__scopeContextMenu:o,...r}=e,t=d(o);return n.jsx(ce,{...t,...r})};$.displayName=Le;var z="ContextMenuContent",H=s.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=k(z,r),u=d(r),m=s.useRef(!1);return n.jsx(ue,{...u,...t,ref:o,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:l=>{e.onCloseAutoFocus?.(l),!l.defaultPrevented&&m.current&&l.preventDefault(),m.current=!1},onInteractOutside:l=>{e.onInteractOutside?.(l),!l.defaultPrevented&&!a.modal&&(m.current=!0)},style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});H.displayName=z;var $e="ContextMenuGroup",ze=s.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=d(r);return n.jsx(le,{...a,...t,ref:o})});ze.displayName=$e;var He="ContextMenuLabel",Be=s.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=d(r);return n.jsx(pe,{...a,...t,ref:o})});Be.displayName=He;var Ve="ContextMenuItem",B=s.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=d(r);return n.jsx(de,{...a,...t,ref:o})});B.displayName=Ve;var Xe="ContextMenuCheckboxItem",qe=s.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=d(r);return n.jsx(me,{...a,...t,ref:o})});qe.displayName=Xe;var Ke="ContextMenuRadioGroup",We=s.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=d(r);return n.jsx(xe,{...a,...t,ref:o})});We.displayName=Ke;var Ze="ContextMenuRadioItem",Ye=s.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=d(r);return n.jsx(fe,{...a,...t,ref:o})});Ye.displayName=Ze;var Je="ContextMenuItemIndicator",Qe=s.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=d(r);return n.jsx(ve,{...a,...t,ref:o})});Qe.displayName=Je;var et="ContextMenuSeparator",tt=s.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=d(r);return n.jsx(he,{...a,...t,ref:o})});tt.displayName=et;var nt="ContextMenuArrow",ot=s.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=d(r);return n.jsx(Ce,{...a,...t,ref:o})});ot.displayName=nt;var rt="ContextMenuSubTrigger",at=s.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=d(r);return n.jsx(ge,{...a,...t,ref:o})});at.displayName=rt;var st="ContextMenuSubContent",it=s.forwardRef((e,o)=>{const{__scopeContextMenu:r,...t}=e,a=d(r);return n.jsx(Me,{...a,...t,ref:o,style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});it.displayName=st;function N(e){return o=>o.pointerType!=="mouse"?e(o):void 0}var ct=F,ut=L,dt=$,lt=H,pt=B;function E({...e}){return n.jsx(ct,{"data-slot":"context-menu",...e})}function y({...e}){return n.jsx(ut,{"data-slot":"context-menu-trigger",...e})}function P({className:e,...o}){return n.jsx(dt,{children:n.jsx(lt,{"data-slot":"context-menu-content",className:D("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...o})})}function M({className:e,inset:o,variant:r="default",...t}){return n.jsx(pt,{"data-slot":"context-menu-item","data-inset":o,"data-variant":r,className:D("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}function mt({node:e,level:o=0}){const{id:r}=ee().props,t=te(),a=o*8,u=_(Te),m=_(_e),l=_(Ne),h=_(je),v=Re(),c=ye(),C=m.includes(e.UUID),x=u?.UUID===e.UUID,{createApiTest:V,removeApiTest:X}=we(),R=i=>{t(ne(i.apiTestDTO))},q=i=>{t(oe(i))},K=async()=>{try{if(u&&h&&h.password){const f=c.getValues("apiTestData").map(p=>({enabled:p.enabled??0,key:p.key??"",value:p.value??"",description:p.description??""})),Z={...c.getValues(),project:r,clientDatabase:h.UUID,apiTestHasDatas:f??[]},A=[u?.UUID].filter(p=>p!==void 0);await V({apiTestDTO:Z,clientDatabaseToken:h.password},{onSuccess:p=>{t(b(A)),t(re(p)),t(T({action:null})),t(ae(p.apiTestDTO))},onError:p=>{console.error(p),v("Error","Failed to create test case","error"),t(I()),t(T({action:null})),t(b(A))}})}else throw new Error("Missing Client Database Token")}catch(i){console.error(i);const f=i instanceof Error?i.message:typeof i=="string"?i:"Unexpected error occurred";v("Error",f,"error")}},W=async()=>{const i=[u?.UUID].filter(f=>f!==void 0);await X(i,{onSuccess:f=>{f.success.length>0&&(t(I()),t(b(i)))},onError:()=>{v("Error","Server error","error")}})},j=i=>{switch(i){case"rename":t(T({action:"rename",dto:{...u}}));break;case"cancel":c.reset({...c.getValues(),testName:u?.testName??""}),t(T({action:"cancel",dto:{...u}}));break;default:throw new Error("No such action.")}};return e.isFolder?n.jsxs("div",{children:[n.jsxs(E,{children:[n.jsx(y,{children:n.jsxs(S,{variant:"ghost",onClick:()=>{q(e.UUID),R(e)},className:`w-full flex items-center justify-start gap-1 ${x?"bg-accent":""}`,style:{paddingLeft:`${a}px`},children:[n.jsx(Pe,{className:`h-4 w-4 transform transition-transform duration-300 ${C?"rotate-90":""}`}),n.jsx(ke,{size:16}),n.jsx("span",{className:"text-sm",children:e.testName})]})}),n.jsxs(P,{children:[n.jsx(M,{children:"Rename"}),n.jsx(M,{children:"Remove"})]})]}),C&&e.apiTests?.map(i=>n.jsx(mt,{node:i,level:o+1},i.UUID))]}):n.jsx("div",{className:"flex items-center gap-1 w-full",style:{paddingLeft:`${a+8}px`},children:n.jsxs(E,{children:[n.jsx(y,{className:"w-full",children:l==="rename"&&u?.UUID===e.UUID?n.jsx(Ae,{name:Ee.testName.name,control:c.control,render:({field:i})=>n.jsx(Ie,{children:n.jsx(Se,{children:n.jsx(be,{...i,value:i.value??"",autoFocus:!0,onKeyDown:f=>{f.key==="Enter"&&e?.UUID&&(f.preventDefault(),K())}})})})}):n.jsxs(S,{variant:"ghost",onClick:()=>R(e),className:`w-full flex items-center justify-start gap-1 ${x?"bg-accent":""}`,children:[n.jsx(Ue,{size:16}),e.testName]})}),n.jsxs(P,{children:[n.jsx(M,{className:"cursor-pointer",onClick:()=>j("rename"),children:"Rename"}),n.jsx(M,{className:"cursor-pointer",onClick:W,children:"Remove"}),n.jsx(M,{className:"cursor-pointer accent-destructive dark:accent-destructive",onClick:()=>j("cancel"),children:"Cancel"})]})]})})}export{mt as default};
