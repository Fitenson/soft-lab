import{c as l,a as F,j as e}from"./main-rRv66LRu.js";import{C as y,u as C,D as v,b as V,c as U,g as I}from"./useClientDatabaseService-BJn1r7Yp.js";import{F as q,a as n,b as c,c as i,d,e as x}from"./form-BhaJfYb_.js";import{I as b}from"./input-ufQ33NoA.js";import{u as M,a as T}from"./zod-B6pm4b7v.js";import{o as B,s as u}from"./schemas-6m5s2bNq.js";import{B as k}from"./button-bN4rln9q.js";import{S as H}from"./save-button-CMMwa3YY.js";import{u as P}from"./use-show-toast-DTQfoTPk.js";import{X as z}from"./index-DUM-k9uY.js";import"./index-B2B7QW1k.js";import"./serviceHandler-BlQljMi1.js";import"./useRequest-lw6-bRWX.js";import"./useAppSelector-C3gUEf_H.js";import"./useAuthState-9ObYT1fq.js";import"./BaseEntity-DGhPHkWu.js";import"./index-C56eY-JC.js";import"./createLucideIcon-BYSXuSnP.js";const a={databaseName:l({name:"databaseName",label:"Database Name",max:50}),databaseSchema:l({name:"databaseSchema",label:"Database Schema",max:50}),host:l({name:"host",label:"Host",max:50}),port:l({name:"port",label:"Port",max:50}),username:l({name:"username",label:"Username",max:50}),password:l({name:"password",label:"Password",max:50})},L=B({databaseName:u().max(a.databaseName.max,{error:a.databaseName.maxError}),databaseSchema:u().max(a.databaseSchema.max,{error:a.databaseSchema.maxError}),host:u().max(a.host.max,{error:a.host.maxError}),port:u().max(a.port.max,{error:a.port.maxError}),username:u().max(a.username.max,{error:a.username.maxError}),password:u().max(a.password.max,{error:a.password.maxError})}),R=({clientDatabaseDTO:j})=>{const[o,h]=F.useState(()=>j?new y(j):void 0),s=M({resolver:T(L),defaultValues:{databaseName:o?.databaseName??"",databaseSchema:o?.databaseSchema??"",host:o?.host??"",port:o?.port??"",username:o?.username??"",password:o?.password??""}});return{form:s,setFormError:(p,f)=>{const{setToastError:w}=f||{},D=p,t=D?.response?.data?.errors??{};typeof t=="string"?w?.(t):t&&Object.keys(t).length>0?Object.keys(t).forEach(N=>{const r=N.replace(/^clientDatabase\./,"");r in s.getValues()&&s.setError(r,{type:"server",message:t[N][0]??"Invalid value"})}):w?.(D?.response?.data?.message??"Server error")},clientDatabaseViewModel:o,setClientDatabaseViewModel:h}};function me({clientDatabaseDTO:j,open:o,onOpenChange:h}){const{form:s,setFormError:E,clientDatabaseViewModel:p,setClientDatabaseViewModel:f}=R({clientDatabaseDTO:j}),{createClientDatabase:w,updateClientDatabase:D}=C(),t=P(),N=async()=>{const S={...s.getValues(),...p?.UUID?{UUID:p.UUID}:{}};S?.UUID?await D(S,{onSuccess:m=>{f(m),h(!1)},onError:m=>{E(m,{setToastError(g){t("Error",g,"error")}})}}):await w(S,{onSuccess:m=>{f(m),h(!1)},onError:m=>{E(m,{setToastError(g){t("Error",g,"error")}})}})};return e.jsx(v,{open:o,onOpenChange:h,children:e.jsx(V,{className:"sm:max-w-[520px]",showCloseButton:!1,children:e.jsx("div",{className:"w-full",children:e.jsx(q,{...s,children:e.jsxs("form",{className:"grid grid-cols-2 gap-4",onSubmit:s.handleSubmit(N),children:[e.jsxs(U,{className:"mb-4 col-span-2 flex flex-row items-center justify-start",children:[e.jsx(H,{}),e.jsx(I,{asChild:!0,children:e.jsx(k,{variant:"ghost",type:"button",className:"cursor-pointer rounded-full",children:e.jsx(z,{className:"h-5 w-5 text-accent-foreground dark:text-accent-foreground"})})})]}),e.jsx(n,{control:s.control,name:a.databaseName.name,render:({field:r})=>e.jsxs(c,{className:"my-1 ml-1 mb-1",children:[e.jsx(i,{children:a.databaseName.label}),e.jsx(d,{children:e.jsx(b,{...r,required:!0})}),e.jsx(x,{})]})}),e.jsx(n,{control:s.control,name:a.databaseSchema.name,render:({field:r})=>e.jsxs(c,{className:"my-1 ml-1 mb-1",children:[e.jsx(i,{children:a.databaseSchema.label}),e.jsx(d,{children:e.jsx(b,{...r,required:!0})}),e.jsx(x,{})]})}),e.jsx(n,{control:s.control,name:a.host.name,render:({field:r})=>e.jsxs(c,{className:"my-1 ml-1 mb-1",children:[e.jsx(i,{children:a.host.label}),e.jsx(d,{children:e.jsx(b,{...r,required:!0})}),e.jsx(x,{})]})}),e.jsx(n,{control:s.control,name:a.port.name,render:({field:r})=>e.jsxs(c,{className:"my-1 ml-1 mb-1",children:[e.jsx(i,{children:a.port.label}),e.jsx(d,{children:e.jsx(b,{...r,required:!0})}),e.jsx(x,{})]})}),e.jsx(n,{control:s.control,name:a.username.name,render:({field:r})=>e.jsxs(c,{className:"my-1 ml-1 mb-1",children:[e.jsx(i,{children:a.username.label}),e.jsx(d,{children:e.jsx(b,{...r,required:!0})}),e.jsx(x,{})]})}),e.jsx(n,{control:s.control,name:a.password.name,render:({field:r})=>e.jsxs(c,{className:"my-1 ml-1 mb-1",children:[e.jsx(i,{children:a.password.label}),e.jsx(d,{children:e.jsx(b,{...r,required:!0})}),e.jsx(x,{})]})})]})})})})})}export{me as default};
