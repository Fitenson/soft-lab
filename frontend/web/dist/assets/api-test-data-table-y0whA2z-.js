import{a as m,j as e,E as Z,P as Q,N as _,Z as W,L,M as O,ae as Y,x as ee,h as te}from"./main-BrIqsKXW.js";import{u as ae,f as re,b as se}from"./index-C487TGc-.js";import{T as ne,a as oe,b as j,c as le,d as ce,e as B}from"./table-DAyde-BN.js";import{c as T}from"./ColumnConfig-5V9xLkEq.js";import{A as k}from"./ApiTestDataFormField-Cfh9L2cj.js";import{u as ie,S as de,a as ue,c as pe,d as E}from"./select-DlyHwvM1.js";import{C as me}from"./check--_hHwunr.js";import{S as be}from"./skeleton-B-6JYril.js";import{u as he}from"./useAppSelector-CFU6D_26.js";import{I as fe}from"./input-DoYPT-nv.js";import{a as P,b as w,d as F}from"./form-BWnojaLx.js";import{d as xe}from"./index.esm-bLb3mve6.js";import{D,T as ge}from"./table-selection-popover-Co9iCnvX.js";import"./button-Dd2dsCPe.js";import"./createLucideIcon-CpF0zOK5.js";import"./index-Ezfs3ch-.js";import"./index-BzZy9qUF.js";import"./label-Dtv15Q_S.js";import"./popover-B5dCc3ZB.js";import"./index-BFtdsut9.js";import"./ClientDatabaseTableViewModel-CWID7VbN.js";import"./clientDatabaseSelectors-BCEKIPh0.js";import"./loader-circle-CE81YaVq.js";var S="Checkbox",[ke,Ze]=Z(S),[Ce,A]=ke(S);function ve(a){const{__scopeCheckbox:o,checked:i,children:l,defaultChecked:c,disabled:s,form:x,name:b,onCheckedChange:d,required:C,value:v="on",internal_do_not_use_render:r}=a,[t,f]=W({prop:i,defaultProp:c??!1,onChange:d,caller:S}),[n,h]=m.useState(null),[p,u]=m.useState(null),g=m.useRef(!1),N=n?!!x||!!n.closest("form"):!0,R={checked:t,disabled:s,setChecked:f,control:n,setControl:h,name:b,form:x,value:v,hasConsumerStoppedPropagationRef:g,required:C,defaultChecked:y(c)?!1:c,isFormControl:N,bubbleInput:p,setBubbleInput:u};return e.jsx(Ce,{scope:o,...R,children:ye(r)?r(R):l})}var $="CheckboxTrigger",I=m.forwardRef(({__scopeCheckbox:a,onKeyDown:o,onClick:i,...l},c)=>{const{control:s,value:x,disabled:b,checked:d,required:C,setControl:v,setChecked:r,hasConsumerStoppedPropagationRef:t,isFormControl:f,bubbleInput:n}=A($,a),h=L(c,v),p=m.useRef(d);return m.useEffect(()=>{const u=s?.form;if(u){const g=()=>r(p.current);return u.addEventListener("reset",g),()=>u.removeEventListener("reset",g)}},[s,r]),e.jsx(_.button,{type:"button",role:"checkbox","aria-checked":y(d)?"mixed":d,"aria-required":C,"data-state":V(d),"data-disabled":b?"":void 0,disabled:b,value:x,...l,ref:h,onKeyDown:O(o,u=>{u.key==="Enter"&&u.preventDefault()}),onClick:O(i,u=>{r(g=>y(g)?!0:!g),n&&f&&(t.current=u.isPropagationStopped(),t.current||u.stopPropagation())})})});I.displayName=$;var M=m.forwardRef((a,o)=>{const{__scopeCheckbox:i,name:l,checked:c,defaultChecked:s,required:x,disabled:b,value:d,onCheckedChange:C,form:v,...r}=a;return e.jsx(ve,{__scopeCheckbox:i,checked:c,defaultChecked:s,disabled:b,required:x,onCheckedChange:C,name:l,form:v,value:d,internal_do_not_use_render:({isFormControl:t})=>e.jsxs(e.Fragment,{children:[e.jsx(I,{...r,ref:o,__scopeCheckbox:i}),t&&e.jsx(J,{__scopeCheckbox:i})]})})});M.displayName=S;var H="CheckboxIndicator",K=m.forwardRef((a,o)=>{const{__scopeCheckbox:i,forceMount:l,...c}=a,s=A(H,i);return e.jsx(Q,{present:l||y(s.checked)||s.checked===!0,children:e.jsx(_.span,{"data-state":V(s.checked),"data-disabled":s.disabled?"":void 0,...c,ref:o,style:{pointerEvents:"none",...a.style}})})});K.displayName=H;var q="CheckboxBubbleInput",J=m.forwardRef(({__scopeCheckbox:a,...o},i)=>{const{control:l,hasConsumerStoppedPropagationRef:c,checked:s,defaultChecked:x,required:b,disabled:d,name:C,value:v,form:r,bubbleInput:t,setBubbleInput:f}=A(q,a),n=L(i,f),h=ie(s),p=Y(l);m.useEffect(()=>{const g=t;if(!g)return;const N=window.HTMLInputElement.prototype,z=Object.getOwnPropertyDescriptor(N,"checked").set,U=!c.current;if(h!==s&&z){const X=new Event("click",{bubbles:U});g.indeterminate=y(s),z.call(g,y(s)?!1:s),g.dispatchEvent(X)}},[t,h,s,c]);const u=m.useRef(y(s)?!1:s);return e.jsx(_.input,{type:"checkbox","aria-hidden":!0,defaultChecked:x??u.current,required:b,disabled:d,name:C,value:v,form:r,...o,tabIndex:-1,ref:n,style:{...o.style,...p,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});J.displayName=q;function ye(a){return typeof a=="function"}function y(a){return a==="indeterminate"}function V(a){return y(a)?"indeterminate":a?"checked":"unchecked"}function G({className:a,...o}){return e.jsx(M,{"data-slot":"checkbox",className:ee("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",a),...o,children:e.jsx(K,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(me,{className:"size-3.5"})})})}function je(a,o){return({getValue:i,row:l})=>{const c=!!i(),s=l.original,x=o?.disabled?.(s)??!1,b=o?.ariaLabel?.(s)??"Toggle";return e.jsx("div",{className:"flex items-center",onClick:d=>d.stopPropagation(),children:e.jsx(G,{checked:c,disabled:x,"aria-label":b,onCheckedChange:d=>a({row:s,next:!!d}),className:"translate-y-[1px]"})})}}const Te=[T({accessorKey:k.enabled.name,header:null,size:44,minSize:36,maxSize:64,enableSorting:!1,cell:je(({row:a,next:o})=>{console.log(a),console.log(o)},{})}),T({accessorKey:k.key.name,header:k.key.label,enableSorting:!1}),T({accessorKey:k.value.name,header:k.value.label,enableSorting:!1}),T({accessorKey:k.description.name,header:k.description.label,enableSorting:!1})],Se=["key","value","description"],Ne=a=>Se.includes(a);function Qe({form:a}){const[o,i]=m.useState(null),{fields:l,append:c}=xe({control:a.control,name:"apiTestData"}),s=ae({data:structuredClone(l),columns:Te,enableRowSelection:!0,enableSorting:!1,enableFilters:!1,enableSortingRemoval:!1,getCoreRowModel:se()}),x=he(te),b=m.useRef(null),d=r=>{if(typeof r=="number"){if(b.current===r)return;b.current=r}const t=new D;t.setField("text"),c({isNew:1,enabled:0,key:"",value:"",description:"",fieldType:t.asJSONString()},{shouldFocus:!1})},C=(r,t)=>{a.setValue(`apiTestData.${r}.enabled`,t),r===l.length-1&&t===1&&d(r)},v=r=>{a.getValues(`apiTestData.${r}.enabled`)!==1&&a.setValue(`apiTestData.${r}.enabled`,1),r===l.length-1&&d(r)};return m.useEffect(()=>{if(l.length===0){const r=new D;r.setField("text"),c({isNew:1,enabled:0,key:"",value:"",description:"",fieldType:r.asJSONString()},{shouldFocus:!1}),b.current=null}},[l.length,c]),e.jsxs(ne,{className:"card",children:[e.jsx(oe,{children:s.getHeaderGroups().map(r=>e.jsx(j,{className:"border-b border-accent dark:border-accent",children:r.headers.map(t=>e.jsxs(le,{className:"m-0 p-0 border-r border-accent dark:border-accent last:border-r-0",style:{width:t.getSize()},children:[t.isPlaceholder?null:re(t.column.columnDef.header,t.getContext()),t.column.getCanResize()&&e.jsx("div",{onMouseDown:t.getResizeHandler(),onTouchStart:t.getResizeHandler(),className:`absolute right-0 top-0 h-full w-1 cursor-col-resize select-none
                                            ${t.column.getIsResizing()?"bg-blue-500":"bg-transparent hover:bg-gray-400"}`})]},t.id))},r.id))}),e.jsx(ce,{children:x?Array.from({length:5}).map((r,t)=>e.jsx(j,{children:s.getAllLeafColumns().map(f=>e.jsx("td",{className:"px-2 py-2",children:e.jsx(be,{className:"h-4 w-full rounded-2xl p-4 m-1 gap-2"})},f.id))},`skeleton-${t}`)):l.length>0?l.map((r,t)=>e.jsx(j,{className:"cursor-pointer p-2 border border-accent dark:border-accent text-foreground dark:text-foreground",children:s.getAllLeafColumns().map(f=>e.jsx(B,{className:"p-2",children:f.id===k.enabled.name?e.jsx(P,{control:a.control,name:`apiTestData.${t}.enabled`,render:({field:n})=>e.jsx(w,{children:e.jsx(F,{children:e.jsx("div",{onClick:h=>h.stopPropagation(),className:"flex items-center",children:e.jsx(G,{checked:n.value===1,onCheckedChange:h=>{const p=h?1:0;n.onChange(p),C(t,p)},"aria-label":"Toggle",className:"cursor-pointer h-6 w-6 shrink-0 translate-y-[1px]"})})})})}):Ne(f.id)&&e.jsxs("div",{className:"flex flex-row gap-1",children:[e.jsx(P,{control:a.control,name:`apiTestData.${t}.${f.id}`,render:({field:n})=>e.jsx(w,{children:e.jsx(F,{children:e.jsx(fe,{...n,value:n.value??"",onChange:h=>n.onChange(h.target.value),onFocus:()=>v(t),className:"w-full h-8"})})})}),e.jsx(P,{name:`apiTestData.${t}.${k.fieldType.name}`,control:a.control,render:({field:n})=>{const h=(()=>{try{if(!n.value)return"text";const p=typeof n.value=="string"?JSON.parse(n.value):n.value;return(p?Object.keys(p)[0]:"text")||"text"}catch{return"text"}})();return e.jsx(w,{children:e.jsx(F,{children:f.id===k.value.name&&e.jsxs(m.Fragment,{children:[e.jsxs(de,{value:h,onValueChange:p=>{const u=new D;u.setField(p),n.onChange(u.asJSONString()),setTimeout(p==="dropdown"?()=>i(t):()=>i(null),300)},children:[e.jsx(ue,{className:"h-6 w-6 flex items-center justify-center rounded-md border text-xs p-1"}),e.jsxs(pe,{children:[e.jsx(E,{value:"text",children:"Text"}),e.jsx(E,{value:"dropdown",children:"Dropdown"}),e.jsx(E,{value:"file",children:"File"})]})]}),e.jsx(ge,{rowIndex:t,isOpen:o===t,setIsOpen:p=>i(p?t:null)})]})})})}})]})},f.id))},r.id)):e.jsx(j,{children:e.jsx(B,{colSpan:s.getAllLeafColumns().length,className:"h-24 text-center text-muted-foreground",children:"No test data rows found."})})})]})}export{Qe as default};
