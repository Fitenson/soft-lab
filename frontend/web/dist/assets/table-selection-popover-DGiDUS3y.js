import{a as l,Y as P,N as R,X as z,j as p,x as V,h as Ie}from"./main-DGN5mpaW.js";import{P as Re,a as Ne}from"./popover-DicmKF-j.js";import{L as Ae}from"./label-DvgNmBcm.js";import{R as Me,P as De,O as Le,C as $e}from"./index-DGcFUpkZ.js";import{c as Pe}from"./createLucideIcon-C6BJ9PvY.js";import{u as fe}from"./useAppSelector-Dph1zFC5.js";import{C as Fe}from"./ClientDatabaseTableViewModel-CWID7VbN.js";import{a as Te}from"./clientDatabaseSelectors-BCEKIPh0.js";import{L as Ke}from"./loader-circle-C5vmr0Xp.js";import"./index-BPkJt45m.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Ve=Pe("search",ze);var pe=1,qe=.9,Be=.8,_e=.17,ee=.1,te=.999,Ge=.9999,Oe=.99,Ue=/[\\\/_+.#"@\[\(\{&]/,He=/[\\\/_+.#"@\[\(\{&]/g,We=/[\s-]/,xe=/[\s-]/g;function ne(e,n,r,d,o,u,c){if(u===n.length)return o===e.length?pe:Oe;var f=`${o},${u}`;if(c[f]!==void 0)return c[f];for(var x=d.charAt(u),i=r.indexOf(x,o),h=0,g,j,k,S;i>=0;)g=ne(e,n,r,d,i+1,u+1,c),g>h&&(i===o?g*=pe:Ue.test(e.charAt(i-1))?(g*=Be,k=e.slice(o,i-1).match(He),k&&o>0&&(g*=Math.pow(te,k.length))):We.test(e.charAt(i-1))?(g*=qe,S=e.slice(o,i-1).match(xe),S&&o>0&&(g*=Math.pow(te,S.length))):(g*=_e,o>0&&(g*=Math.pow(te,i-o))),e.charAt(i)!==n.charAt(u)&&(g*=Ge)),(g<ee&&r.charAt(i-1)===d.charAt(u+1)||d.charAt(u+1)===d.charAt(u)&&r.charAt(i-1)!==d.charAt(u))&&(j=ne(e,n,r,d,i+1,u+2,c),j*ee>g&&(g=j*ee)),g>h&&(h=g),i=r.indexOf(x,i+1);return c[f]=h,h}function ve(e){return e.toLowerCase().replace(xe," ")}function Xe(e,n,r){return e=r&&r.length>0?`${e+" "+r.join(" ")}`:e,ne(e,n,ve(e),ve(n),0,0,{})}var K='[cmdk-group=""]',re='[cmdk-group-items=""]',Ye='[cmdk-group-heading=""]',ye='[cmdk-item=""]',he=`${ye}:not([aria-disabled="true"])`,le="cmdk-item-select",L="data-value",Je=(e,n,r)=>Xe(e,n,r),we=l.createContext(void 0),q=()=>l.useContext(we),ke=l.createContext(void 0),ae=()=>l.useContext(ke),Ee=l.createContext(void 0),Ce=l.forwardRef((e,n)=>{let r=$(()=>{var t,s;return{search:"",value:(s=(t=e.value)!=null?t:e.defaultValue)!=null?s:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),d=$(()=>new Set),o=$(()=>new Map),u=$(()=>new Map),c=$(()=>new Set),f=je(e),{label:x,children:i,value:h,onValueChange:g,filter:j,shouldFilter:k,loop:S,disablePointerSelection:O=!1,vimBindings:N=!0,...B}=e,U=P(),oe=P(),H=P(),A=l.useRef(null),y=ut();M(()=>{if(h!==void 0){let t=h.trim();r.current.value=t,E.emit()}},[h]),M(()=>{y(6,ue)},[]);let E=l.useMemo(()=>({subscribe:t=>(c.current.add(t),()=>c.current.delete(t)),snapshot:()=>r.current,setState:(t,s,m)=>{var a,v,b,C;if(!Object.is(r.current[t],s)){if(r.current[t]=s,t==="search")J(),X(),y(1,Y);else if(t==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let w=document.getElementById(H);w?w.focus():(a=document.getElementById(U))==null||a.focus()}if(y(7,()=>{var w;r.current.selectedItemId=(w=D())==null?void 0:w.id,E.emit()}),m||y(5,ue),((v=f.current)==null?void 0:v.value)!==void 0){let w=s??"";(C=(b=f.current).onValueChange)==null||C.call(b,w);return}}E.emit()}},emit:()=>{c.current.forEach(t=>t())}}),[]),W=l.useMemo(()=>({value:(t,s,m)=>{var a;s!==((a=u.current.get(t))==null?void 0:a.value)&&(u.current.set(t,{value:s,keywords:m}),r.current.filtered.items.set(t,ie(s,m)),y(2,()=>{X(),E.emit()}))},item:(t,s)=>(d.current.add(t),s&&(o.current.has(s)?o.current.get(s).add(t):o.current.set(s,new Set([t]))),y(3,()=>{J(),X(),r.current.value||Y(),E.emit()}),()=>{u.current.delete(t),d.current.delete(t),r.current.filtered.items.delete(t);let m=D();y(4,()=>{J(),m?.getAttribute("id")===t&&Y(),E.emit()})}),group:t=>(o.current.has(t)||o.current.set(t,new Set),()=>{u.current.delete(t),o.current.delete(t)}),filter:()=>f.current.shouldFilter,label:x||e["aria-label"],getDisablePointerSelection:()=>f.current.disablePointerSelection,listId:U,inputId:H,labelId:oe,listInnerRef:A}),[]);function ie(t,s){var m,a;let v=(a=(m=f.current)==null?void 0:m.filter)!=null?a:Je;return t?v(t,r.current.search,s):0}function X(){if(!r.current.search||f.current.shouldFilter===!1)return;let t=r.current.filtered.items,s=[];r.current.filtered.groups.forEach(a=>{let v=o.current.get(a),b=0;v.forEach(C=>{let w=t.get(C);b=Math.max(w,b)}),s.push([a,b])});let m=A.current;T().sort((a,v)=>{var b,C;let w=a.getAttribute("id"),_=v.getAttribute("id");return((b=t.get(_))!=null?b:0)-((C=t.get(w))!=null?C:0)}).forEach(a=>{let v=a.closest(re);v?v.appendChild(a.parentElement===v?a:a.closest(`${re} > *`)):m.appendChild(a.parentElement===m?a:a.closest(`${re} > *`))}),s.sort((a,v)=>v[1]-a[1]).forEach(a=>{var v;let b=(v=A.current)==null?void 0:v.querySelector(`${K}[${L}="${encodeURIComponent(a[0])}"]`);b?.parentElement.appendChild(b)})}function Y(){let t=T().find(m=>m.getAttribute("aria-disabled")!=="true"),s=t?.getAttribute(L);E.setState("value",s||void 0)}function J(){var t,s,m,a;if(!r.current.search||f.current.shouldFilter===!1){r.current.filtered.count=d.current.size;return}r.current.filtered.groups=new Set;let v=0;for(let b of d.current){let C=(s=(t=u.current.get(b))==null?void 0:t.value)!=null?s:"",w=(a=(m=u.current.get(b))==null?void 0:m.keywords)!=null?a:[],_=ie(C,w);r.current.filtered.items.set(b,_),_>0&&v++}for(let[b,C]of o.current)for(let w of C)if(r.current.filtered.items.get(w)>0){r.current.filtered.groups.add(b);break}r.current.filtered.count=v}function ue(){var t,s,m;let a=D();a&&(((t=a.parentElement)==null?void 0:t.firstChild)===a&&((m=(s=a.closest(K))==null?void 0:s.querySelector(Ye))==null||m.scrollIntoView({block:"nearest"})),a.scrollIntoView({block:"nearest"}))}function D(){var t;return(t=A.current)==null?void 0:t.querySelector(`${ye}[aria-selected="true"]`)}function T(){var t;return Array.from(((t=A.current)==null?void 0:t.querySelectorAll(he))||[])}function Q(t){let s=T()[t];s&&E.setState("value",s.getAttribute(L))}function Z(t){var s;let m=D(),a=T(),v=a.findIndex(C=>C===m),b=a[v+t];(s=f.current)!=null&&s.loop&&(b=v+t<0?a[a.length-1]:v+t===a.length?a[0]:a[v+t]),b&&E.setState("value",b.getAttribute(L))}function se(t){let s=D(),m=s?.closest(K),a;for(;m&&!a;)m=t>0?ot(m,K):it(m,K),a=m?.querySelector(he);a?E.setState("value",a.getAttribute(L)):Z(t)}let ce=()=>Q(T().length-1),de=t=>{t.preventDefault(),t.metaKey?ce():t.altKey?se(1):Z(1)},me=t=>{t.preventDefault(),t.metaKey?Q(0):t.altKey?se(-1):Z(-1)};return l.createElement(R.div,{ref:n,tabIndex:-1,...B,"cmdk-root":"",onKeyDown:t=>{var s;(s=B.onKeyDown)==null||s.call(B,t);let m=t.nativeEvent.isComposing||t.keyCode===229;if(!(t.defaultPrevented||m))switch(t.key){case"n":case"j":{N&&t.ctrlKey&&de(t);break}case"ArrowDown":{de(t);break}case"p":case"k":{N&&t.ctrlKey&&me(t);break}case"ArrowUp":{me(t);break}case"Home":{t.preventDefault(),Q(0);break}case"End":{t.preventDefault(),ce();break}case"Enter":{t.preventDefault();let a=D();if(a){let v=new Event(le);a.dispatchEvent(v)}}}}},l.createElement("label",{"cmdk-label":"",htmlFor:W.inputId,id:W.labelId,style:ct},x),G(e,t=>l.createElement(ke.Provider,{value:E},l.createElement(we.Provider,{value:W},t))))}),Qe=l.forwardRef((e,n)=>{var r,d;let o=P(),u=l.useRef(null),c=l.useContext(Ee),f=q(),x=je(e),i=(d=(r=x.current)==null?void 0:r.forceMount)!=null?d:c?.forceMount;M(()=>{if(!i)return f.item(o,c?.id)},[i]);let h=Se(o,u,[e.value,e.children,u],e.keywords),g=ae(),j=I(y=>y.value&&y.value===h.current),k=I(y=>i||f.filter()===!1?!0:y.search?y.filtered.items.get(o)>0:!0);l.useEffect(()=>{let y=u.current;if(!(!y||e.disabled))return y.addEventListener(le,S),()=>y.removeEventListener(le,S)},[k,e.onSelect,e.disabled]);function S(){var y,E;O(),(E=(y=x.current).onSelect)==null||E.call(y,h.current)}function O(){g.setState("value",h.current,!0)}if(!k)return null;let{disabled:N,value:B,onSelect:U,forceMount:oe,keywords:H,...A}=e;return l.createElement(R.div,{ref:z(u,n),...A,id:o,"cmdk-item":"",role:"option","aria-disabled":!!N,"aria-selected":!!j,"data-disabled":!!N,"data-selected":!!j,onPointerMove:N||f.getDisablePointerSelection()?void 0:O,onClick:N?void 0:S},e.children)}),Ze=l.forwardRef((e,n)=>{let{heading:r,children:d,forceMount:o,...u}=e,c=P(),f=l.useRef(null),x=l.useRef(null),i=P(),h=q(),g=I(k=>o||h.filter()===!1?!0:k.search?k.filtered.groups.has(c):!0);M(()=>h.group(c),[]),Se(c,f,[e.value,e.heading,x]);let j=l.useMemo(()=>({id:c,forceMount:o}),[o]);return l.createElement(R.div,{ref:z(f,n),...u,"cmdk-group":"",role:"presentation",hidden:g?void 0:!0},r&&l.createElement("div",{ref:x,"cmdk-group-heading":"","aria-hidden":!0,id:i},r),G(e,k=>l.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?i:void 0},l.createElement(Ee.Provider,{value:j},k))))}),et=l.forwardRef((e,n)=>{let{alwaysRender:r,...d}=e,o=l.useRef(null),u=I(c=>!c.search);return!r&&!u?null:l.createElement(R.div,{ref:z(o,n),...d,"cmdk-separator":"",role:"separator"})}),tt=l.forwardRef((e,n)=>{let{onValueChange:r,...d}=e,o=e.value!=null,u=ae(),c=I(i=>i.search),f=I(i=>i.selectedItemId),x=q();return l.useEffect(()=>{e.value!=null&&u.setState("search",e.value)},[e.value]),l.createElement(R.input,{ref:n,...d,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":x.listId,"aria-labelledby":x.labelId,"aria-activedescendant":f,id:x.inputId,type:"text",value:o?e.value:c,onChange:i=>{o||u.setState("search",i.target.value),r?.(i.target.value)}})}),rt=l.forwardRef((e,n)=>{let{children:r,label:d="Suggestions",...o}=e,u=l.useRef(null),c=l.useRef(null),f=I(i=>i.selectedItemId),x=q();return l.useEffect(()=>{if(c.current&&u.current){let i=c.current,h=u.current,g,j=new ResizeObserver(()=>{g=requestAnimationFrame(()=>{let k=i.offsetHeight;h.style.setProperty("--cmdk-list-height",k.toFixed(1)+"px")})});return j.observe(i),()=>{cancelAnimationFrame(g),j.unobserve(i)}}},[]),l.createElement(R.div,{ref:z(u,n),...o,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":f,"aria-label":d,id:x.listId},G(e,i=>l.createElement("div",{ref:z(c,x.listInnerRef),"cmdk-list-sizer":""},i)))}),nt=l.forwardRef((e,n)=>{let{open:r,onOpenChange:d,overlayClassName:o,contentClassName:u,container:c,...f}=e;return l.createElement(Me,{open:r,onOpenChange:d},l.createElement(De,{container:c},l.createElement(Le,{"cmdk-overlay":"",className:o}),l.createElement($e,{"aria-label":e.label,"cmdk-dialog":"",className:u},l.createElement(Ce,{ref:n,...f}))))}),lt=l.forwardRef((e,n)=>I(r=>r.filtered.count===0)?l.createElement(R.div,{ref:n,...e,"cmdk-empty":"",role:"presentation"}):null),at=l.forwardRef((e,n)=>{let{progress:r,children:d,label:o="Loading...",...u}=e;return l.createElement(R.div,{ref:n,...u,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":o},G(e,c=>l.createElement("div",{"aria-hidden":!0},c)))}),F=Object.assign(Ce,{List:rt,Item:Qe,Input:tt,Group:Ze,Separator:et,Dialog:nt,Empty:lt,Loading:at});function ot(e,n){let r=e.nextElementSibling;for(;r;){if(r.matches(n))return r;r=r.nextElementSibling}}function it(e,n){let r=e.previousElementSibling;for(;r;){if(r.matches(n))return r;r=r.previousElementSibling}}function je(e){let n=l.useRef(e);return M(()=>{n.current=e}),n}var M=typeof window>"u"?l.useEffect:l.useLayoutEffect;function $(e){let n=l.useRef();return n.current===void 0&&(n.current=e()),n}function I(e){let n=ae(),r=()=>e(n.snapshot());return l.useSyncExternalStore(n.subscribe,r,r)}function Se(e,n,r,d=[]){let o=l.useRef(),u=q();return M(()=>{var c;let f=(()=>{var i;for(let h of r){if(typeof h=="string")return h.trim();if(typeof h=="object"&&"current"in h)return h.current?(i=h.current.textContent)==null?void 0:i.trim():o.current}})(),x=d.map(i=>i.trim());u.value(e,f,x),(c=n.current)==null||c.setAttribute(L,f),o.current=f}),o}var ut=()=>{let[e,n]=l.useState(),r=$(()=>new Map);return M(()=>{r.current.forEach(d=>d()),r.current=new Map},[e]),(d,o)=>{r.current.set(d,o),n({})}};function st(e){let n=e.type;return typeof n=="function"?n(e.props):"render"in n?n.render(e.props):e}function G({asChild:e,children:n},r){return e&&l.isValidElement(n)?l.cloneElement(st(n),{ref:n.ref},r(n.props.children)):r(n)}var ct={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};function dt({className:e,...n}){return p.jsx(F,{"data-slot":"command",className:V("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",e),...n})}function mt({className:e,...n}){return p.jsxs("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[p.jsx(Ve,{className:"size-4 shrink-0 opacity-50"}),p.jsx(F.Input,{"data-slot":"command-input",className:V("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",e),...n})]})}function ft({className:e,...n}){return p.jsx(F.List,{"data-slot":"command-list",className:V("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",e),...n})}function ge({...e}){return p.jsx(F.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...e})}function be({className:e,...n}){return p.jsx(F.Group,{"data-slot":"command-group",className:V("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",e),...n})}function pt({className:e,...n}){return p.jsx(F.Item,{"data-slot":"command-item",className:V("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...n})}function jt({isOpen:e,setIsOpen:n}){const r=fe(Ie),d=fe(Te),[o,u]=l.useState();return l.useEffect(()=>{u(d.rows.map(c=>new Fe(c)))},[d]),p.jsxs(Re,{modal:!1,open:e,onOpenChange:n,children:[p.jsx(Ne,{asChild:!0,children:p.jsx("button",{className:"hidden",type:"button"})}),e&&p.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[p.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:()=>n(!1)}),p.jsxs("div",{className:"relative z-50 w-80 p-4 text-center bg-neutral-900 border border-neutral-700 rounded-xl shadow-2xl text-gray-100",children:[p.jsxs("div",{className:"flex items-center justify-between mb-3",children:[p.jsx(Ae,{className:"text-gray-300 text-sm",children:"Table"}),p.jsx("button",{className:"text-gray-500 hover:text-gray-200",onClick:()=>n(!1),children:"✕"})]}),p.jsxs(dt,{children:[p.jsx(mt,{placeholder:"Search for a table",className:"placeholder-gray-500"}),p.jsxs(ft,{children:[p.jsx(ge,{children:"No results found"}),p.jsx(be,{heading:"Suggestion",children:r?p.jsxs("div",{className:"flex justify-center py-6 text-gray-400",children:[p.jsx(Ke,{className:"w-5 h-5 mr-2 animate-spin"}),"Loading tables..."]}):p.jsx(p.Fragment,{children:o&&o.length>0?p.jsx(be,{heading:"Tables",children:o?.map(c=>p.jsx(pt,{value:c.table,onSelect:()=>{n(!1)},children:c.table},c.table))}):p.jsx(ge,{children:"No tables found"})})})]})]})]})]})]})}export{jt as default};
