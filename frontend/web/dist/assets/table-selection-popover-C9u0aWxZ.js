import{a as l,Y as T,N as R,X as K,j as p,x as V,h as Ie}from"./main-DY2sbF6P.js";import{P as Re,a as De}from"./popover-azegvj7E.js";import{L as Ne}from"./label-aBIViTaz.js";import{R as Ae,P as Me,O as $e,C as Fe}from"./index-COGUnvNa.js";import{c as Te}from"./createLucideIcon-CNr2s4p7.js";import{u as me}from"./useAppSelector-BiPAHM_x.js";import{C as Le}from"./ClientDatabaseTableViewModel-CWID7VbN.js";import{a as Pe}from"./clientDatabaseSelectors-BCEKIPh0.js";import{a as ze}from"./index.esm-D7VeYQlz.js";import{A as Ke}from"./ApiTestDataFormField-B4kiEgJZ.js";import{L as Ve}from"./loader-circle-D1iJtV4J.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],_e=Te("search",Oe);class qe{field={};table=new Set;type=null;setField(n){switch(this.type=n,n){case"text":this.field={text:"string"};break;case"file":this.field={file:"base64"};break;case"dropdown":this.field={};break;default:throw new Error("Unknown field type "+n)}}setDropdown(n){if(this.type!=="dropdown")throw new Error("setDropdown() can only be used after setField('dropdown')");if(this.table.has(n))throw new Error(`Duplicate table name: ${n}`);this.table.add(n),this.field={dropdown:{table:n}}}asJSONString(){return btoa(JSON.stringify(this.field,null,2))}asJson(){return this.field}getField(){return this.field}}var pe=1,Je=.9,Be=.8,Ue=.17,ee=.1,te=.999,Ge=.9999,He=.99,We=/[\\\/_+.#"@\[\(\{&]/,Xe=/[\\\/_+.#"@\[\(\{&]/g,Ye=/[\s-]/,xe=/[\s-]/g;function ne(e,n,r,c,o,s,d){if(s===n.length)return o===e.length?pe:He;var m=`${o},${s}`;if(d[m]!==void 0)return d[m];for(var v=c.charAt(s),i=r.indexOf(v,o),g=0,b,C,k,j;i>=0;)b=ne(e,n,r,c,i+1,s+1,d),b>g&&(i===o?b*=pe:We.test(e.charAt(i-1))?(b*=Be,k=e.slice(o,i-1).match(Xe),k&&o>0&&(b*=Math.pow(te,k.length))):Ye.test(e.charAt(i-1))?(b*=Je,j=e.slice(o,i-1).match(xe),j&&o>0&&(b*=Math.pow(te,j.length))):(b*=Ue,o>0&&(b*=Math.pow(te,i-o))),e.charAt(i)!==n.charAt(s)&&(b*=Ge)),(b<ee&&r.charAt(i-1)===c.charAt(s+1)||c.charAt(s+1)===c.charAt(s)&&r.charAt(i-1)!==c.charAt(s))&&(C=ne(e,n,r,c,i+1,s+2,d),C*ee>b&&(b=C*ee)),b>g&&(g=b),i=r.indexOf(v,i+1);return d[m]=g,g}function ve(e){return e.toLowerCase().replace(xe," ")}function Qe(e,n,r){return e=r&&r.length>0?`${e+" "+r.join(" ")}`:e,ne(e,n,ve(e),ve(n),0,0,{})}var z='[cmdk-group=""]',re='[cmdk-group-items=""]',Ze='[cmdk-group-heading=""]',ye='[cmdk-item=""]',he=`${ye}:not([aria-disabled="true"])`,le="cmdk-item-select",$="data-value",et=(e,n,r)=>Qe(e,n,r),we=l.createContext(void 0),O=()=>l.useContext(we),ke=l.createContext(void 0),ae=()=>l.useContext(ke),Ee=l.createContext(void 0),Se=l.forwardRef((e,n)=>{let r=F(()=>{var t,u;return{search:"",value:(u=(t=e.value)!=null?t:e.defaultValue)!=null?u:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),c=F(()=>new Set),o=F(()=>new Map),s=F(()=>new Map),d=F(()=>new Set),m=Ce(e),{label:v,children:i,value:g,onValueChange:b,filter:C,shouldFilter:k,loop:j,disablePointerSelection:B=!1,vimBindings:D=!0,..._}=e,U=T(),oe=T(),G=T(),N=l.useRef(null),y=ct();A(()=>{if(g!==void 0){let t=g.trim();r.current.value=t,E.emit()}},[g]),A(()=>{y(6,se)},[]);let E=l.useMemo(()=>({subscribe:t=>(d.current.add(t),()=>d.current.delete(t)),snapshot:()=>r.current,setState:(t,u,f)=>{var a,h,x,S;if(!Object.is(r.current[t],u)){if(r.current[t]=u,t==="search")Y(),W(),y(1,X);else if(t==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let w=document.getElementById(G);w?w.focus():(a=document.getElementById(U))==null||a.focus()}if(y(7,()=>{var w;r.current.selectedItemId=(w=M())==null?void 0:w.id,E.emit()}),f||y(5,se),((h=m.current)==null?void 0:h.value)!==void 0){let w=u??"";(S=(x=m.current).onValueChange)==null||S.call(x,w);return}}E.emit()}},emit:()=>{d.current.forEach(t=>t())}}),[]),H=l.useMemo(()=>({value:(t,u,f)=>{var a;u!==((a=s.current.get(t))==null?void 0:a.value)&&(s.current.set(t,{value:u,keywords:f}),r.current.filtered.items.set(t,ie(u,f)),y(2,()=>{W(),E.emit()}))},item:(t,u)=>(c.current.add(t),u&&(o.current.has(u)?o.current.get(u).add(t):o.current.set(u,new Set([t]))),y(3,()=>{Y(),W(),r.current.value||X(),E.emit()}),()=>{s.current.delete(t),c.current.delete(t),r.current.filtered.items.delete(t);let f=M();y(4,()=>{Y(),f?.getAttribute("id")===t&&X(),E.emit()})}),group:t=>(o.current.has(t)||o.current.set(t,new Set),()=>{s.current.delete(t),o.current.delete(t)}),filter:()=>m.current.shouldFilter,label:v||e["aria-label"],getDisablePointerSelection:()=>m.current.disablePointerSelection,listId:U,inputId:G,labelId:oe,listInnerRef:N}),[]);function ie(t,u){var f,a;let h=(a=(f=m.current)==null?void 0:f.filter)!=null?a:et;return t?h(t,r.current.search,u):0}function W(){if(!r.current.search||m.current.shouldFilter===!1)return;let t=r.current.filtered.items,u=[];r.current.filtered.groups.forEach(a=>{let h=o.current.get(a),x=0;h.forEach(S=>{let w=t.get(S);x=Math.max(w,x)}),u.push([a,x])});let f=N.current;P().sort((a,h)=>{var x,S;let w=a.getAttribute("id"),q=h.getAttribute("id");return((x=t.get(q))!=null?x:0)-((S=t.get(w))!=null?S:0)}).forEach(a=>{let h=a.closest(re);h?h.appendChild(a.parentElement===h?a:a.closest(`${re} > *`)):f.appendChild(a.parentElement===f?a:a.closest(`${re} > *`))}),u.sort((a,h)=>h[1]-a[1]).forEach(a=>{var h;let x=(h=N.current)==null?void 0:h.querySelector(`${z}[${$}="${encodeURIComponent(a[0])}"]`);x?.parentElement.appendChild(x)})}function X(){let t=P().find(f=>f.getAttribute("aria-disabled")!=="true"),u=t?.getAttribute($);E.setState("value",u||void 0)}function Y(){var t,u,f,a;if(!r.current.search||m.current.shouldFilter===!1){r.current.filtered.count=c.current.size;return}r.current.filtered.groups=new Set;let h=0;for(let x of c.current){let S=(u=(t=s.current.get(x))==null?void 0:t.value)!=null?u:"",w=(a=(f=s.current.get(x))==null?void 0:f.keywords)!=null?a:[],q=ie(S,w);r.current.filtered.items.set(x,q),q>0&&h++}for(let[x,S]of o.current)for(let w of S)if(r.current.filtered.items.get(w)>0){r.current.filtered.groups.add(x);break}r.current.filtered.count=h}function se(){var t,u,f;let a=M();a&&(((t=a.parentElement)==null?void 0:t.firstChild)===a&&((f=(u=a.closest(z))==null?void 0:u.querySelector(Ze))==null||f.scrollIntoView({block:"nearest"})),a.scrollIntoView({block:"nearest"}))}function M(){var t;return(t=N.current)==null?void 0:t.querySelector(`${ye}[aria-selected="true"]`)}function P(){var t;return Array.from(((t=N.current)==null?void 0:t.querySelectorAll(he))||[])}function Q(t){let u=P()[t];u&&E.setState("value",u.getAttribute($))}function Z(t){var u;let f=M(),a=P(),h=a.findIndex(S=>S===f),x=a[h+t];(u=m.current)!=null&&u.loop&&(x=h+t<0?a[a.length-1]:h+t===a.length?a[0]:a[h+t]),x&&E.setState("value",x.getAttribute($))}function ue(t){let u=M(),f=u?.closest(z),a;for(;f&&!a;)f=t>0?ut(f,z):dt(f,z),a=f?.querySelector(he);a?E.setState("value",a.getAttribute($)):Z(t)}let de=()=>Q(P().length-1),ce=t=>{t.preventDefault(),t.metaKey?de():t.altKey?ue(1):Z(1)},fe=t=>{t.preventDefault(),t.metaKey?Q(0):t.altKey?ue(-1):Z(-1)};return l.createElement(R.div,{ref:n,tabIndex:-1,..._,"cmdk-root":"",onKeyDown:t=>{var u;(u=_.onKeyDown)==null||u.call(_,t);let f=t.nativeEvent.isComposing||t.keyCode===229;if(!(t.defaultPrevented||f))switch(t.key){case"n":case"j":{D&&t.ctrlKey&&ce(t);break}case"ArrowDown":{ce(t);break}case"p":case"k":{D&&t.ctrlKey&&fe(t);break}case"ArrowUp":{fe(t);break}case"Home":{t.preventDefault(),Q(0);break}case"End":{t.preventDefault(),de();break}case"Enter":{t.preventDefault();let a=M();if(a){let h=new Event(le);a.dispatchEvent(h)}}}}},l.createElement("label",{"cmdk-label":"",htmlFor:H.inputId,id:H.labelId,style:mt},v),J(e,t=>l.createElement(ke.Provider,{value:E},l.createElement(we.Provider,{value:H},t))))}),tt=l.forwardRef((e,n)=>{var r,c;let o=T(),s=l.useRef(null),d=l.useContext(Ee),m=O(),v=Ce(e),i=(c=(r=v.current)==null?void 0:r.forceMount)!=null?c:d?.forceMount;A(()=>{if(!i)return m.item(o,d?.id)},[i]);let g=je(o,s,[e.value,e.children,s],e.keywords),b=ae(),C=I(y=>y.value&&y.value===g.current),k=I(y=>i||m.filter()===!1?!0:y.search?y.filtered.items.get(o)>0:!0);l.useEffect(()=>{let y=s.current;if(!(!y||e.disabled))return y.addEventListener(le,j),()=>y.removeEventListener(le,j)},[k,e.onSelect,e.disabled]);function j(){var y,E;B(),(E=(y=v.current).onSelect)==null||E.call(y,g.current)}function B(){b.setState("value",g.current,!0)}if(!k)return null;let{disabled:D,value:_,onSelect:U,forceMount:oe,keywords:G,...N}=e;return l.createElement(R.div,{ref:K(s,n),...N,id:o,"cmdk-item":"",role:"option","aria-disabled":!!D,"aria-selected":!!C,"data-disabled":!!D,"data-selected":!!C,onPointerMove:D||m.getDisablePointerSelection()?void 0:B,onClick:D?void 0:j},e.children)}),rt=l.forwardRef((e,n)=>{let{heading:r,children:c,forceMount:o,...s}=e,d=T(),m=l.useRef(null),v=l.useRef(null),i=T(),g=O(),b=I(k=>o||g.filter()===!1?!0:k.search?k.filtered.groups.has(d):!0);A(()=>g.group(d),[]),je(d,m,[e.value,e.heading,v]);let C=l.useMemo(()=>({id:d,forceMount:o}),[o]);return l.createElement(R.div,{ref:K(m,n),...s,"cmdk-group":"",role:"presentation",hidden:b?void 0:!0},r&&l.createElement("div",{ref:v,"cmdk-group-heading":"","aria-hidden":!0,id:i},r),J(e,k=>l.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?i:void 0},l.createElement(Ee.Provider,{value:C},k))))}),nt=l.forwardRef((e,n)=>{let{alwaysRender:r,...c}=e,o=l.useRef(null),s=I(d=>!d.search);return!r&&!s?null:l.createElement(R.div,{ref:K(o,n),...c,"cmdk-separator":"",role:"separator"})}),lt=l.forwardRef((e,n)=>{let{onValueChange:r,...c}=e,o=e.value!=null,s=ae(),d=I(i=>i.search),m=I(i=>i.selectedItemId),v=O();return l.useEffect(()=>{e.value!=null&&s.setState("search",e.value)},[e.value]),l.createElement(R.input,{ref:n,...c,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":v.listId,"aria-labelledby":v.labelId,"aria-activedescendant":m,id:v.inputId,type:"text",value:o?e.value:d,onChange:i=>{o||s.setState("search",i.target.value),r?.(i.target.value)}})}),at=l.forwardRef((e,n)=>{let{children:r,label:c="Suggestions",...o}=e,s=l.useRef(null),d=l.useRef(null),m=I(i=>i.selectedItemId),v=O();return l.useEffect(()=>{if(d.current&&s.current){let i=d.current,g=s.current,b,C=new ResizeObserver(()=>{b=requestAnimationFrame(()=>{let k=i.offsetHeight;g.style.setProperty("--cmdk-list-height",k.toFixed(1)+"px")})});return C.observe(i),()=>{cancelAnimationFrame(b),C.unobserve(i)}}},[]),l.createElement(R.div,{ref:K(s,n),...o,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":m,"aria-label":c,id:v.listId},J(e,i=>l.createElement("div",{ref:K(d,v.listInnerRef),"cmdk-list-sizer":""},i)))}),ot=l.forwardRef((e,n)=>{let{open:r,onOpenChange:c,overlayClassName:o,contentClassName:s,container:d,...m}=e;return l.createElement(Ae,{open:r,onOpenChange:c},l.createElement(Me,{container:d},l.createElement($e,{"cmdk-overlay":"",className:o}),l.createElement(Fe,{"aria-label":e.label,"cmdk-dialog":"",className:s},l.createElement(Se,{ref:n,...m}))))}),it=l.forwardRef((e,n)=>I(r=>r.filtered.count===0)?l.createElement(R.div,{ref:n,...e,"cmdk-empty":"",role:"presentation"}):null),st=l.forwardRef((e,n)=>{let{progress:r,children:c,label:o="Loading...",...s}=e;return l.createElement(R.div,{ref:n,...s,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":o},J(e,d=>l.createElement("div",{"aria-hidden":!0},d)))}),L=Object.assign(Se,{List:at,Item:tt,Input:lt,Group:rt,Separator:nt,Dialog:ot,Empty:it,Loading:st});function ut(e,n){let r=e.nextElementSibling;for(;r;){if(r.matches(n))return r;r=r.nextElementSibling}}function dt(e,n){let r=e.previousElementSibling;for(;r;){if(r.matches(n))return r;r=r.previousElementSibling}}function Ce(e){let n=l.useRef(e);return A(()=>{n.current=e}),n}var A=typeof window>"u"?l.useEffect:l.useLayoutEffect;function F(e){let n=l.useRef();return n.current===void 0&&(n.current=e()),n}function I(e){let n=ae(),r=()=>e(n.snapshot());return l.useSyncExternalStore(n.subscribe,r,r)}function je(e,n,r,c=[]){let o=l.useRef(),s=O();return A(()=>{var d;let m=(()=>{var i;for(let g of r){if(typeof g=="string")return g.trim();if(typeof g=="object"&&"current"in g)return g.current?(i=g.current.textContent)==null?void 0:i.trim():o.current}})(),v=c.map(i=>i.trim());s.value(e,m,v),(d=n.current)==null||d.setAttribute($,m),o.current=m}),o}var ct=()=>{let[e,n]=l.useState(),r=F(()=>new Map);return A(()=>{r.current.forEach(c=>c()),r.current=new Map},[e]),(c,o)=>{r.current.set(c,o),n({})}};function ft(e){let n=e.type;return typeof n=="function"?n(e.props):"render"in n?n.render(e.props):e}function J({asChild:e,children:n},r){return e&&l.isValidElement(n)?l.cloneElement(ft(n),{ref:n.ref},r(n.props.children)):r(n)}var mt={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};function pt({className:e,...n}){return p.jsx(L,{"data-slot":"command",className:V("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",e),...n})}function vt({className:e,...n}){return p.jsxs("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[p.jsx(_e,{className:"size-4 shrink-0 opacity-50"}),p.jsx(L.Input,{"data-slot":"command-input",className:V("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",e),...n})]})}function ht({className:e,...n}){return p.jsx(L.List,{"data-slot":"command-list",className:V("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",e),...n})}function ge({...e}){return p.jsx(L.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...e})}function be({className:e,...n}){return p.jsx(L.Group,{"data-slot":"command-group",className:V("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",e),...n})}function gt({className:e,...n}){return p.jsx(L.Item,{"data-slot":"command-item",className:V("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...n})}function bt({rowIndex:e,isOpen:n,setIsOpen:r}){const c=ze(),o=me(Ie),s=me(Pe),[d,m]=l.useState();return l.useEffect(()=>{m(s.rows.map(v=>new Le(v)))},[s]),p.jsxs(Re,{modal:!1,open:n,onOpenChange:r,children:[p.jsx(De,{asChild:!0,children:p.jsx("button",{className:"hidden",type:"button"})}),n&&p.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[p.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:()=>r(!1)}),p.jsxs("div",{className:"relative z-50 w-80 p-4 text-center bg-neutral-900 border border-neutral-700 rounded-xl shadow-2xl text-gray-100",children:[p.jsxs("div",{className:"flex items-center justify-between mb-3",children:[p.jsx(Ne,{className:"text-gray-300 text-sm",children:"Table"}),p.jsx("button",{className:"text-gray-500 hover:text-gray-200",onClick:()=>r(!1),children:"✕"})]}),p.jsxs(pt,{children:[p.jsx(vt,{placeholder:"Search for a table",className:"placeholder-gray-500"}),p.jsxs(ht,{children:[p.jsx(ge,{children:"No results found"}),p.jsx(be,{heading:"Suggestion",children:o?p.jsxs("div",{className:"flex justify-center py-6 text-gray-400",children:[p.jsx(Ve,{className:"w-5 h-5 mr-2 animate-spin"}),"Loading tables..."]}):p.jsx(p.Fragment,{children:d&&d.length>0?p.jsx(be,{heading:"Tables",children:d?.map(v=>p.jsx(gt,{value:v.table,onSelect:()=>{const i=new qe;i.setField("dropdown"),i.setDropdown(v.table),c.setValue(`apiTestData.${e}.${Ke.fieldType.name}`,i.asJSONString()),r(!1)},children:v.table},v.table))}):p.jsx(ge,{children:"No tables found"})})})]})]})]})]})]})}const Nt=Object.freeze(Object.defineProperty({__proto__:null,default:bt},Symbol.toStringTag,{value:"Module"}));export{qe as D,bt as T,Nt as t};
