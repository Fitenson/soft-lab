import{u as g,a as y,l as U,j as t,H as v,b as f,t as m,d as c,e as T,f as x}from"./main-B9kSPlih.js";import{A as w}from"./app-layout-CyZHyRPC.js";import S from"./api-test-layout-DYNQrY2z.js";import E from"./test-case-sidebar-CUA0N0P6.js";import F from"./test-case-form-CjxrOerX.js";import O from"./test-case-output-CR8SIQ3w.js";import{u as N}from"./useQuery-B_VMc0T-.js";import{u as k}from"./useApiTestService-Cr_Jc3FN.js";import{F as I}from"./index.esm-DTnlfpzt.js";import{u as C}from"./documentation-tab-C4vJ9rY2.js";import{u as D}from"./useAppSelector-5m2jQQPi.js";import{s as q}from"./apiTestSelectors-BJyltacD.js";import{F as H}from"./form-D7n3H12L.js";import{s as L}from"./clientDatabaseSelectors-Cw1rL9yb.js";import{u as P}from"./use-show-toast-aS1BksgY.js";import"./button-IWkCiMuA.js";import"./index-Bdx8hlOp.js";import"./index-Cr9z3bEa.js";import"./x-Di-N7UKN.js";import"./createLucideIcon-CDI3oWZc.js";import"./chevron-right-BuqN0i9r.js";import"./dropdown-menu-EfGzStmX.js";import"./index-Qz_8aHxD.js";import"./index-B39AUxGu.js";import"./index-1aM9UPTl.js";import"./check-CfYvyZhz.js";import"./useAuthState-Di_HTcE-.js";import"./index-TPnmYQwn.js";import"./tree-view-DDLsCkIE.js";import"./input-DtVRmdZn.js";import"./ApiTestFormField-CPezEdRn.js";import"./ApiTestViewModel-CRkjMY33.js";import"./skeleton-Bp8yWBgb.js";import"./tabs-SKF78HMD.js";import"./data-tab-Dv8vKPC-.js";import"./select-NvYdOhSS.js";import"./api-test-data-table-B4voK2LZ.js";import"./index-Dg63kHC2.js";import"./table-DAEYykBQ.js";import"./ColumnConfig-DLwQQGE7.js";import"./ApiTestDataFormField-B9GM47K2.js";import"./table-selection-popover-Bat9jU4s.js";import"./popover-BLC5I0-l.js";import"./label-BJYzQMLw.js";import"./loader-circle-r4T2xauo.js";import"./useClientDatabaseService-B3NIh_j4.js";import"./serviceHandler-BlQljMi1.js";import"./useRequest-w8ljcJHi.js";import"./BaseEntity-DGhPHkWu.js";import"./ClientDatabaseViewModel-CZz8IN5P.js";import"./scenario-tab-ikxG2FCD.js";import"./zod-BhlGvzDd.js";import"./schemas-D95ZC4Tg.js";import"./textarea-BZadXczm.js";function Ve(){const r=g(),{indexApiTest:b,createApiTest:h,updateApiTest:j}=k(),o=D(q),s=D(L),{form:a}=C({apiTestDTO:o}),l=P(),{data:n}=N({queryKey:["/backend/api_test/index"],queryFn:async()=>await b(),enabled:!0});y.useEffect(()=>{n&&r(U(n))},[r,n]);const A=async()=>{try{if(o&&s&&s.password){const d=a.getValues("apiTestData").map(e=>({apiTest:o.UUID,enabled:e.enabled??0,key:e.key??"",value:e.value??"",description:e.description??"",fieldType:e.fieldType??""})),u={...a.getValues(),UUID:o.UUID,project:s.project,clientDatabase:s.UUID,apiTestData:d??[]},p=[o?.UUID].filter(e=>e!==void 0);o.isNew?await h({apiTestDTO:u,clientDatabaseToken:s.password},{onSuccess:e=>{r(c(p)),r(T(e)),r(m({action:null})),r(x(e.apiTestDTO))},onError:e=>{console.error(e),l("Error","Failed to create test case","error"),r(f()),r(m({action:null})),r(c(p))}}):await j({apiTestDTO:u,clientDatabaseToken:s.password},{onSuccess:e=>{r(c(p)),r(T(e)),r(m({action:null})),r(x(e.apiTestDTO))},onError:e=>{console.error(e),l("Error","Failed to create test case","error"),r(f()),r(m({action:null})),r(c(p))}})}else throw new Error("Missing Client Database Token")}catch(i){console.error(i);const d=i instanceof Error?i.message:typeof i=="string"?i:"Unexpected error occurred";l("Error",d,"error")}};return t.jsxs(w,{children:[t.jsx(v,{title:"API Test"}),t.jsx(S,{children:t.jsxs(I,{...a,children:[t.jsx("div",{className:"w-60 border-none flex-shrink-0 mx-2",children:t.jsx(E,{})}),t.jsx("div",{className:"flex-1 flex flex-coloverflow-auto w-full",children:t.jsx("div",{className:"flex flex-1 space-x-2",children:t.jsx(H,{...a,children:t.jsxs("form",{onSubmit:a.handleSubmit(A),className:"grid grid-cols-1 md:grid-cols-5 gap-2 w-full",children:[t.jsx("div",{className:"border rounded-lg p-4 md:col-span-3",children:t.jsx(F,{})}),t.jsx("div",{className:"border rounded-lg p-4 md:col-span-2",children:t.jsx(O,{})})]})})})})]})})]})}export{Ve as default};
